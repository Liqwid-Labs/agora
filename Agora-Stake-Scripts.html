<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Agora.Stake.Scripts</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">agora-0.1</span><ul class="links" id="page-menu"><li><a href="src/Agora.Stake.Scripts.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Maintainer</th><td>emi@haskell.fyi</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Agora.Stake.Scripts</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Plutus Scripts for Stakes.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:stakePolicy">stakePolicy</a> :: <a href="file:///nix/store/kkgdz1wxscdc4vv72bln4vqrkirp71nq-tagged-lib-tagged-0.8.6.1-haddock-doc/share/doc/tagged/html/Data-Tagged.html#t:Tagged" title="Data.Tagged">Tagged</a> <a href="Agora-SafeMoney.html#t:GTTag" title="Agora.SafeMoney">GTTag</a> <a href="file:///nix/store/6ilca7icmqibgfqmnsl33jwlfyzd55gp-plutus-ledger-api-lib-plutus-ledger-api-1.0.0.0-haddock-doc/share/doc/plutus-ledger-api/html/PlutusLedgerApi-V1-Value.html#t:AssetClass" title="PlutusLedgerApi.V1.Value">AssetClass</a> -&gt; <a href="file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/Plutarch-Internal.html#t:ClosedTerm" title="Plutarch.Internal">ClosedTerm</a> <a href="file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/Plutarch-Api-V1.html#t:PMintingPolicy" title="Plutarch.Api.V1">PMintingPolicy</a></li><li class="src short"><a href="#v:stakeValidator">stakeValidator</a> :: <a href="Agora-Stake.html#t:Stake" title="Agora.Stake">Stake</a> -&gt; <a href="file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/Plutarch-Internal.html#t:ClosedTerm" title="Plutarch.Internal">ClosedTerm</a> <a href="file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/Plutarch-Api-V1.html#t:PValidator" title="Plutarch.Api.V1">PValidator</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:stakePolicy" class="def">stakePolicy</a> <a href="src/Agora.Stake.Scripts.html#stakePolicy" class="link">Source</a> <a href="#v:stakePolicy" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///nix/store/kkgdz1wxscdc4vv72bln4vqrkirp71nq-tagged-lib-tagged-0.8.6.1-haddock-doc/share/doc/tagged/html/Data-Tagged.html#t:Tagged" title="Data.Tagged">Tagged</a> <a href="Agora-SafeMoney.html#t:GTTag" title="Agora.SafeMoney">GTTag</a> <a href="file:///nix/store/6ilca7icmqibgfqmnsl33jwlfyzd55gp-plutus-ledger-api-lib-plutus-ledger-api-1.0.0.0-haddock-doc/share/doc/plutus-ledger-api/html/PlutusLedgerApi-V1-Value.html#t:AssetClass" title="PlutusLedgerApi.V1.Value">AssetClass</a></td><td class="doc"><p>The (governance) token that a Stake can store.</p></td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/Plutarch-Internal.html#t:ClosedTerm" title="Plutarch.Internal">ClosedTerm</a> <a href="file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/Plutarch-Api-V1.html#t:PMintingPolicy" title="Plutarch.Api.V1">PMintingPolicy</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Policy for Stake state threads.</p><h2>What this Policy does</h2><h3>For minting:</h3><ul><li>Check that exactly one state thread is minted.</li><li>Check that an output exists with a state thread and a valid datum.</li><li>Check that no state thread is an input.</li><li>assert <code><code><a href="file:///nix/store/6ilca7icmqibgfqmnsl33jwlfyzd55gp-plutus-ledger-api-lib-plutus-ledger-api-1.0.0.0-haddock-doc/share/doc/plutus-ledger-api/html/PlutusLedgerApi-V1.html#v:TokenName" title="PlutusLedgerApi.V1">TokenName</a></code> == <code><a href="file:///nix/store/6ilca7icmqibgfqmnsl33jwlfyzd55gp-plutus-ledger-api-lib-plutus-ledger-api-1.0.0.0-haddock-doc/share/doc/plutus-ledger-api/html/PlutusLedgerApi-V1.html#v:ValidatorHash" title="PlutusLedgerApi.V1">ValidatorHash</a></code></code>
     of the script that we pay to.</li></ul><h3>For burning:</h3><ul><li>Check that exactly one state thread is burned.</li><li>Check that datum at state thread is valid and not locked.</li></ul></div></div><div class="top"><p class="src"><a id="v:stakeValidator" class="def">stakeValidator</a> :: <a href="Agora-Stake.html#t:Stake" title="Agora.Stake">Stake</a> -&gt; <a href="file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/Plutarch-Internal.html#t:ClosedTerm" title="Plutarch.Internal">ClosedTerm</a> <a href="file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/Plutarch-Api-V1.html#t:PValidator" title="Plutarch.Api.V1">PValidator</a> <a href="src/Agora.Stake.Scripts.html#stakeValidator" class="link">Source</a> <a href="#v:stakeValidator" class="selflink">#</a></p><div class="doc"><p>Validator intended for Stake UTXOs to be locked by.</p><h2>What this Validator does:</h2><h3><code><a href="Agora-Stake.html#v:DepositWithdraw" title="Agora.Stake">DepositWithdraw</a></code></h3><p>Deposit or withdraw some GT to the stake.</p><ul><li>Tx must be signed by the owner.</li><li>The <code><a href="Agora-Stake.html#v:stakedAmount" title="Agora.Stake">stakedAmount</a></code> field must be updated.</li><li>The stake must not be locked.</li><li>The new UTXO must have the previous value plus the difference
  as stated by the redeemer.</li></ul><h3><code><a href="Agora-Stake.html#v:PermitVote" title="Agora.Stake">PermitVote</a></code></h3><p>Allow a <code><a href="Agora-Stake.html#t:ProposalLock" title="Agora.Stake">ProposalLock</a></code> to be put on the stake in order to vote
on a proposal.</p><ul><li>A proposal token must be spent alongside the stake.</li><li>Its total votes must be correctly updated to include this stake's
    contribution.</li><li>Tx must be signed by the owner.</li></ul><h3><code><a href="Agora-Stake.html#v:RetractVotes" title="Agora.Stake">RetractVotes</a></code></h3><p>Remove a <code><a href="Agora-Stake.html#t:ProposalLock" title="Agora.Stake">ProposalLock</a></code> set when voting on a proposal.</p><ul><li>A proposal token must be spent alongside the stake.</li><li>Tx must be signed by the owner.</li></ul><h3><code><a href="Agora-Stake.html#v:Destroy" title="Agora.Stake">Destroy</a></code></h3><p>Destroy the stake in order to reclaim the min ADA.</p><ul><li>The stake must not be locked.</li><li>Tx must be signed by the owner.</li></ul><h3><code><a href="Agora-Stake.html#v:WitnessStake" title="Agora.Stake">WitnessStake</a></code></h3><p>Allow this Stake to be included in a transaction without making
any changes to it. In the future,
this could use <a href="https://cips.cardano.org/cips/cip31/">CIP-31</a> instead.</p><ul><li>Tx must be signed by the owner <strong>or</strong> a proposal ST token must be spent
  alongside the stake.</li><li>The datum and value must remain unchanged.</li></ul></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.26.0</p></div></body></html>