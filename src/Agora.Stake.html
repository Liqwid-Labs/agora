<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">{- |
Module     : Agora.Stake
Maintainer : emi@haskell.fyi
Description: Vote-lockable stake UTXOs holding GT.

Vote-lockable stake UTXOs holding GT.
-}</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Agora.Stake</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-11"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Haskell-land</span></span><span>
</span><span id="line-12"></span><span>  </span><span class="annot"><a href="Agora.Stake.html#StakeDatum"><span class="hs-identifier">StakeDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>  </span><span class="annot"><a href="Agora.Stake.html#StakeRedeemer"><span class="hs-identifier">StakeRedeemer</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><a href="Agora.Stake.html#Stake"><span class="hs-identifier">Stake</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><a href="Agora.Stake.html#ProposalLock"><span class="hs-identifier">ProposalLock</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Plutarch-land</span></span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><a href="Agora.Stake.html#PStakeDatum"><span class="hs-identifier">PStakeDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><a href="Agora.Stake.html#PStakeRedeemer"><span class="hs-identifier">PStakeRedeemer</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="Agora.Stake.html#PProposalLock"><span class="hs-identifier">PProposalLock</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="Agora.Stake.html#PStakeUsage"><span class="hs-identifier">PStakeUsage</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Utility functions</span></span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="Agora.Stake.html#stakeLocked"><span class="hs-identifier">stakeLocked</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="Agora.Stake.html#findStakeOwnedBy"><span class="hs-identifier">findStakeOwnedBy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="Agora.Stake.html#pgetStakeUsage"><span class="hs-identifier">pgetStakeUsage</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier">Control.Applicative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier">Const</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/kkgdz1wxscdc4vv72bln4vqrkirp71nq-tagged-lib-tagged-0.8.6.1-haddock-doc/share/doc/tagged/html/src"><span class="hs-identifier">Data.Tagged</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/kkgdz1wxscdc4vv72bln4vqrkirp71nq-tagged-lib-tagged-0.8.6.1-haddock-doc/share/doc/tagged/html/src"><span class="hs-identifier">Tagged</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GHC</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/3m16k3x671sq04j9i42i5m85z4hc6yix-generics-sop-lib-generics-sop-0.5.1.2-haddock-doc/share/doc/generics-sop/html/src"><span class="hs-identifier">Generics.SOP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3m16k3x671sq04j9i42i5m85z4hc6yix-generics-sop-lib-generics-sop-0.5.1.2-haddock-doc/share/doc/generics-sop/html/src"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/3m16k3x671sq04j9i42i5m85z4hc6yix-generics-sop-lib-generics-sop-0.5.1.2-haddock-doc/share/doc/generics-sop/html/src"><span class="hs-identifier">HasDatatypeInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/i4b5wlkbk9hq0qsg8a7nsnkqwazqb558-sop-core-lib-sop-core-0.5.0.2-haddock-doc/share/doc/sop-core/html/src"><span class="hs-identifier">I</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/i4b5wlkbk9hq0qsg8a7nsnkqwazqb558-sop-core-lib-sop-core-0.5.0.2-haddock-doc/share/doc/sop-core/html/src"><span class="hs-identifier">I</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier">Num</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/6ilca7icmqibgfqmnsl33jwlfyzd55gp-plutus-ledger-api-lib-plutus-ledger-api-1.0.0.0-haddock-doc/share/doc/plutus-ledger-api/html/src"><span class="hs-identifier">PlutusLedgerApi.V1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/6ilca7icmqibgfqmnsl33jwlfyzd55gp-plutus-ledger-api-lib-plutus-ledger-api-1.0.0.0-haddock-doc/share/doc/plutus-ledger-api/html/src"><span class="hs-identifier">PubKeyHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/6ilca7icmqibgfqmnsl33jwlfyzd55gp-plutus-ledger-api-lib-plutus-ledger-api-1.0.0.0-haddock-doc/share/doc/plutus-ledger-api/html/src"><span class="hs-identifier">PlutusLedgerApi.V1.Value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/6ilca7icmqibgfqmnsl33jwlfyzd55gp-plutus-ledger-api-lib-plutus-ledger-api-1.0.0.0-haddock-doc/share/doc/plutus-ledger-api/html/src"><span class="hs-identifier">AssetClass</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/gpgkl8qqa5x8mrqhgnb52a1l9axlhdd3-plutus-tx-lib-plutus-tx-1.0.0.0-haddock-doc/share/doc/plutus-tx/html/src"><span class="hs-identifier">PlutusTx</span></a></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">Plutarch.Api.V1</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PDatum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PDatumHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PMaybeData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PDJust</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PDNothing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PPubKeyHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PTuple</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PTxInInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PTxInInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PTxOut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PTxOut</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/gzm24k1s2d3v375gfj8rfxzbnxw2n9gj-liqwid-plutarch-extra-lib-liqwid-plutarch-extra-1.1.0-haddock-doc/share/doc/liqwid-plutarch-extra/html/src"><span class="hs-identifier">Plutarch.Api.V1.AssetClass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/gzm24k1s2d3v375gfj8rfxzbnxw2n9gj-liqwid-plutarch-extra-lib-liqwid-plutarch-extra-1.1.0-haddock-doc/share/doc/liqwid-plutarch-extra/html/src"><span class="hs-identifier">PAssetClass</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/gzm24k1s2d3v375gfj8rfxzbnxw2n9gj-liqwid-plutarch-extra-lib-liqwid-plutarch-extra-1.1.0-haddock-doc/share/doc/liqwid-plutarch-extra/html/src"><span class="hs-identifier">passetClassValueOf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/gzm24k1s2d3v375gfj8rfxzbnxw2n9gj-liqwid-plutarch-extra-lib-liqwid-plutarch-extra-1.1.0-haddock-doc/share/doc/liqwid-plutarch-extra/html/src"><span class="hs-identifier">Plutarch.Api.V1.ScriptContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/gzm24k1s2d3v375gfj8rfxzbnxw2n9gj-liqwid-plutarch-extra-lib-liqwid-plutarch-extra-1.1.0-haddock-doc/share/doc/liqwid-plutarch-extra/html/src"><span class="hs-identifier">ptryFindDatum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">Plutarch.DataRepr</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">DerivePConstantViaData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PDataFields</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PIsDataReprInstances</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PIsDataReprInstances</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/x2hnvsjw6yhhcdfyc1lfi4f51izw6pvw-plutarch-extra-lib-plutarch-extra-1.1.0-haddock-doc/share/doc/plutarch-extra/html/src"><span class="hs-identifier">Plutarch.Extra.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/gzm24k1s2d3v375gfj8rfxzbnxw2n9gj-liqwid-plutarch-extra-lib-liqwid-plutarch-extra-1.1.0-haddock-doc/share/doc/liqwid-plutarch-extra/html/src"><span class="hs-identifier">pmapMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/gzm24k1s2d3v375gfj8rfxzbnxw2n9gj-liqwid-plutarch-extra-lib-liqwid-plutarch-extra-1.1.0-haddock-doc/share/doc/liqwid-plutarch-extra/html/src"><span class="hs-identifier">pnotNull</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/x2hnvsjw6yhhcdfyc1lfi4f51izw6pvw-plutarch-extra-lib-plutarch-extra-1.1.0-haddock-doc/share/doc/plutarch-extra/html/src"><span class="hs-identifier">Plutarch.Extra.TermCont</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/x2hnvsjw6yhhcdfyc1lfi4f51izw6pvw-plutarch-extra-lib-plutarch-extra-1.1.0-haddock-doc/share/doc/plutarch-extra/html/src"><span class="hs-identifier">pletC</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/x2hnvsjw6yhhcdfyc1lfi4f51izw6pvw-plutarch-extra-lib-plutarch-extra-1.1.0-haddock-doc/share/doc/plutarch-extra/html/src"><span class="hs-identifier">pletFieldsC</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/x2hnvsjw6yhhcdfyc1lfi4f51izw6pvw-plutarch-extra-lib-plutarch-extra-1.1.0-haddock-doc/share/doc/plutarch-extra/html/src"><span class="hs-identifier">pmatchC</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">Plutarch.Internal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">punsafeCoerce</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">Plutarch.Lift</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PConstantDecl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PUnsafeLiftDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/r0v3ilm4hr5yi58n5bm6c8v3r53s9pbh-plutarch-safe-money-lib-plutarch-safe-money-1.0.0-haddock-doc/share/doc/plutarch-safe-money/html/src"><span class="hs-identifier">Plutarch.SafeMoney</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r0v3ilm4hr5yi58n5bm6c8v3r53s9pbh-plutarch-safe-money-lib-plutarch-safe-money-1.0.0-haddock-doc/share/doc/plutarch-safe-money/html/src"><span class="hs-identifier">PDiscrete</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">Plutarch.TryFrom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PTryFrom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PTryFromExcess</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">ptryFrom'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agora.Proposal.html"><span class="hs-identifier">Agora.Proposal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agora.Proposal.html#PProposalId"><span class="hs-identifier">PProposalId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agora.Proposal.html#PResultTag"><span class="hs-identifier">PResultTag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agora.Proposal.html#ProposalId"><span class="hs-identifier">ProposalId</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agora.Proposal.html#ResultTag"><span class="hs-identifier">ResultTag</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agora.SafeMoney.html"><span class="hs-identifier">Agora.SafeMoney</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agora.SafeMoney.html#GTTag"><span class="hs-identifier">GTTag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | Parameters for creating Stake scripts.</span><span>
</span><span id="line-76"></span><span id="local-6989586621679542448"><span id="local-6989586621679542449"></span></span><span class="hs-keyword">data</span><span> </span><span id="Stake"><span class="annot"><a href="Agora.Stake.html#Stake"><span class="hs-identifier hs-var">Stake</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Stake"><span class="annot"><a href="Agora.Stake.html#Stake"><span class="hs-identifier hs-var">Stake</span></a></span></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="gtClassRef"><span class="annot"><span class="annottext">Stake -&gt; Tagged @Type GTTag AssetClass
</span><a href="Agora.Stake.html#gtClassRef"><span class="hs-identifier hs-var hs-var">gtClassRef</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/kkgdz1wxscdc4vv72bln4vqrkirp71nq-tagged-lib-tagged-0.8.6.1-haddock-doc/share/doc/tagged/html/src"><span class="hs-identifier hs-type">Tagged</span></a></span><span> </span><span class="annot"><a href="Agora.SafeMoney.html#GTTag"><span class="hs-identifier hs-type">GTTag</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/6ilca7icmqibgfqmnsl33jwlfyzd55gp-plutus-ledger-api-lib-plutus-ledger-api-1.0.0.0-haddock-doc/share/doc/plutus-ledger-api/html/src"><span class="hs-identifier hs-type">AssetClass</span></a></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-comment">-- ^ Used when inlining the AssetClass of a 'PDiscrete' in the script code.</span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="proposalSTClass"><span class="annot"><span class="annottext">Stake -&gt; AssetClass
</span><a href="Agora.Stake.html#proposalSTClass"><span class="hs-identifier hs-var hs-var">proposalSTClass</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/6ilca7icmqibgfqmnsl33jwlfyzd55gp-plutus-ledger-api-lib-plutus-ledger-api-1.0.0.0-haddock-doc/share/doc/plutus-ledger-api/html/src"><span class="hs-identifier hs-type">AssetClass</span></a></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. Stake -&gt; Rep Stake x)
-&gt; (forall x. Rep Stake x -&gt; Stake) -&gt; Generic Stake
forall x. Rep Stake x -&gt; Stake
forall x. Stake -&gt; Rep Stake x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Stake x -&gt; Stake
$cfrom :: forall x. Stake -&gt; Rep Stake x
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">GHC.Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">{- | A lock placed on a Stake datum in order to prevent
     depositing and withdrawing when votes are in place.

     NOTE: Due to retracting votes always being possible,
     this lock will only lock with contention on the proposal.

     FIXME: Contention on Proposals could create contention
     on voting which in turn creates contention on stakers.

     Vaguely this is the dependency graph for this locking
     interaction. Both the stake validator and the proposal
     validator are only able to check for one another through
     the datum belonging to the ST:

     @
     &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;   &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;
     &#9474; Stake Validator &#9500;&#9472;&#9488; &#9474; Proposal Validator &#9474;
     &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;
              &#9474;          &#9474;        &#9474;     &#9474;
              &#9474;        &#9484;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;     &#9474;
              &#9660;        &#9474; &#9474;              &#9660;
     &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9474; &#9474; &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;
     &#9474; Stake Policy &#9474;&#9668;&#9472;&#9496; &#9492;&#9658;&#9474; Proposal Policy &#9474;
     &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;      &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;
     @
-}</span><span>
</span><span id="line-109"></span><span id="local-6989586621679542439"><span id="local-6989586621679542440"></span></span><span class="hs-keyword">data</span><span> </span><span id="ProposalLock"><span class="annot"><a href="Agora.Stake.html#ProposalLock"><span class="hs-identifier hs-var">ProposalLock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ProposalLock"><span class="annot"><a href="Agora.Stake.html#ProposalLock"><span class="hs-identifier hs-var">ProposalLock</span></a></span></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="vote"><span class="annot"><span class="annottext">ProposalLock -&gt; ResultTag
</span><a href="Agora.Stake.html#vote"><span class="hs-identifier hs-var hs-var">vote</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agora.Proposal.html#ResultTag"><span class="hs-identifier hs-type">ResultTag</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-comment">-- ^ What was voted on. This allows retracting votes to</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-comment">--   undo their vote.</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="proposalId"><span class="annot"><span class="annottext">ProposalLock -&gt; ProposalId
</span><a href="Agora.Stake.html#proposalId"><span class="hs-identifier hs-var hs-var">proposalId</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agora.Proposal.html#ProposalId"><span class="hs-identifier hs-type">ProposalId</span></a></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-comment">-- ^ Identifies the proposal. See 'ProposalId' for further</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-comment">-- comments on its significance.</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679542424"><span id="local-6989586621679542426"><span id="local-6989586621679542434"><span class="annot"><span class="annottext">Int -&gt; ProposalLock -&gt; ShowS
[ProposalLock] -&gt; ShowS
ProposalLock -&gt; String
(Int -&gt; ProposalLock -&gt; ShowS)
-&gt; (ProposalLock -&gt; String)
-&gt; ([ProposalLock] -&gt; ShowS)
-&gt; Show ProposalLock
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ProposalLock] -&gt; ShowS
$cshowList :: [ProposalLock] -&gt; ShowS
show :: ProposalLock -&gt; String
$cshow :: ProposalLock -&gt; String
showsPrec :: Int -&gt; ProposalLock -&gt; ShowS
$cshowsPrec :: Int -&gt; ProposalLock -&gt; ShowS
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. ProposalLock -&gt; Rep ProposalLock x)
-&gt; (forall x. Rep ProposalLock x -&gt; ProposalLock)
-&gt; Generic ProposalLock
forall x. Rep ProposalLock x -&gt; ProposalLock
forall x. ProposalLock -&gt; Rep ProposalLock x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep ProposalLock x -&gt; ProposalLock
$cfrom :: forall x. ProposalLock -&gt; Rep ProposalLock x
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">GHC.Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span id="local-6989586621679542410"><span id="local-6989586621679542412"><span id="local-6989586621679542418"><span class="hs-identifier">PlutusTx.makeIsDataIndexed</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">ProposalLock</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier">ProposalLock</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | Haskell-level redeemer for Stake scripts.</span><span>
</span><span id="line-122"></span><span id="local-6989586621679542346"><span id="local-6989586621679542347"></span></span><span class="hs-keyword">data</span><span> </span><span id="StakeRedeemer"><span class="annot"><a href="Agora.Stake.html#StakeRedeemer"><span class="hs-identifier hs-var">StakeRedeemer</span></a></span></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Deposit or withdraw a discrete amount of the staked governance token.</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-comment">--   Stake must be unlocked.</span><span>
</span><span id="line-125"></span><span>    </span><span id="DepositWithdraw"><span class="annot"><a href="Agora.Stake.html#DepositWithdraw"><span class="hs-identifier hs-var">DepositWithdraw</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/kkgdz1wxscdc4vv72bln4vqrkirp71nq-tagged-lib-tagged-0.8.6.1-haddock-doc/share/doc/tagged/html/src"><span class="hs-identifier hs-type">Tagged</span></a></span><span> </span><span class="annot"><a href="Agora.SafeMoney.html#GTTag"><span class="hs-identifier hs-type">GTTag</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Destroy a stake, retrieving its LQ, the minimum ADA and any other assets.</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-comment">--   Stake must be unlocked.</span><span>
</span><span id="line-128"></span><span>    </span><span id="Destroy"><span class="annot"><a href="Agora.Stake.html#Destroy"><span class="hs-identifier hs-var">Destroy</span></a></span></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Permit a Vote to be added onto a 'Agora.Proposal.Proposal'.</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-comment">--   This also adds a lock to the 'lockedBy' field. See 'ProposalLock'.</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-comment">--   This needs to be done in sync with casting a vote, otherwise</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-comment">--   it's possible for a lock to be permanently placed on the stake,</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-comment">--   and then the funds are lost.</span><span>
</span><span id="line-134"></span><span>    </span><span id="PermitVote"><span class="annot"><a href="Agora.Stake.html#PermitVote"><span class="hs-identifier hs-var">PermitVote</span></a></span></span><span> </span><span class="annot"><a href="Agora.Stake.html#ProposalLock"><span class="hs-identifier hs-type">ProposalLock</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Retract a vote, removing it from the 'lockedBy' field. See 'ProposalLock'.</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-comment">--   This action checks for permission of the 'Agora.Proposal.Proposal'. Finished proposals are</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-comment">--   always allowed to have votes retracted and won't affect the Proposal datum,</span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-comment">--   allowing 'Stake's to be unlocked.</span><span>
</span><span id="line-139"></span><span>    </span><span id="RetractVotes"><span class="annot"><a href="Agora.Stake.html#RetractVotes"><span class="hs-identifier hs-var">RetractVotes</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agora.Stake.html#ProposalLock"><span class="hs-identifier hs-type">ProposalLock</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | The owner can consume stake if nothing is changed about it.</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-comment">--   If the proposal token moves, this is equivalent to the owner consuming it.</span><span>
</span><span id="line-142"></span><span>    </span><span id="WitnessStake"><span class="annot"><a href="Agora.Stake.html#WitnessStake"><span class="hs-identifier hs-var">WitnessStake</span></a></span></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679542326"><span id="local-6989586621679542328"><span id="local-6989586621679542339"><span class="annot"><span class="annottext">Int -&gt; StakeRedeemer -&gt; ShowS
[StakeRedeemer] -&gt; ShowS
StakeRedeemer -&gt; String
(Int -&gt; StakeRedeemer -&gt; ShowS)
-&gt; (StakeRedeemer -&gt; String)
-&gt; ([StakeRedeemer] -&gt; ShowS)
-&gt; Show StakeRedeemer
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [StakeRedeemer] -&gt; ShowS
$cshowList :: [StakeRedeemer] -&gt; ShowS
show :: StakeRedeemer -&gt; String
$cshow :: StakeRedeemer -&gt; String
showsPrec :: Int -&gt; StakeRedeemer -&gt; ShowS
$cshowsPrec :: Int -&gt; StakeRedeemer -&gt; ShowS
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. StakeRedeemer -&gt; Rep StakeRedeemer x)
-&gt; (forall x. Rep StakeRedeemer x -&gt; StakeRedeemer)
-&gt; Generic StakeRedeemer
forall x. Rep StakeRedeemer x -&gt; StakeRedeemer
forall x. StakeRedeemer -&gt; Rep StakeRedeemer x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep StakeRedeemer x -&gt; StakeRedeemer
$cfrom :: forall x. StakeRedeemer -&gt; Rep StakeRedeemer x
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">GHC.Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span id="local-6989586621679542310"><span id="local-6989586621679542312"><span id="local-6989586621679542320"><span class="hs-identifier">PlutusTx.makeIsDataIndexed</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-special">''</span><span class="hs-identifier">StakeRedeemer</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier">DepositWithdraw</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier">Destroy</span><span class="hs-special">,</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier">PermitVote</span><span class="hs-special">,</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier">RetractVotes</span><span class="hs-special">,</span><span> </span><span class="hs-number">3</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier">WitnessStake</span><span class="hs-special">,</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | Haskell-level datum for Stake scripts.</span><span>
</span><span id="line-155"></span><span id="local-6989586621679542236"><span id="local-6989586621679542237"></span></span><span class="hs-keyword">data</span><span> </span><span id="StakeDatum"><span class="annot"><a href="Agora.Stake.html#StakeDatum"><span class="hs-identifier hs-var">StakeDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="StakeDatum"><span class="annot"><a href="Agora.Stake.html#StakeDatum"><span class="hs-identifier hs-var">StakeDatum</span></a></span></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="stakedAmount"><span class="annot"><span class="annottext">StakeDatum -&gt; Tagged @Type GTTag BuiltinInteger
</span><a href="Agora.Stake.html#stakedAmount"><span class="hs-identifier hs-var hs-var">stakedAmount</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/kkgdz1wxscdc4vv72bln4vqrkirp71nq-tagged-lib-tagged-0.8.6.1-haddock-doc/share/doc/tagged/html/src"><span class="hs-identifier hs-type">Tagged</span></a></span><span> </span><span class="annot"><a href="Agora.SafeMoney.html#GTTag"><span class="hs-identifier hs-type">GTTag</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-comment">-- ^ Tracks the amount of governance token staked in the datum.</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-comment">-- This also acts as the voting weight for 'Agora.Proposal.Proposal's.</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="owner"><span class="annot"><span class="annottext">StakeDatum -&gt; PubKeyHash
</span><a href="Agora.Stake.html#owner"><span class="hs-identifier hs-var hs-var">owner</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/6ilca7icmqibgfqmnsl33jwlfyzd55gp-plutus-ledger-api-lib-plutus-ledger-api-1.0.0.0-haddock-doc/share/doc/plutus-ledger-api/html/src"><span class="hs-identifier hs-type">PubKeyHash</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-comment">-- ^ The hash of the public key this stake belongs to.</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-comment">-- TODO Support for MultiSig/Scripts is tracked here:</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-comment">--      https://github.com/Liqwid-Labs/agora/issues/45</span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="lockedBy"><span class="annot"><span class="annottext">StakeDatum -&gt; [ProposalLock]
</span><a href="Agora.Stake.html#lockedBy"><span class="hs-identifier hs-var hs-var">lockedBy</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agora.Stake.html#ProposalLock"><span class="hs-identifier hs-type">ProposalLock</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-comment">-- ^ The current proposals locking this stake. This field must be empty</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-comment">-- for the stake to be usable for deposits and withdrawals.</span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679542219"><span id="local-6989586621679542221"><span id="local-6989586621679542230"><span class="annot"><span class="annottext">Int -&gt; StakeDatum -&gt; ShowS
[StakeDatum] -&gt; ShowS
StakeDatum -&gt; String
(Int -&gt; StakeDatum -&gt; ShowS)
-&gt; (StakeDatum -&gt; String)
-&gt; ([StakeDatum] -&gt; ShowS)
-&gt; Show StakeDatum
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [StakeDatum] -&gt; ShowS
$cshowList :: [StakeDatum] -&gt; ShowS
show :: StakeDatum -&gt; String
$cshow :: StakeDatum -&gt; String
showsPrec :: Int -&gt; StakeDatum -&gt; ShowS
$cshowsPrec :: Int -&gt; StakeDatum -&gt; ShowS
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. StakeDatum -&gt; Rep StakeDatum x)
-&gt; (forall x. Rep StakeDatum x -&gt; StakeDatum) -&gt; Generic StakeDatum
forall x. Rep StakeDatum x -&gt; StakeDatum
forall x. StakeDatum -&gt; Rep StakeDatum x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep StakeDatum x -&gt; StakeDatum
$cfrom :: forall x. StakeDatum -&gt; Rep StakeDatum x
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">GHC.Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span id="local-6989586621679542204"><span id="local-6989586621679542206"><span id="local-6989586621679542214"><span class="hs-identifier">PlutusTx.makeIsDataIndexed</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">StakeDatum</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier">StakeDatum</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- | Plutarch-level datum for Stake scripts.</span><span>
</span><span id="line-175"></span><span id="local-6989586621679542154"><span id="local-6989586621679542155"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="PStakeDatum"><span class="annot"><a href="Agora.Stake.html#PStakeDatum"><span class="hs-identifier hs-var">PStakeDatum</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679544210"><span class="annot"><a href="#local-6989586621679544210"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">S</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PStakeDatum"><span class="annot"><a href="Agora.Stake.html#PStakeDatum"><span class="hs-identifier hs-var">PStakeDatum</span></a></span></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="getStakeDatum"><span class="annot"><span class="annottext">forall (s :: S).
PStakeDatum s
-&gt; Term
     s
     (PDataRecord
        ((':)
           @PLabeledType
           (&quot;stakedAmount&quot; ':= PDiscrete @Type GTTag)
           ((':)
              @PLabeledType
              (&quot;owner&quot; ':= PPubKeyHash)
              ((':)
                 @PLabeledType
                 (&quot;lockedBy&quot; ':= PBuiltinList (PAsData PProposalLock))
                 ('[] @PLabeledType)))))
</span><a href="Agora.Stake.html#getStakeDatum"><span class="hs-identifier hs-var hs-var">getStakeDatum</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-177"></span><span>      </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span>
</span><span id="line-178"></span><span>        </span><span class="annot"><a href="#local-6989586621679544210"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-179"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDataRecord</span></a></span><span>
</span><span id="line-180"></span><span>            </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;stakedAmount&quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:=</span><span> </span><span class="annot"><a href="../file:///nix/store/r0v3ilm4hr5yi58n5bm6c8v3r53s9pbh-plutarch-safe-money-lib-plutarch-safe-money-1.0.0-haddock-doc/share/doc/plutarch-safe-money/html/src"><span class="hs-identifier hs-type">PDiscrete</span></a></span><span> </span><span class="annot"><a href="Agora.SafeMoney.html#GTTag"><span class="hs-identifier hs-type">GTTag</span></a></span><span>
</span><span id="line-181"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;owner&quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:=</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PPubKeyHash</span></a></span><span>
</span><span id="line-182"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;lockedBy&quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:=</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBuiltinList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PProposalLock"><span class="hs-identifier hs-type">PProposalLock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>             </span><span class="hs-special">]</span><span>
</span><span id="line-184"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. PStakeDatum s -&gt; Rep (PStakeDatum s) x)
-&gt; (forall x. Rep (PStakeDatum s) x -&gt; PStakeDatum s)
-&gt; Generic (PStakeDatum s)
forall x. Rep (PStakeDatum s) x -&gt; PStakeDatum s
forall x. PStakeDatum s -&gt; Rep (PStakeDatum s) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (s :: S) x. Rep (PStakeDatum s) x -&gt; PStakeDatum s
forall (s :: S) x. PStakeDatum s -&gt; Rep (PStakeDatum s) x
$cto :: forall (s :: S) x. Rep (PStakeDatum s) x -&gt; PStakeDatum s
$cfrom :: forall (s :: S) x. PStakeDatum s -&gt; Rep (PStakeDatum s) x
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">GHC.Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679542143"><span id="local-6989586621679542145"><span class="annot"><span class="annottext">All @[Type] (SListI @Type) (Code (PStakeDatum s))
All @[Type] (SListI @Type) (Code (PStakeDatum s))
-&gt; (PStakeDatum s -&gt; Rep (PStakeDatum s))
-&gt; (Rep (PStakeDatum s) -&gt; PStakeDatum s)
-&gt; Generic (PStakeDatum s)
Rep (PStakeDatum s) -&gt; PStakeDatum s
PStakeDatum s -&gt; Rep (PStakeDatum s)
forall a.
All @[Type] (SListI @Type) (Code a)
-&gt; (a -&gt; Rep a) -&gt; (Rep a -&gt; a) -&gt; Generic a
forall {s :: S}. All @[Type] (SListI @Type) (Code (PStakeDatum s))
forall (s :: S). Rep (PStakeDatum s) -&gt; PStakeDatum s
forall (s :: S). PStakeDatum s -&gt; Rep (PStakeDatum s)
to :: Rep (PStakeDatum s) -&gt; PStakeDatum s
$cto :: forall (s :: S). Rep (PStakeDatum s) -&gt; PStakeDatum s
from :: PStakeDatum s -&gt; Rep (PStakeDatum s)
$cfrom :: forall (s :: S). PStakeDatum s -&gt; Rep (PStakeDatum s)
</span><a href="../file:///nix/store/3m16k3x671sq04j9i42i5m85z4hc6yix-generics-sop-lib-generics-sop-0.5.1.2-haddock-doc/share/doc/generics-sop/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679542128"><span id="local-6989586621679542130"><span class="annot"><span class="annottext">PIsData PStakeDatum
PlutusType PStakeDatum
PlutusType PStakeDatum
-&gt; PIsData PStakeDatum
-&gt; (forall (s :: S).
    PStakeDatum s -&gt; Term s (PDataSum (PIsDataReprRepr PStakeDatum)))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PDataSum (PIsDataReprRepr PStakeDatum))
    -&gt; (PStakeDatum s -&gt; Term s b) -&gt; Term s b)
-&gt; PIsDataRepr PStakeDatum
forall (s :: S).
PStakeDatum s -&gt; Term s (PDataSum (PIsDataReprRepr PStakeDatum))
forall (s :: S) (b :: PType).
Term s (PDataSum (PIsDataReprRepr PStakeDatum))
-&gt; (PStakeDatum s -&gt; Term s b) -&gt; Term s b
forall (a :: PType).
PlutusType a
-&gt; PIsData a
-&gt; (forall (s :: S). a s -&gt; Term s (PDataSum (PIsDataReprRepr a)))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PDataSum (PIsDataReprRepr a))
    -&gt; (a s -&gt; Term s b) -&gt; Term s b)
-&gt; PIsDataRepr a
pmatchRepr :: forall (s :: S) (b :: PType).
Term s (PDataSum (PIsDataReprRepr PStakeDatum))
-&gt; (PStakeDatum s -&gt; Term s b) -&gt; Term s b
$cpmatchRepr :: forall (s :: S) (b :: PType).
Term s (PDataSum (PIsDataReprRepr PStakeDatum))
-&gt; (PStakeDatum s -&gt; Term s b) -&gt; Term s b
pconRepr :: forall (s :: S).
PStakeDatum s -&gt; Term s (PDataSum (PIsDataReprRepr PStakeDatum))
$cpconRepr :: forall (s :: S).
PStakeDatum s -&gt; Term s (PDataSum (PIsDataReprRepr PStakeDatum))
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">PIsDataRepr</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-keyword">deriving</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679542110"><span id="local-6989586621679542117"><span class="annot"><span class="annottext">PCon PStakeDatum
PMatch PStakeDatum
PCon PStakeDatum
-&gt; PMatch PStakeDatum
-&gt; (forall (s :: S) (b :: PType).
    PStakeDatum s -&gt; Term s (PInner PStakeDatum b))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PInner PStakeDatum b)
    -&gt; (PStakeDatum s -&gt; Term s b) -&gt; Term s b)
-&gt; PlutusType PStakeDatum
forall (s :: S) (b :: PType).
Term s (PInner PStakeDatum b)
-&gt; (PStakeDatum s -&gt; Term s b) -&gt; Term s b
forall (s :: S) (b :: PType).
PStakeDatum s -&gt; Term s (PInner PStakeDatum b)
forall (a :: PType).
PCon a
-&gt; PMatch a
-&gt; (forall (s :: S) (b :: PType). a s -&gt; Term s (PInner a b))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PInner a b) -&gt; (a s -&gt; Term s b) -&gt; Term s b)
-&gt; PlutusType a
pmatch' :: forall (s :: S) (b :: PType).
Term s (PInner PStakeDatum b)
-&gt; (PStakeDatum s -&gt; Term s b) -&gt; Term s b
$cpmatch' :: forall (s :: S) (b :: PType).
Term s (PInner PStakeDatum b)
-&gt; (PStakeDatum s -&gt; Term s b) -&gt; Term s b
pcon' :: forall (s :: S) (b :: PType).
PStakeDatum s -&gt; Term s (PInner PStakeDatum b)
$cpcon' :: forall (s :: S) (b :: PType).
PStakeDatum s -&gt; Term s (PInner PStakeDatum b)
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">PlutusType</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679542097"><span id="local-6989586621679542103"><span class="annot"><span class="annottext">(forall (s :: S).
 Term s (PAsData PStakeDatum) -&gt; Term s PStakeDatum)
-&gt; (forall (s :: S). Term s PStakeDatum -&gt; Term s PData)
-&gt; PIsData PStakeDatum
forall (s :: S). Term s (PAsData PStakeDatum) -&gt; Term s PStakeDatum
forall (s :: S). Term s PStakeDatum -&gt; Term s PData
forall (a :: PType).
(forall (s :: S). Term s (PAsData a) -&gt; Term s a)
-&gt; (forall (s :: S). Term s a -&gt; Term s PData) -&gt; PIsData a
pdataImpl :: forall (s :: S). Term s PStakeDatum -&gt; Term s PData
$cpdataImpl :: forall (s :: S). Term s PStakeDatum -&gt; Term s PData
pfromDataImpl :: forall (s :: S). Term s (PAsData PStakeDatum) -&gt; Term s PStakeDatum
$cpfromDataImpl :: forall (s :: S). Term s (PAsData PStakeDatum) -&gt; Term s PStakeDatum
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">PIsData</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679542091"><span class="annot"><span class="annottext">(forall (s :: S).
 Term s PStakeDatum -&gt; Term s (PDataRecord (PFields PStakeDatum)))
-&gt; PDataFields PStakeDatum
forall (s :: S).
Term s PStakeDatum -&gt; Term s (PDataRecord (PFields PStakeDatum))
forall (a :: PType).
(forall (s :: S). Term s a -&gt; Term s (PDataRecord (PFields a)))
-&gt; PDataFields a
ptoFields :: forall (s :: S).
Term s PStakeDatum -&gt; Term s (PDataRecord (PFields PStakeDatum))
$cptoFields :: forall (s :: S).
Term s PStakeDatum -&gt; Term s (PDataRecord (PFields PStakeDatum))
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">PDataFields</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679542078"><span class="annot"><span class="annottext">(forall (s :: S).
 Term s PStakeDatum -&gt; Term s PStakeDatum -&gt; Term s PBool)
-&gt; PEq PStakeDatum
forall (s :: S).
Term s PStakeDatum -&gt; Term s PStakeDatum -&gt; Term s PBool
forall (t :: PType).
(forall (s :: S). Term s t -&gt; Term s t -&gt; Term s PBool) -&gt; PEq t
#== :: forall (s :: S).
Term s PStakeDatum -&gt; Term s PStakeDatum -&gt; Term s PBool
$c#== :: forall (s :: S).
Term s PStakeDatum -&gt; Term s PStakeDatum -&gt; Term s PBool
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">PEq</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-keyword">via</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PIsDataReprInstances</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PStakeDatum"><span class="hs-identifier hs-type">PStakeDatum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTryFrom</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PStakeDatum"><span class="hs-identifier hs-type">PStakeDatum</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PTryFromExcess"><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PTryFromExcess</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PStakeDatum"><span class="hs-identifier hs-type">PStakeDatum</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-type">Const</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>  </span><span id="local-6989586621679542061"><span class="annot"><span class="annottext">ptryFrom' :: forall (s :: S) (r :: PType).
Term s PData
-&gt; ((Term s (PAsData PStakeDatum),
     Reduce @Type (PTryFromExcess PData (PAsData PStakeDatum) s))
    -&gt; Term s r)
-&gt; Term s r
</span><a href="#local-6989586621679542061"><span class="hs-identifier hs-var hs-var hs-var hs-var">ptryFrom'</span></a></span></span><span> </span><span id="local-6989586621679542060"><span class="annot"><span class="annottext">Term s PData
</span><a href="#local-6989586621679542060"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679542059"><span class="annot"><span class="annottext">(Term s (PAsData PStakeDatum),
 Reduce @Type (PTryFromExcess PData (PAsData PStakeDatum) s))
-&gt; Term s r
</span><a href="#local-6989586621679542059"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><span class="annottext">(Term s (PAsData PStakeDatum),
 Reduce @Type (PTryFromExcess PData (PAsData PStakeDatum) s))
-&gt; Term s r
</span><a href="#local-6989586621679542059"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s PData -&gt; Term s (PAsData PStakeDatum)
forall (s :: S) (a :: PType) (b :: PType). Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">punsafeCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PData
</span><a href="#local-6989586621679542060"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PUnsafeLiftDecl</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PStakeDatum"><span class="hs-identifier hs-type">PStakeDatum</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-keyword">type</span><span> </span><span id="PLifted"><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PLifted</span></a></span></span><span> </span><span class="annot"><a href="Agora.Stake.html#PStakeDatum"><span class="hs-identifier hs-type">PStakeDatum</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agora.Stake.html#StakeDatum"><span class="hs-identifier hs-type">StakeDatum</span></a></span><span>
</span><span id="line-199"></span><span id="local-6989586621679542032"><span id="local-6989586621679542042"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">DerivePConstantViaData</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#StakeDatum"><span class="hs-identifier hs-type">StakeDatum</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PStakeDatum"><span class="hs-identifier hs-type">PStakeDatum</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PConstantDecl</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#StakeDatum"><span class="hs-identifier hs-type">StakeDatum</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | Plutarch-level redeemer for Stake scripts.</span><span>
</span><span id="line-202"></span><span id="local-6989586621679542019"><span id="local-6989586621679542020"></span></span><span class="hs-keyword">data</span><span> </span><span id="PStakeRedeemer"><span class="annot"><a href="Agora.Stake.html#PStakeRedeemer"><span class="hs-identifier hs-var">PStakeRedeemer</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679544120"><span class="annot"><a href="#local-6989586621679544120"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">S</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Deposit or withdraw a discrete amount of the staked governance token.</span><span>
</span><span id="line-204"></span><span>    </span><span id="PDepositWithdraw"><span class="annot"><a href="Agora.Stake.html#PDepositWithdraw"><span class="hs-identifier hs-var">PDepositWithdraw</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679544120"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDataRecord</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;delta&quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:=</span><span> </span><span class="annot"><a href="../file:///nix/store/r0v3ilm4hr5yi58n5bm6c8v3r53s9pbh-plutarch-safe-money-lib-plutarch-safe-money-1.0.0-haddock-doc/share/doc/plutarch-safe-money/html/src"><span class="hs-identifier hs-type">PDiscrete</span></a></span><span> </span><span class="annot"><a href="Agora.SafeMoney.html#GTTag"><span class="hs-identifier hs-type">GTTag</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Destroy a stake, retrieving its LQ, the minimum ADA and any other assets.</span><span>
</span><span id="line-206"></span><span>    </span><span id="PDestroy"><span class="annot"><a href="Agora.Stake.html#PDestroy"><span class="hs-identifier hs-var">PDestroy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679544120"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDataRecord</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PPermitVote"><span class="annot"><a href="Agora.Stake.html#PPermitVote"><span class="hs-identifier hs-var">PPermitVote</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679544120"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDataRecord</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;lock&quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:=</span><span> </span><span class="annot"><a href="Agora.Stake.html#PProposalLock"><span class="hs-identifier hs-type">PProposalLock</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PRetractVotes"><span class="annot"><a href="Agora.Stake.html#PRetractVotes"><span class="hs-identifier hs-var">PRetractVotes</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679544120"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDataRecord</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;locks&quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:=</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBuiltinList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PProposalLock"><span class="hs-identifier hs-type">PProposalLock</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PWitnessStake"><span class="annot"><a href="Agora.Stake.html#PWitnessStake"><span class="hs-identifier hs-var">PWitnessStake</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679544120"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDataRecord</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. PStakeRedeemer s -&gt; Rep (PStakeRedeemer s) x)
-&gt; (forall x. Rep (PStakeRedeemer s) x -&gt; PStakeRedeemer s)
-&gt; Generic (PStakeRedeemer s)
forall x. Rep (PStakeRedeemer s) x -&gt; PStakeRedeemer s
forall x. PStakeRedeemer s -&gt; Rep (PStakeRedeemer s) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (s :: S) x. Rep (PStakeRedeemer s) x -&gt; PStakeRedeemer s
forall (s :: S) x. PStakeRedeemer s -&gt; Rep (PStakeRedeemer s) x
$cto :: forall (s :: S) x. Rep (PStakeRedeemer s) x -&gt; PStakeRedeemer s
$cfrom :: forall (s :: S) x. PStakeRedeemer s -&gt; Rep (PStakeRedeemer s) x
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">GHC.Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679542005"><span id="local-6989586621679542007"><span class="annot"><span class="annottext">All @[Type] (SListI @Type) (Code (PStakeRedeemer s))
All @[Type] (SListI @Type) (Code (PStakeRedeemer s))
-&gt; (PStakeRedeemer s -&gt; Rep (PStakeRedeemer s))
-&gt; (Rep (PStakeRedeemer s) -&gt; PStakeRedeemer s)
-&gt; Generic (PStakeRedeemer s)
Rep (PStakeRedeemer s) -&gt; PStakeRedeemer s
PStakeRedeemer s -&gt; Rep (PStakeRedeemer s)
forall a.
All @[Type] (SListI @Type) (Code a)
-&gt; (a -&gt; Rep a) -&gt; (Rep a -&gt; a) -&gt; Generic a
forall {s :: S}.
All @[Type] (SListI @Type) (Code (PStakeRedeemer s))
forall (s :: S). Rep (PStakeRedeemer s) -&gt; PStakeRedeemer s
forall (s :: S). PStakeRedeemer s -&gt; Rep (PStakeRedeemer s)
to :: Rep (PStakeRedeemer s) -&gt; PStakeRedeemer s
$cto :: forall (s :: S). Rep (PStakeRedeemer s) -&gt; PStakeRedeemer s
from :: PStakeRedeemer s -&gt; Rep (PStakeRedeemer s)
$cfrom :: forall (s :: S). PStakeRedeemer s -&gt; Rep (PStakeRedeemer s)
</span><a href="#local-6989586621679542005"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679541981"><span id="local-6989586621679541983"><span class="annot"><span class="annottext">PIsData PStakeRedeemer
PlutusType PStakeRedeemer
PlutusType PStakeRedeemer
-&gt; PIsData PStakeRedeemer
-&gt; (forall (s :: S).
    PStakeRedeemer s
    -&gt; Term s (PDataSum (PIsDataReprRepr PStakeRedeemer)))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PDataSum (PIsDataReprRepr PStakeRedeemer))
    -&gt; (PStakeRedeemer s -&gt; Term s b) -&gt; Term s b)
-&gt; PIsDataRepr PStakeRedeemer
forall (s :: S).
PStakeRedeemer s
-&gt; Term s (PDataSum (PIsDataReprRepr PStakeRedeemer))
forall (s :: S) (b :: PType).
Term s (PDataSum (PIsDataReprRepr PStakeRedeemer))
-&gt; (PStakeRedeemer s -&gt; Term s b) -&gt; Term s b
forall (a :: PType).
PlutusType a
-&gt; PIsData a
-&gt; (forall (s :: S). a s -&gt; Term s (PDataSum (PIsDataReprRepr a)))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PDataSum (PIsDataReprRepr a))
    -&gt; (a s -&gt; Term s b) -&gt; Term s b)
-&gt; PIsDataRepr a
pmatchRepr :: forall (s :: S) (b :: PType).
Term s (PDataSum (PIsDataReprRepr PStakeRedeemer))
-&gt; (PStakeRedeemer s -&gt; Term s b) -&gt; Term s b
$cpmatchRepr :: forall (s :: S) (b :: PType).
Term s (PDataSum (PIsDataReprRepr PStakeRedeemer))
-&gt; (PStakeRedeemer s -&gt; Term s b) -&gt; Term s b
pconRepr :: forall (s :: S).
PStakeRedeemer s
-&gt; Term s (PDataSum (PIsDataReprRepr PStakeRedeemer))
$cpconRepr :: forall (s :: S).
PStakeRedeemer s
-&gt; Term s (PDataSum (PIsDataReprRepr PStakeRedeemer))
</span><a href="#local-6989586621679541981"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">PIsDataRepr</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-keyword">deriving</span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679541967"><span id="local-6989586621679541973"><span class="annot"><span class="annottext">PCon PStakeRedeemer
PMatch PStakeRedeemer
PCon PStakeRedeemer
-&gt; PMatch PStakeRedeemer
-&gt; (forall (s :: S) (b :: PType).
    PStakeRedeemer s -&gt; Term s (PInner PStakeRedeemer b))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PInner PStakeRedeemer b)
    -&gt; (PStakeRedeemer s -&gt; Term s b) -&gt; Term s b)
-&gt; PlutusType PStakeRedeemer
forall (s :: S) (b :: PType).
Term s (PInner PStakeRedeemer b)
-&gt; (PStakeRedeemer s -&gt; Term s b) -&gt; Term s b
forall (s :: S) (b :: PType).
PStakeRedeemer s -&gt; Term s (PInner PStakeRedeemer b)
forall (a :: PType).
PCon a
-&gt; PMatch a
-&gt; (forall (s :: S) (b :: PType). a s -&gt; Term s (PInner a b))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PInner a b) -&gt; (a s -&gt; Term s b) -&gt; Term s b)
-&gt; PlutusType a
pmatch' :: forall (s :: S) (b :: PType).
Term s (PInner PStakeRedeemer b)
-&gt; (PStakeRedeemer s -&gt; Term s b) -&gt; Term s b
$cpmatch' :: forall (s :: S) (b :: PType).
Term s (PInner PStakeRedeemer b)
-&gt; (PStakeRedeemer s -&gt; Term s b) -&gt; Term s b
pcon' :: forall (s :: S) (b :: PType).
PStakeRedeemer s -&gt; Term s (PInner PStakeRedeemer b)
$cpcon' :: forall (s :: S) (b :: PType).
PStakeRedeemer s -&gt; Term s (PInner PStakeRedeemer b)
</span><a href="#local-6989586621679541967"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">PlutusType</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679541956"><span id="local-6989586621679541961"><span class="annot"><span class="annottext">(forall (s :: S).
 Term s (PAsData PStakeRedeemer) -&gt; Term s PStakeRedeemer)
-&gt; (forall (s :: S). Term s PStakeRedeemer -&gt; Term s PData)
-&gt; PIsData PStakeRedeemer
forall (s :: S).
Term s (PAsData PStakeRedeemer) -&gt; Term s PStakeRedeemer
forall (s :: S). Term s PStakeRedeemer -&gt; Term s PData
forall (a :: PType).
(forall (s :: S). Term s (PAsData a) -&gt; Term s a)
-&gt; (forall (s :: S). Term s a -&gt; Term s PData) -&gt; PIsData a
pdataImpl :: forall (s :: S). Term s PStakeRedeemer -&gt; Term s PData
$cpdataImpl :: forall (s :: S). Term s PStakeRedeemer -&gt; Term s PData
pfromDataImpl :: forall (s :: S).
Term s (PAsData PStakeRedeemer) -&gt; Term s PStakeRedeemer
$cpfromDataImpl :: forall (s :: S).
Term s (PAsData PStakeRedeemer) -&gt; Term s PStakeRedeemer
</span><a href="#local-6989586621679541956"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">PIsData</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-keyword">via</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PIsDataReprInstances</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PStakeRedeemer"><span class="hs-identifier hs-type">PStakeRedeemer</span></a></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span id="local-6989586621679541947"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PIsDataReprInstances</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PStakeRedeemer"><span class="hs-identifier hs-type">PStakeRedeemer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-keyword">instance</span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTryFrom</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PStakeRedeemer"><span class="hs-identifier hs-type">PStakeRedeemer</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PUnsafeLiftDecl</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PStakeRedeemer"><span class="hs-identifier hs-type">PStakeRedeemer</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-keyword">type</span><span> </span><span id="PLifted"><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PLifted</span></a></span></span><span> </span><span class="annot"><a href="Agora.Stake.html#PStakeRedeemer"><span class="hs-identifier hs-type">PStakeRedeemer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agora.Stake.html#StakeRedeemer"><span class="hs-identifier hs-type">StakeRedeemer</span></a></span><span>
</span><span id="line-223"></span><span id="local-6989586621679541874"><span id="local-6989586621679541883"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">DerivePConstantViaData</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#StakeRedeemer"><span class="hs-identifier hs-type">StakeRedeemer</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PStakeRedeemer"><span class="hs-identifier hs-type">PStakeRedeemer</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PConstantDecl</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#StakeRedeemer"><span class="hs-identifier hs-type">StakeRedeemer</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-comment">-- | Plutarch-level version of 'ProposalLock'.</span><span>
</span><span id="line-226"></span><span id="local-6989586621679541864"><span id="local-6989586621679541865"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="PProposalLock"><span class="annot"><a href="Agora.Stake.html#PProposalLock"><span class="hs-identifier hs-var">PProposalLock</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679544094"><span class="annot"><a href="#local-6989586621679544094"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">S</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PProposalLock"><span class="annot"><a href="Agora.Stake.html#PProposalLock"><span class="hs-identifier hs-var">PProposalLock</span></a></span></span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="getProposalLock"><span class="annot"><span class="annottext">forall (s :: S).
PProposalLock s
-&gt; Term
     s
     (PDataRecord
        ((':)
           @PLabeledType
           (&quot;vote&quot; ':= PResultTag)
           ((':)
              @PLabeledType
              (&quot;proposalTag&quot; ':= PProposalId)
              ('[] @PLabeledType))))
</span><a href="Agora.Stake.html#getProposalLock"><span class="hs-identifier hs-var hs-var">getProposalLock</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-228"></span><span>      </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span>
</span><span id="line-229"></span><span>        </span><span class="annot"><a href="#local-6989586621679544094"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-230"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDataRecord</span></a></span><span>
</span><span id="line-231"></span><span>            </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;vote&quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:=</span><span> </span><span class="annot"><a href="Agora.Proposal.html#PResultTag"><span class="hs-identifier hs-type">PResultTag</span></a></span><span>
</span><span id="line-232"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;proposalTag&quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:=</span><span> </span><span class="annot"><a href="Agora.Proposal.html#PProposalId"><span class="hs-identifier hs-type">PProposalId</span></a></span><span>
</span><span id="line-233"></span><span>             </span><span class="hs-special">]</span><span>
</span><span id="line-234"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. PProposalLock s -&gt; Rep (PProposalLock s) x)
-&gt; (forall x. Rep (PProposalLock s) x -&gt; PProposalLock s)
-&gt; Generic (PProposalLock s)
forall x. Rep (PProposalLock s) x -&gt; PProposalLock s
forall x. PProposalLock s -&gt; Rep (PProposalLock s) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (s :: S) x. Rep (PProposalLock s) x -&gt; PProposalLock s
forall (s :: S) x. PProposalLock s -&gt; Rep (PProposalLock s) x
$cto :: forall (s :: S) x. Rep (PProposalLock s) x -&gt; PProposalLock s
$cfrom :: forall (s :: S) x. PProposalLock s -&gt; Rep (PProposalLock s) x
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">GHC.Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679541853"><span id="local-6989586621679541855"><span class="annot"><span class="annottext">All @[Type] (SListI @Type) (Code (PProposalLock s))
All @[Type] (SListI @Type) (Code (PProposalLock s))
-&gt; (PProposalLock s -&gt; Rep (PProposalLock s))
-&gt; (Rep (PProposalLock s) -&gt; PProposalLock s)
-&gt; Generic (PProposalLock s)
Rep (PProposalLock s) -&gt; PProposalLock s
PProposalLock s -&gt; Rep (PProposalLock s)
forall a.
All @[Type] (SListI @Type) (Code a)
-&gt; (a -&gt; Rep a) -&gt; (Rep a -&gt; a) -&gt; Generic a
forall {s :: S}.
All @[Type] (SListI @Type) (Code (PProposalLock s))
forall (s :: S). Rep (PProposalLock s) -&gt; PProposalLock s
forall (s :: S). PProposalLock s -&gt; Rep (PProposalLock s)
to :: Rep (PProposalLock s) -&gt; PProposalLock s
$cto :: forall (s :: S). Rep (PProposalLock s) -&gt; PProposalLock s
from :: PProposalLock s -&gt; Rep (PProposalLock s)
$cfrom :: forall (s :: S). PProposalLock s -&gt; Rep (PProposalLock s)
</span><a href="#local-6989586621679541853"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679541840"><span id="local-6989586621679541842"><span class="annot"><span class="annottext">PIsData PProposalLock
PlutusType PProposalLock
PlutusType PProposalLock
-&gt; PIsData PProposalLock
-&gt; (forall (s :: S).
    PProposalLock s
    -&gt; Term s (PDataSum (PIsDataReprRepr PProposalLock)))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PDataSum (PIsDataReprRepr PProposalLock))
    -&gt; (PProposalLock s -&gt; Term s b) -&gt; Term s b)
-&gt; PIsDataRepr PProposalLock
forall (s :: S).
PProposalLock s
-&gt; Term s (PDataSum (PIsDataReprRepr PProposalLock))
forall (s :: S) (b :: PType).
Term s (PDataSum (PIsDataReprRepr PProposalLock))
-&gt; (PProposalLock s -&gt; Term s b) -&gt; Term s b
forall (a :: PType).
PlutusType a
-&gt; PIsData a
-&gt; (forall (s :: S). a s -&gt; Term s (PDataSum (PIsDataReprRepr a)))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PDataSum (PIsDataReprRepr a))
    -&gt; (a s -&gt; Term s b) -&gt; Term s b)
-&gt; PIsDataRepr a
pmatchRepr :: forall (s :: S) (b :: PType).
Term s (PDataSum (PIsDataReprRepr PProposalLock))
-&gt; (PProposalLock s -&gt; Term s b) -&gt; Term s b
$cpmatchRepr :: forall (s :: S) (b :: PType).
Term s (PDataSum (PIsDataReprRepr PProposalLock))
-&gt; (PProposalLock s -&gt; Term s b) -&gt; Term s b
pconRepr :: forall (s :: S).
PProposalLock s
-&gt; Term s (PDataSum (PIsDataReprRepr PProposalLock))
$cpconRepr :: forall (s :: S).
PProposalLock s
-&gt; Term s (PDataSum (PIsDataReprRepr PProposalLock))
</span><a href="#local-6989586621679541840"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">PIsDataRepr</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-keyword">deriving</span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679541826"><span id="local-6989586621679541832"><span class="annot"><span class="annottext">PCon PProposalLock
PMatch PProposalLock
PCon PProposalLock
-&gt; PMatch PProposalLock
-&gt; (forall (s :: S) (b :: PType).
    PProposalLock s -&gt; Term s (PInner PProposalLock b))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PInner PProposalLock b)
    -&gt; (PProposalLock s -&gt; Term s b) -&gt; Term s b)
-&gt; PlutusType PProposalLock
forall (s :: S) (b :: PType).
Term s (PInner PProposalLock b)
-&gt; (PProposalLock s -&gt; Term s b) -&gt; Term s b
forall (s :: S) (b :: PType).
PProposalLock s -&gt; Term s (PInner PProposalLock b)
forall (a :: PType).
PCon a
-&gt; PMatch a
-&gt; (forall (s :: S) (b :: PType). a s -&gt; Term s (PInner a b))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PInner a b) -&gt; (a s -&gt; Term s b) -&gt; Term s b)
-&gt; PlutusType a
pmatch' :: forall (s :: S) (b :: PType).
Term s (PInner PProposalLock b)
-&gt; (PProposalLock s -&gt; Term s b) -&gt; Term s b
$cpmatch' :: forall (s :: S) (b :: PType).
Term s (PInner PProposalLock b)
-&gt; (PProposalLock s -&gt; Term s b) -&gt; Term s b
pcon' :: forall (s :: S) (b :: PType).
PProposalLock s -&gt; Term s (PInner PProposalLock b)
$cpcon' :: forall (s :: S) (b :: PType).
PProposalLock s -&gt; Term s (PInner PProposalLock b)
</span><a href="#local-6989586621679541826"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">PlutusType</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679541815"><span id="local-6989586621679541820"><span class="annot"><span class="annottext">(forall (s :: S).
 Term s (PAsData PProposalLock) -&gt; Term s PProposalLock)
-&gt; (forall (s :: S). Term s PProposalLock -&gt; Term s PData)
-&gt; PIsData PProposalLock
forall (s :: S).
Term s (PAsData PProposalLock) -&gt; Term s PProposalLock
forall (s :: S). Term s PProposalLock -&gt; Term s PData
forall (a :: PType).
(forall (s :: S). Term s (PAsData a) -&gt; Term s a)
-&gt; (forall (s :: S). Term s a -&gt; Term s PData) -&gt; PIsData a
pdataImpl :: forall (s :: S). Term s PProposalLock -&gt; Term s PData
$cpdataImpl :: forall (s :: S). Term s PProposalLock -&gt; Term s PData
pfromDataImpl :: forall (s :: S).
Term s (PAsData PProposalLock) -&gt; Term s PProposalLock
$cpfromDataImpl :: forall (s :: S).
Term s (PAsData PProposalLock) -&gt; Term s PProposalLock
</span><a href="#local-6989586621679541815"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">PIsData</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679541810"><span class="annot"><span class="annottext">(forall (s :: S).
 Term s PProposalLock
 -&gt; Term s (PDataRecord (PFields PProposalLock)))
-&gt; PDataFields PProposalLock
forall (s :: S).
Term s PProposalLock
-&gt; Term s (PDataRecord (PFields PProposalLock))
forall (a :: PType).
(forall (s :: S). Term s a -&gt; Term s (PDataRecord (PFields a)))
-&gt; PDataFields a
ptoFields :: forall (s :: S).
Term s PProposalLock
-&gt; Term s (PDataRecord (PFields PProposalLock))
$cptoFields :: forall (s :: S).
Term s PProposalLock
-&gt; Term s (PDataRecord (PFields PProposalLock))
</span><a href="#local-6989586621679541810"><span class="hs-identifier hs-var hs-var hs-var hs-var">PDataFields</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679541799"><span class="annot"><span class="annottext">(forall (s :: S).
 Term s PProposalLock -&gt; Term s PProposalLock -&gt; Term s PBool)
-&gt; PEq PProposalLock
forall (s :: S).
Term s PProposalLock -&gt; Term s PProposalLock -&gt; Term s PBool
forall (t :: PType).
(forall (s :: S). Term s t -&gt; Term s t -&gt; Term s PBool) -&gt; PEq t
#== :: forall (s :: S).
Term s PProposalLock -&gt; Term s PProposalLock -&gt; Term s PBool
$c#== :: forall (s :: S).
Term s PProposalLock -&gt; Term s PProposalLock -&gt; Term s PBool
</span><a href="#local-6989586621679541799"><span class="hs-identifier hs-var hs-var hs-var hs-var">PEq</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-keyword">via</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PIsDataReprInstances</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PProposalLock"><span class="hs-identifier hs-type">PProposalLock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span id="local-6989586621679541789"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PIsDataReprInstances</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PProposalLock"><span class="hs-identifier hs-type">PProposalLock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-keyword">instance</span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTryFrom</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PProposalLock"><span class="hs-identifier hs-type">PProposalLock</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PUnsafeLiftDecl</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PProposalLock"><span class="hs-identifier hs-type">PProposalLock</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-keyword">type</span><span> </span><span id="PLifted"><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PLifted</span></a></span></span><span> </span><span class="annot"><a href="Agora.Stake.html#PProposalLock"><span class="hs-identifier hs-type">PProposalLock</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agora.Stake.html#ProposalLock"><span class="hs-identifier hs-type">ProposalLock</span></a></span><span>
</span><span id="line-249"></span><span id="local-6989586621679541741"><span id="local-6989586621679541750"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">DerivePConstantViaData</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#ProposalLock"><span class="hs-identifier hs-type">ProposalLock</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PProposalLock"><span class="hs-identifier hs-type">PProposalLock</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PConstantDecl</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#ProposalLock"><span class="hs-identifier hs-type">ProposalLock</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- | Check whether a Stake is locked. If it is locked, various actions are unavailable.</span><span>
</span><span id="line-254"></span><span class="annot"><a href="Agora.Stake.html#stakeLocked"><span class="hs-identifier hs-type">stakeLocked</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679544081"><span class="annot"><a href="#local-6989586621679544081"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">S</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679544081"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agora.Stake.html#PStakeDatum"><span class="hs-identifier hs-type">PStakeDatum</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span id="stakeLocked"><span class="annot"><span class="annottext">stakeLocked :: forall (s :: S). Term s (PStakeDatum :--&gt; PBool)
</span><a href="Agora.Stake.html#stakeLocked"><span class="hs-identifier hs-var hs-var">stakeLocked</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (s :: S). Term s (PStakeDatum :--&gt; PBool))
-&gt; Term s (PStakeDatum :--&gt; PBool)
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (s :: S). Term s (PStakeDatum :--&gt; PBool))
 -&gt; Term s (PStakeDatum :--&gt; PBool))
-&gt; (forall (s :: S). Term s (PStakeDatum :--&gt; PBool))
-&gt; Term s (PStakeDatum :--&gt; PBool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span class="annot"><span class="annottext">(Term s PStakeDatum -&gt; Term s PBool)
-&gt; Term s (PStakeDatum :--&gt; PBool)
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PStakeDatum -&gt; Term s PBool)
 -&gt; Term s (PStakeDatum :--&gt; PBool))
-&gt; (Term s PStakeDatum -&gt; Term s PBool)
-&gt; Term s (PStakeDatum :--&gt; PBool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679541719"><span class="annot"><span class="annottext">Term s PStakeDatum
</span><a href="#local-6989586621679541719"><span class="hs-identifier hs-var">stakeDatum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679541718"><span class="hs-identifier hs-type">locks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBuiltinList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PProposalLock"><span class="hs-identifier hs-type">PProposalLock</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>        </span><span id="local-6989586621679541718"><span class="annot"><span class="annottext">locks :: Term s (PBuiltinList (PAsData PProposalLock))
</span><a href="#local-6989586621679541718"><span class="hs-identifier hs-var hs-var">locks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (name :: Symbol) (p :: PType) (s :: S) (a :: PType)
       (as :: [PLabeledType]) (n :: Nat) (b :: PType).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfield</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;lockedBy&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term s (PStakeDatum :--&gt; PBuiltinList (PAsData PProposalLock))
-&gt; Term s PStakeDatum
-&gt; Term s (PBuiltinList (PAsData PProposalLock))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PStakeDatum
</span><a href="#local-6989586621679541719"><span class="hs-identifier hs-var">stakeDatum</span></a></span><span>
</span><span id="line-259"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData PProposalLock) :--&gt; PBool)
forall (a :: PType) (s :: S) (list :: PType -&gt; PType).
PIsListLike list a =&gt;
Term s (list a :--&gt; PBool)
</span><a href="../file:///nix/store/gzm24k1s2d3v375gfj8rfxzbnxw2n9gj-liqwid-plutarch-extra-lib-liqwid-plutarch-extra-1.1.0-haddock-doc/share/doc/liqwid-plutarch-extra/html/src"><span class="hs-identifier hs-var">pnotNull</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData PProposalLock) :--&gt; PBool)
-&gt; Term s (PBuiltinList (PAsData PProposalLock)) -&gt; Term s PBool
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData PProposalLock))
</span><a href="#local-6989586621679541718"><span class="hs-identifier hs-var">locks</span></a></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-comment">-- | Find a stake owned by a particular PK.</span><span>
</span><span id="line-262"></span><span id="local-6989586621679544041"><span class="annot"><a href="Agora.Stake.html#findStakeOwnedBy"><span class="hs-identifier hs-type">findStakeOwnedBy</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-263"></span><span>  </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><a href="#local-6989586621679544041"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/gzm24k1s2d3v375gfj8rfxzbnxw2n9gj-liqwid-plutarch-extra-lib-liqwid-plutarch-extra-1.1.0-haddock-doc/share/doc/liqwid-plutarch-extra/html/src"><span class="hs-identifier hs-type">PAssetClass</span></a></span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PPubKeyHash</span></a></span><span>
</span><span id="line-267"></span><span>        </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBuiltinList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTuple</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDatumHash</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDatum</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>        </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBuiltinList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxInInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>        </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PStakeDatum"><span class="hs-identifier hs-type">PStakeDatum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-special">)</span></span><span>
</span><span id="line-271"></span><span id="findStakeOwnedBy"><span class="annot"><span class="annottext">findStakeOwnedBy :: forall (s :: S).
Term
  s
  (PAssetClass
   :--&gt; (PPubKeyHash
         :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
               :--&gt; (PBuiltinList (PAsData PTxInInfo)
                     :--&gt; PMaybe (PAsData PStakeDatum)))))
</span><a href="Agora.Stake.html#findStakeOwnedBy"><span class="hs-identifier hs-var hs-var">findStakeOwnedBy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (s :: S).
 Term
   s
   (PAssetClass
    :--&gt; (PPubKeyHash
          :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
                :--&gt; (PBuiltinList (PAsData PTxInInfo)
                      :--&gt; PMaybe (PAsData PStakeDatum))))))
-&gt; Term
     s
     (PAssetClass
      :--&gt; (PPubKeyHash
            :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
                  :--&gt; (PBuiltinList (PAsData PTxInInfo)
                        :--&gt; PMaybe (PAsData PStakeDatum)))))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (s :: S).
  Term
    s
    (PAssetClass
     :--&gt; (PPubKeyHash
           :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
                 :--&gt; (PBuiltinList (PAsData PTxInInfo)
                       :--&gt; PMaybe (PAsData PStakeDatum))))))
 -&gt; Term
      s
      (PAssetClass
       :--&gt; (PPubKeyHash
             :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
                   :--&gt; (PBuiltinList (PAsData PTxInInfo)
                         :--&gt; PMaybe (PAsData PStakeDatum))))))
-&gt; (forall (s :: S).
    Term
      s
      (PAssetClass
       :--&gt; (PPubKeyHash
             :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
                   :--&gt; (PBuiltinList (PAsData PTxInInfo)
                         :--&gt; PMaybe (PAsData PStakeDatum))))))
-&gt; Term
     s
     (PAssetClass
      :--&gt; (PPubKeyHash
            :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
                  :--&gt; (PBuiltinList (PAsData PTxInInfo)
                        :--&gt; PMaybe (PAsData PStakeDatum)))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><span class="annottext">(Term s PAssetClass
 -&gt; Term s PPubKeyHash
 -&gt; Term s (PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
 -&gt; Term s (PBuiltinList (PAsData PTxInInfo))
 -&gt; Term s (PMaybe (PAsData PStakeDatum)))
-&gt; Term
     s
     (PAssetClass
      :--&gt; (PPubKeyHash
            :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
                  :--&gt; (PBuiltinList (PAsData PTxInInfo)
                        :--&gt; PMaybe (PAsData PStakeDatum)))))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PAssetClass
  -&gt; Term s PPubKeyHash
  -&gt; Term s (PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
  -&gt; Term s (PBuiltinList (PAsData PTxInInfo))
  -&gt; Term s (PMaybe (PAsData PStakeDatum)))
 -&gt; Term
      s
      (PAssetClass
       :--&gt; (PPubKeyHash
             :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
                   :--&gt; (PBuiltinList (PAsData PTxInInfo)
                         :--&gt; PMaybe (PAsData PStakeDatum))))))
-&gt; (Term s PAssetClass
    -&gt; Term s PPubKeyHash
    -&gt; Term s (PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
    -&gt; Term s (PBuiltinList (PAsData PTxInInfo))
    -&gt; Term s (PMaybe (PAsData PStakeDatum)))
-&gt; Term
     s
     (PAssetClass
      :--&gt; (PPubKeyHash
            :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
                  :--&gt; (PBuiltinList (PAsData PTxInInfo)
                        :--&gt; PMaybe (PAsData PStakeDatum)))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679541622"><span class="annot"><span class="annottext">Term s PAssetClass
</span><a href="#local-6989586621679541622"><span class="hs-identifier hs-var">ac</span></a></span></span><span> </span><span id="local-6989586621679541621"><span class="annot"><span class="annottext">Term s PPubKeyHash
</span><a href="#local-6989586621679541621"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679541620"><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
</span><a href="#local-6989586621679541620"><span class="hs-identifier hs-var">datums</span></a></span></span><span> </span><span id="local-6989586621679541619"><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData PTxInInfo))
</span><a href="#local-6989586621679541619"><span class="hs-identifier hs-var">inputs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><span class="annottext">Term s (PMaybe (PAsData PTxInInfo))
-&gt; (PMaybe (PAsData PTxInInfo) s
    -&gt; Term s (PMaybe (PAsData PStakeDatum)))
-&gt; Term s (PMaybe (PAsData PStakeDatum))
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s
  ((PAsData PTxInInfo :--&gt; PBool)
   :--&gt; (PBuiltinList (PAsData PTxInInfo)
         :--&gt; PMaybe (PAsData PTxInInfo)))
forall (l :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike l a =&gt;
Term s ((a :--&gt; PBool) :--&gt; (l a :--&gt; PMaybe a))
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfind</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  ((PAsData PTxInInfo :--&gt; PBool)
   :--&gt; (PBuiltinList (PAsData PTxInInfo)
         :--&gt; PMaybe (PAsData PTxInInfo)))
-&gt; Term s (PAsData PTxInInfo :--&gt; PBool)
-&gt; Term
     s
     (PBuiltinList (PAsData PTxInInfo) :--&gt; PMaybe (PAsData PTxInInfo))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s
  (PAssetClass
   :--&gt; (PPubKeyHash
         :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
               :--&gt; (PAsData PTxInInfo :--&gt; PBool))))
forall {s :: S}.
Term
  s
  (PAssetClass
   :--&gt; (PPubKeyHash
         :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
               :--&gt; (PAsData PTxInInfo :--&gt; PBool))))
</span><a href="Agora.Stake.html#isInputStakeOwnedBy"><span class="hs-identifier hs-var">isInputStakeOwnedBy</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PAssetClass
   :--&gt; (PPubKeyHash
         :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
               :--&gt; (PAsData PTxInInfo :--&gt; PBool))))
-&gt; Term s PAssetClass
-&gt; Term
     s
     (PPubKeyHash
      :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
            :--&gt; (PAsData PTxInInfo :--&gt; PBool)))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PAssetClass
</span><a href="#local-6989586621679541622"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PPubKeyHash
   :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
         :--&gt; (PAsData PTxInInfo :--&gt; PBool)))
-&gt; Term s PPubKeyHash
-&gt; Term
     s
     (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
      :--&gt; (PAsData PTxInInfo :--&gt; PBool))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PPubKeyHash
</span><a href="#local-6989586621679541621"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
   :--&gt; (PAsData PTxInInfo :--&gt; PBool))
-&gt; Term s (PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
-&gt; Term s (PAsData PTxInInfo :--&gt; PBool)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
</span><a href="#local-6989586621679541620"><span class="hs-identifier hs-var">datums</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList (PAsData PTxInInfo) :--&gt; PMaybe (PAsData PTxInInfo))
-&gt; Term s (PBuiltinList (PAsData PTxInInfo))
-&gt; Term s (PMaybe (PAsData PTxInInfo))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData PTxInInfo))
</span><a href="#local-6989586621679541619"><span class="hs-identifier hs-var">inputs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((PMaybe (PAsData PTxInInfo) s
  -&gt; Term s (PMaybe (PAsData PStakeDatum)))
 -&gt; Term s (PMaybe (PAsData PStakeDatum)))
-&gt; (PMaybe (PAsData PTxInInfo) s
    -&gt; Term s (PMaybe (PAsData PStakeDatum)))
-&gt; Term s (PMaybe (PAsData PStakeDatum))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-274"></span><span>      </span><span class="annot"><span class="annottext">PMaybe (PAsData PTxInInfo) s
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PNothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PMaybe (PAsData PStakeDatum) s
-&gt; Term s (PMaybe (PAsData PStakeDatum))
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">PMaybe (PAsData PStakeDatum) s
forall (a :: PType) (s :: S). PMaybe a s
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PNothing</span></a></span><span>
</span><span id="line-275"></span><span>      </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PAsData PTxInInfo) -&gt; Term s PTxInInfo
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfromData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679541611"><span class="annot"><span class="annottext">Term s PTxInInfo
</span><a href="#local-6989586621679541611"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TermCont
  @(PMaybe (PAsData PStakeDatum))
  s
  (Term s (PMaybe (PAsData PStakeDatum)))
-&gt; Term s (PMaybe (PAsData PStakeDatum))
forall (a :: PType) (s :: S). TermCont @a s (Term s a) -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">unTermCont</span></a></span><span> </span><span class="annot"><span class="annottext">(TermCont
   @(PMaybe (PAsData PStakeDatum))
   s
   (Term s (PMaybe (PAsData PStakeDatum)))
 -&gt; Term s (PMaybe (PAsData PStakeDatum)))
-&gt; TermCont
     @(PMaybe (PAsData PStakeDatum))
     s
     (Term s (PMaybe (PAsData PStakeDatum)))
-&gt; Term s (PMaybe (PAsData PStakeDatum))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-276"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679541609"><span class="annot"><span class="annottext">txOut :: Term s (PAsData PTxOut)
</span><a href="#local-6989586621679541609"><span class="hs-identifier hs-var hs-var">txOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (name :: Symbol) (p :: PType) (s :: S) (a :: PType)
       (as :: [PLabeledType]) (n :: Nat) (b :: PType).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfield</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;resolved&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PDataSum
     ((':)
        @[PLabeledType]
        ((':)
           @PLabeledType
           (&quot;outRef&quot; ':= PTxOutRef)
           ((':) @PLabeledType (&quot;resolved&quot; ':= PTxOut) ('[] @PLabeledType)))
        ('[] @[PLabeledType]))
   :--&gt; PAsData PTxOut)
-&gt; Term
     s
     (PDataSum
        ((':)
           @[PLabeledType]
           ((':)
              @PLabeledType
              (&quot;outRef&quot; ':= PTxOutRef)
              ((':) @PLabeledType (&quot;resolved&quot; ':= PTxOut) ('[] @PLabeledType)))
           ('[] @[PLabeledType])))
-&gt; Term s (PAsData PTxOut)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTxInInfo
-&gt; forall (b :: PType). Term s (PInner PTxInInfo b)
forall (s :: S) (a :: PType).
Term s a -&gt; forall (b :: PType). Term s (PInner a b)
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pto</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTxInInfo
</span><a href="#local-6989586621679541611"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-277"></span><span>        </span><span id="local-6989586621679541607"><span class="annot"><span class="annottext">HRec
  (BoundTerms
     (PFields (PAsData PTxOut))
     (Bindings
        (PFields (PAsData PTxOut))
        ((':) @Symbol &quot;datumHash&quot; ('[] @Symbol)))
     s)
</span><a href="#local-6989586621679541607"><span class="hs-identifier hs-var">txOutF</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((HRec
    (BoundTerms
       (PFields (PAsData PTxOut))
       (Bindings
          (PFields (PAsData PTxOut))
          ((':) @Symbol &quot;datumHash&quot; ('[] @Symbol)))
       s)
  -&gt; Term s (PMaybe (PAsData PStakeDatum)))
 -&gt; Term s (PMaybe (PAsData PStakeDatum)))
-&gt; TermCont
     @(PMaybe (PAsData PStakeDatum))
     s
     (HRec
        (BoundTerms
           (PFields (PAsData PTxOut))
           (Bindings
              (PFields (PAsData PTxOut))
              ((':) @Symbol &quot;datumHash&quot; ('[] @Symbol)))
           s))
forall a (s :: S) (r :: PType).
((a -&gt; Term s r) -&gt; Term s r) -&gt; TermCont @r s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">tcont</span></a></span><span> </span><span class="annot"><span class="annottext">(((HRec
     (BoundTerms
        (PFields (PAsData PTxOut))
        (Bindings
           (PFields (PAsData PTxOut))
           ((':) @Symbol &quot;datumHash&quot; ('[] @Symbol)))
        s)
   -&gt; Term s (PMaybe (PAsData PStakeDatum)))
  -&gt; Term s (PMaybe (PAsData PStakeDatum)))
 -&gt; TermCont
      @(PMaybe (PAsData PStakeDatum))
      s
      (HRec
         (BoundTerms
            (PFields (PAsData PTxOut))
            (Bindings
               (PFields (PAsData PTxOut))
               ((':) @Symbol &quot;datumHash&quot; ('[] @Symbol)))
            s)))
-&gt; ((HRec
       (BoundTerms
          (PFields (PAsData PTxOut))
          (Bindings
             (PFields (PAsData PTxOut))
             ((':) @Symbol &quot;datumHash&quot; ('[] @Symbol)))
          s)
     -&gt; Term s (PMaybe (PAsData PStakeDatum)))
    -&gt; Term s (PMaybe (PAsData PStakeDatum)))
-&gt; TermCont
     @(PMaybe (PAsData PStakeDatum))
     s
     (HRec
        (BoundTerms
           (PFields (PAsData PTxOut))
           (Bindings
              (PFields (PAsData PTxOut))
              ((':) @Symbol &quot;datumHash&quot; ('[] @Symbol)))
           s))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fs :: [Symbol]) (a :: PType) (s :: S) (b :: PType)
       (ps :: [PLabeledType]) (bs :: [ToBind]).
(PDataFields a,
 (ps :: [PLabeledType]) ~ (PFields a :: [PLabeledType]),
 (bs :: [ToBind]) ~ (Bindings ps fs :: [ToBind]),
 BindFields ps bs) =&gt;
Term s a -&gt; (HRecOf a fs s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pletFields</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;datumHash&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Term s (PAsData PTxOut)
 -&gt; (HRec
       (BoundTerms
          (PFields (PAsData PTxOut))
          (Bindings
             (PFields (PAsData PTxOut))
             ((':) @Symbol &quot;datumHash&quot; ('[] @Symbol)))
          s)
     -&gt; Term s (PMaybe (PAsData PStakeDatum)))
 -&gt; Term s (PMaybe (PAsData PStakeDatum)))
-&gt; Term s (PAsData PTxOut)
-&gt; (HRec
      (BoundTerms
         (PFields (PAsData PTxOut))
         (Bindings
            (PFields (PAsData PTxOut))
            ((':) @Symbol &quot;datumHash&quot; ('[] @Symbol)))
         s)
    -&gt; Term s (PMaybe (PAsData PStakeDatum)))
-&gt; Term s (PMaybe (PAsData PStakeDatum))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData PTxOut)
</span><a href="#local-6989586621679541609"><span class="hs-identifier hs-var">txOut</span></a></span><span>
</span><span id="line-278"></span><span>        </span><span class="annot"><span class="annottext">Term s (PMaybe (PAsData PStakeDatum))
-&gt; TermCont
     @(PMaybe (PAsData PStakeDatum))
     s
     (Term s (PMaybe (PAsData PStakeDatum)))
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PMaybe (PAsData PStakeDatum))
 -&gt; TermCont
      @(PMaybe (PAsData PStakeDatum))
      s
      (Term s (PMaybe (PAsData PStakeDatum))))
-&gt; Term s (PMaybe (PAsData PStakeDatum))
-&gt; TermCont
     @(PMaybe (PAsData PStakeDatum))
     s
     (Term s (PMaybe (PAsData PStakeDatum)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-279"></span><span>          </span><span class="annot"><span class="annottext">Term s (PMaybeData PDatumHash)
-&gt; (PMaybeData PDatumHash s
    -&gt; Term s (PMaybe (PAsData PStakeDatum)))
-&gt; Term s (PMaybe (PAsData PStakeDatum))
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="annot"><span class="annottext">HRec
  (BoundTerms
     (PFields (PAsData PTxOut))
     (Bindings
        (PFields (PAsData PTxOut))
        ((':) @Symbol &quot;datumHash&quot; ('[] @Symbol)))
     s)
</span><a href="#local-6989586621679541607"><span class="hs-identifier hs-var">txOutF</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">datumHash</span><span> </span><span class="annot"><span class="annottext">((PMaybeData PDatumHash s -&gt; Term s (PMaybe (PAsData PStakeDatum)))
 -&gt; Term s (PMaybe (PAsData PStakeDatum)))
-&gt; (PMaybeData PDatumHash s
    -&gt; Term s (PMaybe (PAsData PStakeDatum)))
-&gt; Term s (PMaybe (PAsData PStakeDatum))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-280"></span><span>            </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDNothing</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PDataRecord ('[] @PLabeledType))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PMaybe (PAsData PStakeDatum) s
-&gt; Term s (PMaybe (PAsData PStakeDatum))
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">PMaybe (PAsData PStakeDatum) s
forall (a :: PType) (s :: S). PMaybe a s
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PNothing</span></a></span><span>
</span><span id="line-281"></span><span>            </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDJust</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (name :: Symbol) (p :: PType) (s :: S) (a :: PType)
       (as :: [PLabeledType]) (n :: Nat) (b :: PType).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfield</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;_0&quot;</span></span><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679541604"><span class="annot"><span class="annottext">Term s PDatumHash
</span><a href="#local-6989586621679541604"><span class="hs-identifier hs-var">dh</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-282"></span><span>              </span><span class="annot"><span class="annottext">forall (a :: PType) (s :: S).
PTryFrom PData a =&gt;
Term
  s
  (PDatumHash
   :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
         :--&gt; PMaybe a))
</span><a href="../file:///nix/store/gzm24k1s2d3v375gfj8rfxzbnxw2n9gj-liqwid-plutarch-extra-lib-liqwid-plutarch-extra-1.1.0-haddock-doc/share/doc/liqwid-plutarch-extra/html/src"><span class="hs-identifier hs-var">ptryFindDatum</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PStakeDatum"><span class="hs-identifier hs-type">PStakeDatum</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PDatumHash
   :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
         :--&gt; PMaybe (PAsData PStakeDatum)))
-&gt; Term s PDatumHash
-&gt; Term
     s
     (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
      :--&gt; PMaybe (PAsData PStakeDatum))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PDatumHash
</span><a href="#local-6989586621679541604"><span class="hs-identifier hs-var">dh</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
   :--&gt; PMaybe (PAsData PStakeDatum))
-&gt; Term s (PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
-&gt; Term s (PMaybe (PAsData PStakeDatum))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
</span><a href="#local-6989586621679541620"><span class="hs-identifier hs-var">datums</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="annot"><a href="Agora.Stake.html#stakeDatumOwnedBy"><span class="hs-identifier hs-type">stakeDatumOwnedBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PPubKeyHash</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PStakeDatum"><span class="hs-identifier hs-type">PStakeDatum</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span id="stakeDatumOwnedBy"><span class="annot"><span class="annottext">stakeDatumOwnedBy :: Term w (PPubKeyHash :--&gt; (PStakeDatum :--&gt; PBool))
</span><a href="Agora.Stake.html#stakeDatumOwnedBy"><span class="hs-identifier hs-var hs-var">stakeDatumOwnedBy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-286"></span><span>  </span><span class="annot"><span class="annottext">ClosedTerm (PPubKeyHash :--&gt; (PStakeDatum :--&gt; PBool))
-&gt; Term w (PPubKeyHash :--&gt; (PStakeDatum :--&gt; PBool))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">(ClosedTerm (PPubKeyHash :--&gt; (PStakeDatum :--&gt; PBool))
 -&gt; Term w (PPubKeyHash :--&gt; (PStakeDatum :--&gt; PBool)))
-&gt; ClosedTerm (PPubKeyHash :--&gt; (PStakeDatum :--&gt; PBool))
-&gt; Term w (PPubKeyHash :--&gt; (PStakeDatum :--&gt; PBool))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-287"></span><span>    </span><span class="annot"><span class="annottext">(Term s PPubKeyHash -&gt; Term s PStakeDatum -&gt; Term s PBool)
-&gt; Term s (PPubKeyHash :--&gt; (PStakeDatum :--&gt; PBool))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PPubKeyHash -&gt; Term s PStakeDatum -&gt; Term s PBool)
 -&gt; Term s (PPubKeyHash :--&gt; (PStakeDatum :--&gt; PBool)))
-&gt; (Term s PPubKeyHash -&gt; Term s PStakeDatum -&gt; Term s PBool)
-&gt; Term s (PPubKeyHash :--&gt; (PStakeDatum :--&gt; PBool))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679541577"><span class="annot"><span class="annottext">Term s PPubKeyHash
</span><a href="#local-6989586621679541577"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679541576"><span class="annot"><span class="annottext">Term s PStakeDatum
</span><a href="#local-6989586621679541576"><span class="hs-identifier hs-var">stakeDatum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-288"></span><span>      </span><span class="annot"><span class="annottext">forall (fs :: [Symbol]) (a :: PType) (s :: S) (b :: PType)
       (ps :: [PLabeledType]) (bs :: [ToBind]).
(PDataFields a,
 (ps :: [PLabeledType]) ~ (PFields a :: [PLabeledType]),
 (bs :: [ToBind]) ~ (Bindings ps fs :: [ToBind]),
 BindFields ps bs) =&gt;
Term s a -&gt; (HRecOf a fs s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pletFields</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;owner&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s PStakeDatum
-&gt; forall (b :: PType). Term s (PInner PStakeDatum b)
forall (s :: S) (a :: PType).
Term s a -&gt; forall (b :: PType). Term s (PInner a b)
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pto</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PStakeDatum
</span><a href="#local-6989586621679541576"><span class="hs-identifier hs-var">stakeDatum</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((HRec
    (BoundTerms
       (PFields (PInner PStakeDatum (Any @PType)))
       (Bindings
          (PFields (PInner PStakeDatum (Any @PType)))
          ((':) @Symbol &quot;owner&quot; ('[] @Symbol)))
       s)
  -&gt; Term s PBool)
 -&gt; Term s PBool)
-&gt; (HRec
      (BoundTerms
         (PFields (PInner PStakeDatum (Any @PType)))
         (Bindings
            (PFields (PInner PStakeDatum (Any @PType)))
            ((':) @Symbol &quot;owner&quot; ('[] @Symbol)))
         s)
    -&gt; Term s PBool)
-&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679541575"><span class="annot"><span class="annottext">HRec
  (BoundTerms
     (PFields (PInner PStakeDatum (Any @PType)))
     (Bindings
        (PFields (PInner PStakeDatum (Any @PType)))
        ((':) @Symbol &quot;owner&quot; ('[] @Symbol)))
     s)
</span><a href="#local-6989586621679541575"><span class="hs-identifier hs-var">stakeDatumF</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-289"></span><span>        </span><span class="annot"><span class="annottext">HRec
  (BoundTerms
     (PFields (PInner PStakeDatum (Any @PType)))
     (Bindings
        (PFields (PInner PStakeDatum (Any @PType)))
        ((':) @Symbol &quot;owner&quot; ('[] @Symbol)))
     s)
</span><a href="#local-6989586621679541575"><span class="hs-identifier hs-var">stakeDatumF</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">owner</span><span> </span><span class="annot"><span class="annottext">Term s (PAsData PPubKeyHash)
-&gt; Term s (PAsData PPubKeyHash) -&gt; Term s PBool
forall (t :: PType) (s :: S).
PEq t =&gt;
Term s t -&gt; Term s t -&gt; Term s PBool
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#==</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PPubKeyHash -&gt; Term s (PAsData PPubKeyHash)
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s a -&gt; Term s (PAsData a)
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pdata</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PPubKeyHash
</span><a href="#local-6989586621679541577"><span class="hs-identifier hs-var">pk</span></a></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-comment">-- | Does the input have a `Stake` owned by a particular PK?</span><span>
</span><span id="line-292"></span><span class="annot"><a href="Agora.Stake.html#isInputStakeOwnedBy"><span class="hs-identifier hs-type">isInputStakeOwnedBy</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-293"></span><span>  </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/gzm24k1s2d3v375gfj8rfxzbnxw2n9gj-liqwid-plutarch-extra-lib-liqwid-plutarch-extra-1.1.0-haddock-doc/share/doc/liqwid-plutarch-extra/html/src"><span class="hs-identifier hs-type">PAssetClass</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PPubKeyHash</span></a></span><span>
</span><span id="line-296"></span><span>        </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBuiltinList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTuple</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDatumHash</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDatum</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>        </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxInInfo</span></a></span><span>
</span><span id="line-298"></span><span>        </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBool</span></a></span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span id="isInputStakeOwnedBy"><span class="annot"><span class="annottext">isInputStakeOwnedBy :: Term
  s
  (PAssetClass
   :--&gt; (PPubKeyHash
         :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
               :--&gt; (PAsData PTxInInfo :--&gt; PBool))))
</span><a href="Agora.Stake.html#isInputStakeOwnedBy"><span class="hs-identifier hs-var hs-var">isInputStakeOwnedBy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-301"></span><span>  </span><span class="annot"><span class="annottext">(Term s PAssetClass
 -&gt; Term s PPubKeyHash
 -&gt; Term s (PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
 -&gt; Term s (PAsData PTxInInfo)
 -&gt; Term s PBool)
-&gt; Term
     s
     (PAssetClass
      :--&gt; (PPubKeyHash
            :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
                  :--&gt; (PAsData PTxInInfo :--&gt; PBool))))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PAssetClass
  -&gt; Term s PPubKeyHash
  -&gt; Term s (PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
  -&gt; Term s (PAsData PTxInInfo)
  -&gt; Term s PBool)
 -&gt; Term
      s
      (PAssetClass
       :--&gt; (PPubKeyHash
             :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
                   :--&gt; (PAsData PTxInInfo :--&gt; PBool)))))
-&gt; (Term s PAssetClass
    -&gt; Term s PPubKeyHash
    -&gt; Term s (PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
    -&gt; Term s (PAsData PTxInInfo)
    -&gt; Term s PBool)
-&gt; Term
     s
     (PAssetClass
      :--&gt; (PPubKeyHash
            :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
                  :--&gt; (PAsData PTxInInfo :--&gt; PBool))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679541485"><span class="annot"><span class="annottext">Term s PAssetClass
</span><a href="#local-6989586621679541485"><span class="hs-identifier hs-var">ac</span></a></span></span><span> </span><span id="local-6989586621679541484"><span class="annot"><span class="annottext">Term s PPubKeyHash
</span><a href="#local-6989586621679541484"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span id="local-6989586621679541483"><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
</span><a href="#local-6989586621679541483"><span class="hs-identifier hs-var">datums</span></a></span></span><span> </span><span id="local-6989586621679541482"><span class="annot"><span class="annottext">Term s (PAsData PTxInInfo)
</span><a href="#local-6989586621679541482"><span class="hs-identifier hs-var">txInInfo'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TermCont @PBool s (Term s PBool) -&gt; Term s PBool
forall (a :: PType) (s :: S). TermCont @a s (Term s a) -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">unTermCont</span></a></span><span> </span><span class="annot"><span class="annottext">(TermCont @PBool s (Term s PBool) -&gt; Term s PBool)
-&gt; TermCont @PBool s (Term s PBool) -&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxInInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (name :: Symbol) (p :: PType) (s :: S) (a :: PType)
       (as :: [PLabeledType]) (n :: Nat) (b :: PType).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfield</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;resolved&quot;</span></span><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679541481"><span class="annot"><span class="annottext">Term s PTxOut
</span><a href="#local-6989586621679541481"><span class="hs-identifier hs-var">txOut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s PTxInInfo -&gt; TermCont @PBool s (PTxInInfo s)
forall {r :: PType} (a :: PType) (s :: S).
PMatch a =&gt;
Term s a -&gt; TermCont @r s (a s)
</span><a href="../file:///nix/store/x2hnvsjw6yhhcdfyc1lfi4f51izw6pvw-plutarch-extra-lib-plutarch-extra-1.1.0-haddock-doc/share/doc/plutarch-extra/html/src"><span class="hs-identifier hs-var">pmatchC</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s PTxInInfo -&gt; TermCont @PBool s (PTxInInfo s))
-&gt; Term s PTxInInfo -&gt; TermCont @PBool s (PTxInInfo s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData PTxInInfo) -&gt; Term s PTxInInfo
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfromData</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData PTxInInfo)
</span><a href="#local-6989586621679541482"><span class="hs-identifier hs-var">txInInfo'</span></a></span><span>
</span><span id="line-303"></span><span>    </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxOut</span></a></span><span> </span><span id="local-6989586621679541480"><span class="annot"><span class="annottext">Term
  s
  (PDataRecord
     ((':)
        @PLabeledType
        (&quot;address&quot; ':= PAddress)
        ((':)
           @PLabeledType
           (&quot;value&quot; ':= PValue 'Sorted 'Positive)
           ((':)
              @PLabeledType
              (&quot;datumHash&quot; ':= PMaybeData PDatumHash)
              ('[] @PLabeledType)))))
</span><a href="#local-6989586621679541480"><span class="hs-identifier hs-var">txOut'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s PTxOut -&gt; TermCont @PBool s (PTxOut s)
forall {r :: PType} (a :: PType) (s :: S).
PMatch a =&gt;
Term s a -&gt; TermCont @r s (a s)
</span><a href="../file:///nix/store/x2hnvsjw6yhhcdfyc1lfi4f51izw6pvw-plutarch-extra-lib-plutarch-extra-1.1.0-haddock-doc/share/doc/plutarch-extra/html/src"><span class="hs-identifier hs-var">pmatchC</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTxOut
</span><a href="#local-6989586621679541481"><span class="hs-identifier hs-var">txOut</span></a></span><span>
</span><span id="line-304"></span><span>    </span><span id="local-6989586621679541479"><span class="annot"><span class="annottext">HRec
  ((':)
     @(Symbol, Type)
     '(&quot;value&quot;, Term s (PAsData (PValue 'Sorted 'Positive)))
     ((':)
        @(Symbol, Type)
        '(&quot;datumHash&quot;, Term s (PAsData (PMaybeData PDatumHash)))
        ('[] @(Symbol, Type))))
</span><a href="#local-6989586621679541479"><span class="hs-identifier hs-var">txOutF</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fs :: [Symbol]) (a :: PType) (s :: S) (b :: PType)
       (ps :: [PLabeledType]) (bs :: [ToBind]).
(PDataFields a,
 (ps :: [PLabeledType]) ~ (PFields a :: [PLabeledType]),
 (bs :: [ToBind]) ~ (Bindings ps fs :: [ToBind]),
 BindFields ps bs) =&gt;
Term s a -&gt; TermCont @b s (HRec (BoundTerms ps bs s))
</span><a href="../file:///nix/store/x2hnvsjw6yhhcdfyc1lfi4f51izw6pvw-plutarch-extra-lib-plutarch-extra-1.1.0-haddock-doc/share/doc/plutarch-extra/html/src"><span class="hs-identifier hs-var">pletFieldsC</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;value&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;datumHash&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PDataRecord
     ((':)
        @PLabeledType
        (&quot;address&quot; ':= PAddress)
        ((':)
           @PLabeledType
           (&quot;value&quot; ':= PValue 'Sorted 'Positive)
           ((':)
              @PLabeledType
              (&quot;datumHash&quot; ':= PMaybeData PDatumHash)
              ('[] @PLabeledType)))))
</span><a href="#local-6989586621679541480"><span class="hs-identifier hs-var">txOut'</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span id="local-6989586621679541478"><span class="annot"><span class="annottext">Term s (PInteger @S)
</span><a href="#local-6989586621679541478"><span class="hs-identifier hs-var">outStakeST</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S) -&gt; TermCont @PBool s (Term s (PInteger @S))
forall {r :: PType} (s :: S) (a :: PType).
Term s a -&gt; TermCont @r s (Term s a)
</span><a href="../file:///nix/store/x2hnvsjw6yhhcdfyc1lfi4f51izw6pvw-plutarch-extra-lib-plutarch-extra-1.1.0-haddock-doc/share/doc/plutarch-extra/html/src"><span class="hs-identifier hs-var">pletC</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PInteger @S) -&gt; TermCont @PBool s (Term s (PInteger @S)))
-&gt; Term s (PInteger @S) -&gt; TermCont @PBool s (Term s (PInteger @S))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s (PValue 'Sorted 'Positive :--&gt; (PAssetClass :--&gt; PInteger @S))
forall (s :: S) (keys :: KeyGuarantees)
       (amounts :: AmountGuarantees).
Term s (PValue keys amounts :--&gt; (PAssetClass :--&gt; PInteger @S))
</span><a href="../file:///nix/store/gzm24k1s2d3v375gfj8rfxzbnxw2n9gj-liqwid-plutarch-extra-lib-liqwid-plutarch-extra-1.1.0-haddock-doc/share/doc/liqwid-plutarch-extra/html/src"><span class="hs-identifier hs-var">passetClassValueOf</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s (PValue 'Sorted 'Positive :--&gt; (PAssetClass :--&gt; PInteger @S))
-&gt; Term s (PValue 'Sorted 'Positive)
-&gt; Term s (PAssetClass :--&gt; PInteger @S)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">HRec
  ((':)
     @(Symbol, Type)
     '(&quot;value&quot;, Term s (PAsData (PValue 'Sorted 'Positive)))
     ((':)
        @(Symbol, Type)
        '(&quot;datumHash&quot;, Term s (PAsData (PMaybeData PDatumHash)))
        ('[] @(Symbol, Type))))
</span><a href="#local-6989586621679541479"><span class="hs-identifier hs-var">txOutF</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">value</span><span> </span><span class="annot"><span class="annottext">Term s (PAssetClass :--&gt; PInteger @S)
-&gt; Term s PAssetClass -&gt; Term s (PInteger @S)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PAssetClass
</span><a href="#local-6989586621679541485"><span class="hs-identifier hs-var">ac</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="annottext">Term s PBool -&gt; TermCont @PBool s (Term s PBool)
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s PBool -&gt; TermCont @PBool s (Term s PBool))
-&gt; Term s PBool -&gt; TermCont @PBool s (Term s PBool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-307"></span><span>      </span><span class="annot"><span class="annottext">Term s (PMaybeData PDatumHash)
-&gt; (PMaybeData PDatumHash s -&gt; Term s PBool) -&gt; Term s PBool
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="annot"><span class="annottext">HRec
  ((':)
     @(Symbol, Type)
     '(&quot;value&quot;, Term s (PAsData (PValue 'Sorted 'Positive)))
     ((':)
        @(Symbol, Type)
        '(&quot;datumHash&quot;, Term s (PAsData (PMaybeData PDatumHash)))
        ('[] @(Symbol, Type))))
</span><a href="#local-6989586621679541479"><span class="hs-identifier hs-var">txOutF</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">datumHash</span><span> </span><span class="annot"><span class="annottext">((PMaybeData PDatumHash s -&gt; Term s PBool) -&gt; Term s PBool)
-&gt; (PMaybeData PDatumHash s -&gt; Term s PBool) -&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-308"></span><span>        </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDNothing</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PDataRecord ('[] @PLabeledType))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PBool s -&gt; Term s PBool
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">PBool s
forall (s :: S). PBool s
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PFalse</span></a></span><span>
</span><span id="line-309"></span><span>        </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDJust</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (name :: Symbol) (p :: PType) (s :: S) (a :: PType)
       (as :: [PLabeledType]) (n :: Nat) (b :: PType).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfield</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;_0&quot;</span></span><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679541476"><span class="annot"><span class="annottext">Term s PDatumHash
</span><a href="#local-6989586621679541476"><span class="hs-identifier hs-var">datumHash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-310"></span><span>          </span><span class="annot"><span class="annottext">Term s PBool -&gt; Term s PBool -&gt; Term s PBool -&gt; Term s PBool
forall (s :: S) (a :: PType).
Term s PBool -&gt; Term s a -&gt; Term s a -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pif</span></a></span><span>
</span><span id="line-311"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PInteger @S)
</span><a href="#local-6989586621679541478"><span class="hs-identifier hs-var">outStakeST</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S) -&gt; Term s (PInteger @S) -&gt; Term s PBool
forall (t :: PType) (s :: S).
PEq t =&gt;
Term s t -&gt; Term s t -&gt; Term s PBool
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#==</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S)
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Term s (PMaybe (PAsData PStakeDatum))
-&gt; (PMaybe (PAsData PStakeDatum) s -&gt; Term s PBool) -&gt; Term s PBool
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: PType) (s :: S).
PTryFrom PData a =&gt;
Term
  s
  (PDatumHash
   :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
         :--&gt; PMaybe a))
</span><a href="../file:///nix/store/gzm24k1s2d3v375gfj8rfxzbnxw2n9gj-liqwid-plutarch-extra-lib-liqwid-plutarch-extra-1.1.0-haddock-doc/share/doc/liqwid-plutarch-extra/html/src"><span class="hs-identifier hs-var">ptryFindDatum</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PStakeDatum"><span class="hs-identifier hs-type">PStakeDatum</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PDatumHash
   :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
         :--&gt; PMaybe (PAsData PStakeDatum)))
-&gt; Term s PDatumHash
-&gt; Term
     s
     (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
      :--&gt; PMaybe (PAsData PStakeDatum))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PDatumHash
</span><a href="#local-6989586621679541476"><span class="hs-identifier hs-var">datumHash</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
   :--&gt; PMaybe (PAsData PStakeDatum))
-&gt; Term s (PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
-&gt; Term s (PMaybe (PAsData PStakeDatum))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
</span><a href="#local-6989586621679541483"><span class="hs-identifier hs-var">datums</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((PMaybe (PAsData PStakeDatum) s -&gt; Term s PBool) -&gt; Term s PBool)
-&gt; (PMaybe (PAsData PStakeDatum) s -&gt; Term s PBool) -&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-313"></span><span>                </span><span class="annot"><span class="annottext">PMaybe (PAsData PStakeDatum) s
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PNothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PBool s -&gt; Term s PBool
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">PBool s
forall (s :: S). PBool s
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PFalse</span></a></span><span>
</span><span id="line-314"></span><span>                </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PJust</span></a></span><span> </span><span id="local-6989586621679541474"><span class="annot"><span class="annottext">Term s (PAsData PStakeDatum)
</span><a href="#local-6989586621679541474"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term s (PPubKeyHash :--&gt; (PStakeDatum :--&gt; PBool))
ClosedTerm (PPubKeyHash :--&gt; (PStakeDatum :--&gt; PBool))
</span><a href="Agora.Stake.html#stakeDatumOwnedBy"><span class="hs-identifier hs-var">stakeDatumOwnedBy</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PPubKeyHash :--&gt; (PStakeDatum :--&gt; PBool))
-&gt; Term s PPubKeyHash -&gt; Term s (PStakeDatum :--&gt; PBool)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PPubKeyHash
</span><a href="#local-6989586621679541484"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PStakeDatum :--&gt; PBool)
-&gt; Term s PStakeDatum -&gt; Term s PBool
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData PStakeDatum) -&gt; Term s PStakeDatum
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfromData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PAsData PStakeDatum) -&gt; Term s (PAsData PStakeDatum)
forall (s :: S) (a :: PType) (b :: PType). Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">punsafeCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData PStakeDatum)
</span><a href="#local-6989586621679541474"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PBool s -&gt; Term s PBool
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">PBool s
forall (s :: S). PBool s
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PFalse</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="hs-comment">{- | Represent the usage of a stake on a particular proposal.
     A stake can be used to either create or vote on a proposal.
-}</span><span>
</span><span id="line-321"></span><span id="local-6989586621679541472"><span id="local-6989586621679541473"></span></span><span class="hs-keyword">data</span><span> </span><span id="PStakeUsage"><span class="annot"><a href="Agora.Stake.html#PStakeUsage"><span class="hs-identifier hs-var">PStakeUsage</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679543910"><span class="annot"><a href="#local-6989586621679543910"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">S</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PVotedFor"><span class="annot"><a href="Agora.Stake.html#PVotedFor"><span class="hs-identifier hs-var">PVotedFor</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679543910"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Agora.Proposal.html#PResultTag"><span class="hs-identifier hs-type">PResultTag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PCreated"><span class="annot"><a href="Agora.Stake.html#PCreated"><span class="hs-identifier hs-var">PCreated</span></a></span></span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PDidNothing"><span class="annot"><a href="Agora.Stake.html#PDidNothing"><span class="hs-identifier hs-var">PDidNothing</span></a></span></span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. PStakeUsage s -&gt; Rep (PStakeUsage s) x)
-&gt; (forall x. Rep (PStakeUsage s) x -&gt; PStakeUsage s)
-&gt; Generic (PStakeUsage s)
forall x. Rep (PStakeUsage s) x -&gt; PStakeUsage s
forall x. PStakeUsage s -&gt; Rep (PStakeUsage s) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (s :: S) x. Rep (PStakeUsage s) x -&gt; PStakeUsage s
forall (s :: S) x. PStakeUsage s -&gt; Rep (PStakeUsage s) x
$cto :: forall (s :: S) x. Rep (PStakeUsage s) x -&gt; PStakeUsage s
$cfrom :: forall (s :: S) x. PStakeUsage s -&gt; Rep (PStakeUsage s) x
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">GHC.Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679541460"><span id="local-6989586621679541462"><span class="annot"><span class="annottext">All @[Type] (SListI @Type) (Code (PStakeUsage s))
All @[Type] (SListI @Type) (Code (PStakeUsage s))
-&gt; (PStakeUsage s -&gt; Rep (PStakeUsage s))
-&gt; (Rep (PStakeUsage s) -&gt; PStakeUsage s)
-&gt; Generic (PStakeUsage s)
Rep (PStakeUsage s) -&gt; PStakeUsage s
PStakeUsage s -&gt; Rep (PStakeUsage s)
forall a.
All @[Type] (SListI @Type) (Code a)
-&gt; (a -&gt; Rep a) -&gt; (Rep a -&gt; a) -&gt; Generic a
forall {s :: S}. All @[Type] (SListI @Type) (Code (PStakeUsage s))
forall (s :: S). Rep (PStakeUsage s) -&gt; PStakeUsage s
forall (s :: S). PStakeUsage s -&gt; Rep (PStakeUsage s)
to :: Rep (PStakeUsage s) -&gt; PStakeUsage s
$cto :: forall (s :: S). Rep (PStakeUsage s) -&gt; PStakeUsage s
from :: PStakeUsage s -&gt; Rep (PStakeUsage s)
$cfrom :: forall (s :: S). PStakeUsage s -&gt; Rep (PStakeUsage s)
</span><a href="#local-6989586621679541460"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679541444"><span id="local-6989586621679541446"><span class="annot"><span class="annottext">PCon PStakeUsage
PMatch PStakeUsage
PCon PStakeUsage
-&gt; PMatch PStakeUsage
-&gt; (forall (s :: S) (b :: PType).
    PStakeUsage s -&gt; Term s (PInner PStakeUsage b))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PInner PStakeUsage b)
    -&gt; (PStakeUsage s -&gt; Term s b) -&gt; Term s b)
-&gt; PlutusType PStakeUsage
forall (s :: S) (b :: PType).
Term s (PInner PStakeUsage b)
-&gt; (PStakeUsage s -&gt; Term s b) -&gt; Term s b
forall (s :: S) (b :: PType).
PStakeUsage s -&gt; Term s (PInner PStakeUsage b)
forall (a :: PType).
PCon a
-&gt; PMatch a
-&gt; (forall (s :: S) (b :: PType). a s -&gt; Term s (PInner a b))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PInner a b) -&gt; (a s -&gt; Term s b) -&gt; Term s b)
-&gt; PlutusType a
pmatch' :: forall (s :: S) (b :: PType).
Term s (PInner PStakeUsage b)
-&gt; (PStakeUsage s -&gt; Term s b) -&gt; Term s b
$cpmatch' :: forall (s :: S) (b :: PType).
Term s (PInner PStakeUsage b)
-&gt; (PStakeUsage s -&gt; Term s b) -&gt; Term s b
pcon' :: forall (s :: S) (b :: PType).
PStakeUsage s -&gt; Term s (PInner PStakeUsage b)
$cpcon' :: forall (s :: S) (b :: PType).
PStakeUsage s -&gt; Term s (PInner PStakeUsage b)
</span><a href="#local-6989586621679541444"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">PlutusType</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679541440"><span class="annot"><span class="annottext">Generic (PStakeUsage s)
Generic (PStakeUsage s)
-&gt; (forall (proxy :: Type -&gt; Type).
    proxy (PStakeUsage s) -&gt; DatatypeInfo (Code (PStakeUsage s)))
-&gt; HasDatatypeInfo (PStakeUsage s)
forall a.
Generic a
-&gt; (forall (proxy :: Type -&gt; Type).
    proxy a -&gt; DatatypeInfo (Code a))
-&gt; HasDatatypeInfo a
forall (s :: S). Generic (PStakeUsage s)
forall (s :: S) (proxy :: Type -&gt; Type).
proxy (PStakeUsage s) -&gt; DatatypeInfo (Code (PStakeUsage s))
forall (proxy :: Type -&gt; Type).
proxy (PStakeUsage s) -&gt; DatatypeInfo (Code (PStakeUsage s))
datatypeInfo :: forall (proxy :: Type -&gt; Type).
proxy (PStakeUsage s) -&gt; DatatypeInfo (Code (PStakeUsage s))
$cdatatypeInfo :: forall (s :: S) (proxy :: Type -&gt; Type).
proxy (PStakeUsage s) -&gt; DatatypeInfo (Code (PStakeUsage s))
</span><a href="../file:///nix/store/3m16k3x671sq04j9i42i5m85z4hc6yix-generics-sop-lib-generics-sop-0.5.1.2-haddock-doc/share/doc/generics-sop/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">HasDatatypeInfo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679541437"><span class="annot"><span class="annottext">(forall (s :: S).
 Term s PStakeUsage -&gt; Term s PStakeUsage -&gt; Term s PBool)
-&gt; PEq PStakeUsage
forall (s :: S).
Term s PStakeUsage -&gt; Term s PStakeUsage -&gt; Term s PBool
forall (t :: PType).
(forall (s :: S). Term s t -&gt; Term s t -&gt; Term s PBool) -&gt; PEq t
#== :: forall (s :: S).
Term s PStakeUsage -&gt; Term s PStakeUsage -&gt; Term s PBool
$c#== :: forall (s :: S).
Term s PStakeUsage -&gt; Term s PStakeUsage -&gt; Term s PBool
</span><a href="#local-6989586621679541437"><span class="hs-identifier hs-var hs-var hs-var hs-var">PEq</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="hs-comment">{- | / O(n) /.Return the usage of a stake on a particular proposal,
      given the 'lockedBy' field of a stake and the target proposal.
-}</span><span>
</span><span id="line-331"></span><span class="annot"><a href="Agora.Stake.html#pgetStakeUsage"><span class="hs-identifier hs-type">pgetStakeUsage</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-332"></span><span>  </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBuiltinList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PProposalLock"><span class="hs-identifier hs-type">PProposalLock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>        </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="Agora.Proposal.html#PProposalId"><span class="hs-identifier hs-type">PProposalId</span></a></span><span>
</span><span id="line-336"></span><span>        </span><span class="annot"><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="Agora.Stake.html#PStakeUsage"><span class="hs-identifier hs-type">PStakeUsage</span></a></span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span id="pgetStakeUsage"><span class="annot"><span class="annottext">pgetStakeUsage :: Term
  w
  (PBuiltinList (PAsData PProposalLock)
   :--&gt; (PProposalId :--&gt; PStakeUsage))
</span><a href="Agora.Stake.html#pgetStakeUsage"><span class="hs-identifier hs-var hs-var">pgetStakeUsage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClosedTerm
  (PBuiltinList (PAsData PProposalLock)
   :--&gt; (PProposalId :--&gt; PStakeUsage))
-&gt; Term
     w
     (PBuiltinList (PAsData PProposalLock)
      :--&gt; (PProposalId :--&gt; PStakeUsage))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">(ClosedTerm
   (PBuiltinList (PAsData PProposalLock)
    :--&gt; (PProposalId :--&gt; PStakeUsage))
 -&gt; Term
      w
      (PBuiltinList (PAsData PProposalLock)
       :--&gt; (PProposalId :--&gt; PStakeUsage)))
-&gt; ClosedTerm
     (PBuiltinList (PAsData PProposalLock)
      :--&gt; (PProposalId :--&gt; PStakeUsage))
-&gt; Term
     w
     (PBuiltinList (PAsData PProposalLock)
      :--&gt; (PProposalId :--&gt; PStakeUsage))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-339"></span><span>  </span><span class="annot"><span class="annottext">(Term s (PBuiltinList (PAsData PProposalLock))
 -&gt; Term s PProposalId -&gt; Term s PStakeUsage)
-&gt; Term
     s
     (PBuiltinList (PAsData PProposalLock)
      :--&gt; (PProposalId :--&gt; PStakeUsage))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s (PBuiltinList (PAsData PProposalLock))
  -&gt; Term s PProposalId -&gt; Term s PStakeUsage)
 -&gt; Term
      s
      (PBuiltinList (PAsData PProposalLock)
       :--&gt; (PProposalId :--&gt; PStakeUsage)))
-&gt; (Term s (PBuiltinList (PAsData PProposalLock))
    -&gt; Term s PProposalId -&gt; Term s PStakeUsage)
-&gt; Term
     s
     (PBuiltinList (PAsData PProposalLock)
      :--&gt; (PProposalId :--&gt; PStakeUsage))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679541378"><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData PProposalLock))
</span><a href="#local-6989586621679541378"><span class="hs-identifier hs-var">locks</span></a></span></span><span> </span><span id="local-6989586621679541377"><span class="annot"><span class="annottext">Term s PProposalId
</span><a href="#local-6989586621679541377"><span class="hs-identifier hs-var">pid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- All locks from the given proposal.</span><span>
</span><span id="line-341"></span><span>        </span><span id="local-6989586621679541376"><span class="annot"><span class="annottext">filteredLocks :: Term s (PBuiltinList (PAsData PProposalLock))
</span><a href="#local-6989586621679541376"><span class="hs-identifier hs-var hs-var">filteredLocks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-342"></span><span>          </span><span class="annot"><span class="annottext">Term
  s
  ((PAsData PProposalLock :--&gt; PMaybe (PAsData PProposalLock))
   :--&gt; (PBuiltinList (PAsData PProposalLock)
         :--&gt; PBuiltinList (PAsData PProposalLock)))
forall (a :: PType) (s :: S) (list :: PType -&gt; PType).
PIsListLike list a =&gt;
Term s ((a :--&gt; PMaybe a) :--&gt; (list a :--&gt; list a))
</span><a href="../file:///nix/store/gzm24k1s2d3v375gfj8rfxzbnxw2n9gj-liqwid-plutarch-extra-lib-liqwid-plutarch-extra-1.1.0-haddock-doc/share/doc/liqwid-plutarch-extra/html/src"><span class="hs-identifier hs-var">pmapMaybe</span></a></span><span class="hs-cpp">
            # plam
</span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">lock'</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">lock</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">unTermCont</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-345"></span><span>                  </span><span class="hs-identifier">lockF</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">pletFieldsC</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-string">&quot;proposalTag&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">lock</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span>                  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-348"></span><span>                    </span><span class="hs-identifier">pif</span><span>
</span><span id="line-349"></span><span>                      </span><span class="hs-special">(</span><span class="hs-identifier">lockF</span><span class="hs-operator">.</span><span class="hs-identifier">proposalTag</span><span> </span><span class="hs-operator">#==</span><span> </span><span class="hs-identifier">pid</span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>                      </span><span class="hs-special">(</span><span class="hs-identifier">pcon</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">PJust</span><span> </span><span class="hs-identifier">lock'</span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>                      </span><span class="hs-special">(</span><span class="hs-identifier">pcon</span><span> </span><span class="hs-identifier">PNothing</span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>              </span><span class="hs-special">)</span><span class="hs-cpp">
            # locks
</span><span>
</span><span id="line-355"></span><span>        </span><span id="local-6989586621679541372"><span class="annot"><span class="annottext">lockCount' :: Term s (PInteger @S)
</span><a href="#local-6989586621679541372"><span class="hs-identifier hs-var hs-var">lockCount'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData PProposalLock) :--&gt; PInteger @S)
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike list a =&gt;
Term s (list a :--&gt; PInteger @S)
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plength</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData PProposalLock) :--&gt; PInteger @S)
-&gt; Term s (PBuiltinList (PAsData PProposalLock))
-&gt; Term s (PInteger @S)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData PProposalLock))
</span><a href="#local-6989586621679541376"><span class="hs-identifier hs-var">filteredLocks</span></a></span><span>
</span><span id="line-356"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S)
-&gt; (Term s (PInteger @S) -&gt; Term s PStakeUsage)
-&gt; Term s PStakeUsage
forall (s :: S) (a :: PType) (b :: PType).
Term s a -&gt; (Term s a -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plet</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S)
</span><a href="#local-6989586621679541372"><span class="hs-identifier hs-var">lockCount'</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s (PInteger @S) -&gt; Term s PStakeUsage)
 -&gt; Term s PStakeUsage)
-&gt; (Term s (PInteger @S) -&gt; Term s PStakeUsage)
-&gt; Term s PStakeUsage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679541369"><span class="annot"><span class="annottext">Term s (PInteger @S)
</span><a href="#local-6989586621679541369"><span class="hs-identifier hs-var">lockCount</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-357"></span><span>          </span><span class="annot"><span class="annottext">Term s PBool
-&gt; Term s PStakeUsage -&gt; Term s PStakeUsage -&gt; Term s PStakeUsage
forall (s :: S) (a :: PType).
Term s PBool -&gt; Term s a -&gt; Term s a -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pif</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PInteger @S)
</span><a href="#local-6989586621679541369"><span class="hs-identifier hs-var">lockCount</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S) -&gt; Term s (PInteger @S) -&gt; Term s PBool
forall (t :: PType) (s :: S).
PEq t =&gt;
Term s t -&gt; Term s t -&gt; Term s PBool
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#==</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S)
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PStakeUsage s -&gt; Term s PStakeUsage
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">PStakeUsage s
forall (s :: S). PStakeUsage s
</span><a href="Agora.Stake.html#PDidNothing"><span class="hs-identifier hs-var">PDidNothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Term s PStakeUsage -&gt; Term s PStakeUsage)
-&gt; Term s PStakeUsage -&gt; Term s PStakeUsage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-358"></span><span>            </span><span class="annot"><span class="annottext">Term s PBool
-&gt; Term s PStakeUsage -&gt; Term s PStakeUsage -&gt; Term s PStakeUsage
forall (s :: S) (a :: PType).
Term s PBool -&gt; Term s a -&gt; Term s a -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pif</span></a></span><span>
</span><span id="line-359"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PInteger @S)
</span><a href="#local-6989586621679541369"><span class="hs-identifier hs-var">lockCount</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S) -&gt; Term s (PInteger @S) -&gt; Term s PBool
forall (t :: PType) (s :: S).
PEq t =&gt;
Term s t -&gt; Term s t -&gt; Term s PBool
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#==</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S)
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">PStakeUsage s -&gt; Term s PStakeUsage
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">(PStakeUsage s -&gt; Term s PStakeUsage)
-&gt; PStakeUsage s -&gt; Term s PStakeUsage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-361"></span><span>                  </span><span class="annot"><span class="annottext">Term s PResultTag -&gt; PStakeUsage s
forall (s :: S). Term s PResultTag -&gt; PStakeUsage s
</span><a href="Agora.Stake.html#PVotedFor"><span class="hs-identifier hs-var">PVotedFor</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s PResultTag -&gt; PStakeUsage s)
-&gt; Term s PResultTag -&gt; PStakeUsage s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-362"></span><span>                    </span><span class="annot"><span class="annottext">Term s (PAsData PResultTag) -&gt; Term s PResultTag
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfromData</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PAsData PResultTag) -&gt; Term s PResultTag)
-&gt; Term s (PAsData PResultTag) -&gt; Term s PResultTag
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/r4n325d4bya4i1cviz6zrwmhm4j55yz4-ghc-9.2.3-doc/share/doc/ghc/html/libraries/base-4.16.2.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-363"></span><span>                      </span><span class="annot"><span class="annottext">forall (name :: Symbol) (p :: PType) (s :: S) (a :: PType)
       (as :: [PLabeledType]) (n :: Nat) (b :: PType).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfield</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;vote&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData PProposalLock :--&gt; PAsData PResultTag)
-&gt; Term s (PAsData PProposalLock) -&gt; Term s (PAsData PResultTag)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#$</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s (PBuiltinList (PAsData PProposalLock) :--&gt; PAsData PProposalLock)
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
(PListLike list, PElemConstraint list a) =&gt;
Term s (list a :--&gt; a)
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phead</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s (PBuiltinList (PAsData PProposalLock) :--&gt; PAsData PProposalLock)
-&gt; Term s (PBuiltinList (PAsData PProposalLock))
-&gt; Term s (PAsData PProposalLock)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData PProposalLock))
</span><a href="#local-6989586621679541376"><span class="hs-identifier hs-var">filteredLocks</span></a></span><span>
</span><span id="line-364"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>              </span><span class="hs-comment">-- Note: see the implementation of the governor.</span><span>
</span><span id="line-366"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PStakeUsage s -&gt; Term s PStakeUsage
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/bhji90x2v2q0fi8ya6w3sbvwcyh0r0lb-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">PStakeUsage s
forall (s :: S). PStakeUsage s
</span><a href="Agora.Stake.html#PCreated"><span class="hs-identifier hs-var">PCreated</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span></pre></body></html>