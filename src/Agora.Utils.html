<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- |
Module     : Agora.Utils
Maintainer : emi@haskell.fyi
Description: Plutarch utility functions that should be upstreamed or don't belong anywhere else.

Plutarch utility functions that should be upstreamed or don't belong anywhere else.
-}</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Agora.Utils</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-9"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Validator-level utility functions</span></span><span>
</span><span id="line-10"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#passert"><span class="hs-identifier">passert</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#pfind%27"><span class="hs-identifier">pfind'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#pfindDatum"><span class="hs-identifier">pfindDatum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#pfindDatum%27"><span class="hs-identifier">pfindDatum'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#pvalueSpent"><span class="hs-identifier">pvalueSpent</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#ptxSignedBy"><span class="hs-identifier">ptxSignedBy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#paddValue"><span class="hs-identifier">paddValue</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#plookup"><span class="hs-identifier">plookup</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#pfromMaybe"><span class="hs-identifier">pfromMaybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#psymbolValueOf"><span class="hs-identifier">psymbolValueOf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#passetClassValueOf"><span class="hs-identifier">passetClassValueOf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#passetClassValueOf%27"><span class="hs-identifier">passetClassValueOf'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#pgeqByClass"><span class="hs-identifier">pgeqByClass</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#pgeqBySymbol"><span class="hs-identifier">pgeqBySymbol</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#pgeqByClass%27"><span class="hs-identifier">pgeqByClass'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#pfindTxInByTxOutRef"><span class="hs-identifier">pfindTxInByTxOutRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#psingletonValue"><span class="hs-identifier">psingletonValue</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#pfindMap"><span class="hs-identifier">pfindMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#pnotNull"><span class="hs-identifier">pnotNull</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#pisJust"><span class="hs-identifier">pisJust</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Functions which should (probably) not be upstreamed</span></span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#anyOutput"><span class="hs-identifier">anyOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#allOutputs"><span class="hs-identifier">allOutputs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#anyInput"><span class="hs-identifier">anyInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#findTxOutByTxOutRef"><span class="hs-identifier">findTxOutByTxOutRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#scriptHashFromAddress"><span class="hs-identifier">scriptHashFromAddress</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#findOutputsToAddress"><span class="hs-identifier">findOutputsToAddress</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="Agora.Utils.html#findTxOutDatum"><span class="hs-identifier">findTxOutDatum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/56s38y8krq5sxnvf6xk7nj5vchvg5gay-plutus-ledger-api-lib-plutus-ledger-api-0.1.0.0-haddock-doc/share/doc/plutus-ledger-api/html/src"><span class="hs-identifier">Plutus.V1.Ledger.Value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/56s38y8krq5sxnvf6xk7nj5vchvg5gay-plutus-ledger-api-lib-plutus-ledger-api-0.1.0.0-haddock-doc/share/doc/plutus-ledger-api/html/src"><span class="hs-identifier">AssetClass</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">Plutarch.Api.V1</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PAddress</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PScriptCredential</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PCurrencySymbol</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PDatum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PDatumHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PMaybeData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PDJust</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PPubKeyHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PTokenName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PTuple</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PTxInInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PTxInInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PTxInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PTxInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PTxOut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PTxOut</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PTxOutRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PValidatorHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PValue</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">Plutarch.Api.V1.AssocMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PMap</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">Plutarch.Api.V1.Value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">PValue</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">Plutarch.Builtin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">ppairDataBuiltin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">Plutarch.Internal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">punsafeCoerce</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier">Plutarch.Monadic</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- Validator-level utility functions</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- | Assert a particular 'PBool', trace if false. Use in monadic context.</span><span>
</span><span id="line-75"></span><span id="local-6989586621679309899"><span id="local-6989586621679309903"><span class="annot"><a href="Agora.Utils.html#passert"><span class="hs-identifier hs-type">passert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309903"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309903"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309903"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309899"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309903"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309899"><span class="hs-identifier hs-type">k</span></a></span></span></span><span>
</span><span id="line-76"></span><span id="passert"><span class="annot"><span class="annottext">passert :: forall (s :: S) (k :: PType).
Term s (PString @S) -&gt; Term s PBool -&gt; Term s k -&gt; Term s k
</span><a href="Agora.Utils.html#passert"><span class="hs-identifier hs-var hs-var">passert</span></a></span></span><span> </span><span id="local-6989586621679309503"><span class="annot"><span class="annottext">Term s (PString @S)
</span><a href="#local-6989586621679309503"><span class="hs-identifier hs-var">errorMessage</span></a></span></span><span> </span><span id="local-6989586621679309502"><span class="annot"><span class="annottext">Term s PBool
</span><a href="#local-6989586621679309502"><span class="hs-identifier hs-var">check</span></a></span></span><span> </span><span id="local-6989586621679309501"><span class="annot"><span class="annottext">Term s k
</span><a href="#local-6989586621679309501"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term s PBool -&gt; Term s k -&gt; Term s k -&gt; Term s k
forall (s :: S) (a :: PType).
Term s PBool -&gt; Term s a -&gt; Term s a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pif</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PBool
</span><a href="#local-6989586621679309502"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Term s k
</span><a href="#local-6989586621679309501"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PString @S) -&gt; Term s k
forall (s :: S) (a :: PType). Term s (PString @S) -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">ptraceError</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PString @S)
</span><a href="#local-6989586621679309503"><span class="hs-identifier hs-var">errorMessage</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- | Find a datum with the given hash.</span><span>
</span><span id="line-79"></span><span id="local-6989586621679309892"><span class="annot"><a href="Agora.Utils.html#pfindDatum"><span class="hs-identifier hs-type">pfindDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309892"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDatumHash</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxInfo</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMaybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDatum</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-80"></span><span id="pfindDatum"><span class="annot"><span class="annottext">pfindDatum :: forall (s :: S).
Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe PDatum))
</span><a href="Agora.Utils.html#pfindDatum"><span class="hs-identifier hs-var hs-var">pfindDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (s :: S).
 Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe PDatum)))
-&gt; Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe PDatum))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (s :: S).
  Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe PDatum)))
 -&gt; Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe PDatum)))
-&gt; (forall (s :: S).
    Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe PDatum)))
-&gt; Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe PDatum))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><span class="annottext">(Term s PDatumHash -&gt; Term s PTxInfo -&gt; Term s (PMaybe PDatum))
-&gt; Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe PDatum))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PDatumHash -&gt; Term s PTxInfo -&gt; Term s (PMaybe PDatum))
 -&gt; Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe PDatum)))
-&gt; (Term s PDatumHash -&gt; Term s PTxInfo -&gt; Term s (PMaybe PDatum))
-&gt; Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe PDatum))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679309456"><span class="annot"><span class="annottext">Term s PDatumHash
</span><a href="#local-6989586621679309456"><span class="hs-identifier hs-var">datumHash</span></a></span></span><span> </span><span id="local-6989586621679309455"><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679309455"><span class="hs-identifier hs-var">txInfo''</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxInfo</span></a></span><span> </span><span id="local-6989586621679309454"><span class="annot"><span class="annottext">Term
  s
  (PDataRecord
     ((':)
        @PLabeledType
        (&quot;inputs&quot; ':= PBuiltinList (PAsData PTxInInfo))
        ((':)
           @PLabeledType
           (&quot;outputs&quot; ':= PBuiltinList (PAsData PTxOut))
           ((':)
              @PLabeledType
              (&quot;fee&quot; ':= PValue)
              ((':)
                 @PLabeledType
                 (&quot;mint&quot; ':= PValue)
                 ((':)
                    @PLabeledType
                    (&quot;dcert&quot; ':= PBuiltinList (PAsData PDCert))
                    ((':)
                       @PLabeledType
                       (&quot;wdrl&quot;
                        ':= PBuiltinList
                              (PAsData (PTuple PStakingCredential (PInteger @S))))
                       ((':)
                          @PLabeledType
                          (&quot;validRange&quot; ':= PPOSIXTimeRange)
                          ((':)
                             @PLabeledType
                             (&quot;signatories&quot; ':= PBuiltinList (PAsData PPubKeyHash))
                             ((':)
                                @PLabeledType
                                (&quot;data&quot; ':= PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
                                ((':) @PLabeledType (&quot;id&quot; ':= PTxId) ('[] @PLabeledType))))))))))))
</span><a href="#local-6989586621679309454"><span class="hs-identifier hs-var">txInfo'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s PTxInfo
-&gt; (PTxInfo s -&gt; Term s (PMaybe PDatum)) -&gt; Term s (PMaybe PDatum)
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679309455"><span class="hs-identifier hs-var">txInfo''</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><span class="annottext">Term
  s
  (PDatumHash
   :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
         :--&gt; PMaybe PDatum))
forall (a :: PType) (list :: PType -&gt; PType) (b :: PType) (s :: S).
(PEq a, PIsListLike list (PAsData (PTuple a b)), PIsData a,
 PIsData b) =&gt;
Term s (a :--&gt; (list (PAsData (PTuple a b)) :--&gt; PMaybe b))
</span><a href="Agora.Utils.html#plookupTuple"><span class="hs-identifier hs-var">plookupTuple</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PDatumHash
   :--&gt; (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
         :--&gt; PMaybe PDatum))
-&gt; Term s PDatumHash
-&gt; Term
     s
     (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
      :--&gt; PMaybe PDatum)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PDatumHash
</span><a href="#local-6989586621679309456"><span class="hs-identifier hs-var">datumHash</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList (PAsData (PTuple PDatumHash PDatum))
   :--&gt; PMaybe PDatum)
-&gt; Term s (PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
-&gt; Term s (PMaybe PDatum)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (name :: Symbol) (p :: PType) (s :: S) (a :: PType)
       (as :: [PLabeledType]) (n :: Nat) (b :: PType).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfield</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;data&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PDataRecord
     ((':)
        @PLabeledType
        (&quot;inputs&quot; ':= PBuiltinList (PAsData PTxInInfo))
        ((':)
           @PLabeledType
           (&quot;outputs&quot; ':= PBuiltinList (PAsData PTxOut))
           ((':)
              @PLabeledType
              (&quot;fee&quot; ':= PValue)
              ((':)
                 @PLabeledType
                 (&quot;mint&quot; ':= PValue)
                 ((':)
                    @PLabeledType
                    (&quot;dcert&quot; ':= PBuiltinList (PAsData PDCert))
                    ((':)
                       @PLabeledType
                       (&quot;wdrl&quot;
                        ':= PBuiltinList
                              (PAsData (PTuple PStakingCredential (PInteger @S))))
                       ((':)
                          @PLabeledType
                          (&quot;validRange&quot; ':= PPOSIXTimeRange)
                          ((':)
                             @PLabeledType
                             (&quot;signatories&quot; ':= PBuiltinList (PAsData PPubKeyHash))
                             ((':)
                                @PLabeledType
                                (&quot;data&quot; ':= PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
                                ((':) @PLabeledType (&quot;id&quot; ':= PTxId) ('[] @PLabeledType)))))))))))
   :--&gt; PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
-&gt; Term
     s
     (PDataRecord
        ((':)
           @PLabeledType
           (&quot;inputs&quot; ':= PBuiltinList (PAsData PTxInInfo))
           ((':)
              @PLabeledType
              (&quot;outputs&quot; ':= PBuiltinList (PAsData PTxOut))
              ((':)
                 @PLabeledType
                 (&quot;fee&quot; ':= PValue)
                 ((':)
                    @PLabeledType
                    (&quot;mint&quot; ':= PValue)
                    ((':)
                       @PLabeledType
                       (&quot;dcert&quot; ':= PBuiltinList (PAsData PDCert))
                       ((':)
                          @PLabeledType
                          (&quot;wdrl&quot;
                           ':= PBuiltinList
                                 (PAsData (PTuple PStakingCredential (PInteger @S))))
                          ((':)
                             @PLabeledType
                             (&quot;validRange&quot; ':= PPOSIXTimeRange)
                             ((':)
                                @PLabeledType
                                (&quot;signatories&quot; ':= PBuiltinList (PAsData PPubKeyHash))
                                ((':)
                                   @PLabeledType
                                   (&quot;data&quot; ':= PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
                                   ((':)
                                      @PLabeledType (&quot;id&quot; ':= PTxId) ('[] @PLabeledType))))))))))))
-&gt; Term s (PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PDataRecord
     ((':)
        @PLabeledType
        (&quot;inputs&quot; ':= PBuiltinList (PAsData PTxInInfo))
        ((':)
           @PLabeledType
           (&quot;outputs&quot; ':= PBuiltinList (PAsData PTxOut))
           ((':)
              @PLabeledType
              (&quot;fee&quot; ':= PValue)
              ((':)
                 @PLabeledType
                 (&quot;mint&quot; ':= PValue)
                 ((':)
                    @PLabeledType
                    (&quot;dcert&quot; ':= PBuiltinList (PAsData PDCert))
                    ((':)
                       @PLabeledType
                       (&quot;wdrl&quot;
                        ':= PBuiltinList
                              (PAsData (PTuple PStakingCredential (PInteger @S))))
                       ((':)
                          @PLabeledType
                          (&quot;validRange&quot; ':= PPOSIXTimeRange)
                          ((':)
                             @PLabeledType
                             (&quot;signatories&quot; ':= PBuiltinList (PAsData PPubKeyHash))
                             ((':)
                                @PLabeledType
                                (&quot;data&quot; ':= PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
                                ((':) @PLabeledType (&quot;id&quot; ':= PTxId) ('[] @PLabeledType))))))))))))
</span><a href="#local-6989586621679309454"><span class="hs-identifier hs-var">txInfo'</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">{- | Find a datum with the given hash.
NOTE: this is unsafe in the sense that, if the data layout is wrong, this is UB.
-}</span><span>
</span><span id="line-88"></span><span id="local-6989586621679309807"><span id="local-6989586621679309808"><span class="annot"><a href="Agora.Utils.html#pfindDatum%27"><span class="hs-identifier hs-type">pfindDatum'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PIsData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309808"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309807"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDatumHash</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxInfo</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309808"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-89"></span><span id="pfindDatum%27"><span class="annot"><span class="annottext">pfindDatum' :: forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe (PAsData a)))
</span><a href="Agora.Utils.html#pfindDatum%27"><span class="hs-identifier hs-var hs-var">pfindDatum'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClosedTerm (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe (PAsData a)))
-&gt; Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe (PAsData a)))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">(ClosedTerm (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe (PAsData a)))
 -&gt; Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe (PAsData a))))
-&gt; ClosedTerm (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe (PAsData a)))
-&gt; Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe (PAsData a)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s PDatumHash
 -&gt; Term s PTxInfo -&gt; Term s (PMaybe (PAsData a)))
-&gt; Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe (PAsData a)))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PDatumHash
  -&gt; Term s PTxInfo -&gt; Term s (PMaybe (PAsData a)))
 -&gt; Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe (PAsData a))))
-&gt; (Term s PDatumHash
    -&gt; Term s PTxInfo -&gt; Term s (PMaybe (PAsData a)))
-&gt; Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe (PAsData a)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679309441"><span class="annot"><span class="annottext">Term s PDatumHash
</span><a href="#local-6989586621679309441"><span class="hs-identifier hs-var">dh</span></a></span></span><span> </span><span id="local-6989586621679309440"><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679309440"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term s (PMaybe PDatum) -&gt; Term s (PMaybe (PAsData a))
forall (s :: S) (a :: PType) (b :: PType). Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">punsafeCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PMaybe PDatum) -&gt; Term s (PMaybe (PAsData a)))
-&gt; Term s (PMaybe PDatum) -&gt; Term s (PMaybe (PAsData a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe PDatum))
forall (s :: S).
Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe PDatum))
</span><a href="Agora.Utils.html#pfindDatum"><span class="hs-identifier hs-var">pfindDatum</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe PDatum))
-&gt; Term s PDatumHash -&gt; Term s (PTxInfo :--&gt; PMaybe PDatum)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PDatumHash
</span><a href="#local-6989586621679309441"><span class="hs-identifier hs-var">dh</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PTxInfo :--&gt; PMaybe PDatum)
-&gt; Term s PTxInfo -&gt; Term s (PMaybe PDatum)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679309440"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Check if a PubKeyHash signs this transaction.</span><span>
</span><span id="line-92"></span><span id="local-6989586621679309800"><span class="annot"><a href="Agora.Utils.html#ptxSignedBy"><span class="hs-identifier hs-type">ptxSignedBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309800"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxInfo</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PPubKeyHash</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBool</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-93"></span><span id="ptxSignedBy"><span class="annot"><span class="annottext">ptxSignedBy :: forall (s :: S).
Term s (PTxInfo :--&gt; (PAsData PPubKeyHash :--&gt; PBool))
</span><a href="Agora.Utils.html#ptxSignedBy"><span class="hs-identifier hs-var hs-var">ptxSignedBy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (s :: S).
 Term s (PTxInfo :--&gt; (PAsData PPubKeyHash :--&gt; PBool)))
-&gt; Term s (PTxInfo :--&gt; (PAsData PPubKeyHash :--&gt; PBool))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (s :: S).
  Term s (PTxInfo :--&gt; (PAsData PPubKeyHash :--&gt; PBool)))
 -&gt; Term s (PTxInfo :--&gt; (PAsData PPubKeyHash :--&gt; PBool)))
-&gt; (forall (s :: S).
    Term s (PTxInfo :--&gt; (PAsData PPubKeyHash :--&gt; PBool)))
-&gt; Term s (PTxInfo :--&gt; (PAsData PPubKeyHash :--&gt; PBool))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><span class="annottext">(Term s PTxInfo -&gt; Term s (PAsData PPubKeyHash) -&gt; Term s PBool)
-&gt; Term s (PTxInfo :--&gt; (PAsData PPubKeyHash :--&gt; PBool))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PTxInfo -&gt; Term s (PAsData PPubKeyHash) -&gt; Term s PBool)
 -&gt; Term s (PTxInfo :--&gt; (PAsData PPubKeyHash :--&gt; PBool)))
-&gt; (Term s PTxInfo -&gt; Term s (PAsData PPubKeyHash) -&gt; Term s PBool)
-&gt; Term s (PTxInfo :--&gt; (PAsData PPubKeyHash :--&gt; PBool))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679309405"><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679309405"><span class="hs-identifier hs-var">txInfo'</span></a></span></span><span> </span><span id="local-6989586621679309404"><span class="annot"><span class="annottext">Term s (PAsData PPubKeyHash)
</span><a href="#local-6989586621679309404"><span class="hs-identifier hs-var">pkh</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-95"></span><span>    </span><span id="local-6989586621679309403"><span class="annot"><span class="annottext">HRec
  ((':)
     @Type
     (Labeled
        @Symbol
        &quot;signatories&quot;
        (Term s (PAsData (PBuiltinList (PAsData PPubKeyHash)))))
     ('[] @Type))
</span><a href="#local-6989586621679309403"><span class="hs-identifier hs-var">txInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fs :: [Symbol]) (a :: PType) (s :: S) (b :: PType)
       (ps :: [PLabeledType]) (bs :: [ToBind]).
(PDataFields a,
 (ps :: [PLabeledType]) ~ (PFields a :: [PLabeledType]),
 (bs :: [ToBind]) ~ (Bindings ps fs :: [ToBind]),
 BindFields ps bs) =&gt;
Term s a -&gt; (HRec (BoundTerms ps bs s) -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pletFields</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;signatories&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679309405"><span class="hs-identifier hs-var">txInfo'</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="annottext">forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
(PIsListLike list a, PEq a) =&gt;
Term s (a :--&gt; (list a :--&gt; PBool))
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pelem</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBuiltinList</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PAsData PPubKeyHash
   :--&gt; (PBuiltinList (PAsData PPubKeyHash) :--&gt; PBool))
-&gt; Term s (PAsData PPubKeyHash)
-&gt; Term s (PBuiltinList (PAsData PPubKeyHash) :--&gt; PBool)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData PPubKeyHash)
</span><a href="#local-6989586621679309404"><span class="hs-identifier hs-var">pkh</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData PPubKeyHash) :--&gt; PBool)
-&gt; Term s (PBuiltinList (PAsData PPubKeyHash)) -&gt; Term s PBool
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">HRec
  ((':)
     @Type
     (Labeled
        @Symbol
        &quot;signatories&quot;
        (Term s (PAsData (PBuiltinList (PAsData PPubKeyHash)))))
     ('[] @Type))
</span><a href="#local-6989586621679309403"><span class="hs-identifier hs-var">txInfo</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">signatories</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | Get the first element that matches a predicate or return Nothing.</span><span>
</span><span id="line-99"></span><span id="local-6989586621679309754"><span id="local-6989586621679309755"><span id="local-6989586621679309756"><span class="annot"><a href="Agora.Utils.html#pfind%27"><span class="hs-identifier hs-type">pfind'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PIsListLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309756"><span class="hs-identifier hs-type">list</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309755"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309754"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309755"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309754"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309754"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679309756"><span class="hs-identifier hs-type">list</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309755"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMaybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309755"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-103"></span><span id="pfind%27"><span class="annot"><span class="annottext">pfind' :: forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike list a =&gt;
(Term s a -&gt; Term s PBool) -&gt; Term s (list a :--&gt; PMaybe a)
</span><a href="Agora.Utils.html#pfind%27"><span class="hs-identifier hs-var hs-var">pfind'</span></a></span></span><span> </span><span id="local-6989586621679309393"><span class="annot"><span class="annottext">Term s a -&gt; Term s PBool
</span><a href="#local-6989586621679309393"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="annottext">(Term s (list a :--&gt; PMaybe a)
 -&gt; Term s a -&gt; Term s (list a) -&gt; Term s (PMaybe a))
-&gt; (Term s (list a :--&gt; PMaybe a) -&gt; Term s (PMaybe a))
-&gt; Term s (list a :--&gt; PMaybe a)
forall (list :: PType -&gt; PType) (a :: PType) (s :: S) (r :: PType).
PIsListLike list a =&gt;
(Term s (list a :--&gt; r) -&gt; Term s a -&gt; Term s (list a) -&gt; Term s r)
-&gt; (Term s (list a :--&gt; r) -&gt; Term s r) -&gt; Term s (list a :--&gt; r)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">precList</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679309391"><span class="annot"><span class="annottext">Term s (list a :--&gt; PMaybe a)
</span><a href="#local-6989586621679309391"><span class="hs-identifier hs-var">self</span></a></span></span><span> </span><span id="local-6989586621679309390"><span class="annot"><span class="annottext">Term s a
</span><a href="#local-6989586621679309390"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679309389"><span class="annot"><span class="annottext">Term s (list a)
</span><a href="#local-6989586621679309389"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term s PBool
-&gt; Term s (PMaybe a) -&gt; Term s (PMaybe a) -&gt; Term s (PMaybe a)
forall (s :: S) (a :: PType).
Term s PBool -&gt; Term s a -&gt; Term s a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pif</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s a -&gt; Term s PBool
</span><a href="#local-6989586621679309393"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Term s a
</span><a href="#local-6989586621679309390"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PMaybe a s -&gt; Term s (PMaybe a)
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s a -&gt; PMaybe a s
forall (a :: PType) (s :: S). Term s a -&gt; PMaybe a s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PJust</span></a></span><span> </span><span class="annot"><span class="annottext">Term s a
</span><a href="#local-6989586621679309390"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (list a :--&gt; PMaybe a)
</span><a href="#local-6989586621679309391"><span class="hs-identifier hs-var">self</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (list a :--&gt; PMaybe a)
-&gt; Term s (list a) -&gt; Term s (PMaybe a)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (list a)
</span><a href="#local-6989586621679309389"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PMaybe a)
-&gt; Term s (list a :--&gt; PMaybe a) -&gt; Term s (PMaybe a)
forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PMaybe a)
 -&gt; Term s (list a :--&gt; PMaybe a) -&gt; Term s (PMaybe a))
-&gt; Term s (PMaybe a)
-&gt; Term s (list a :--&gt; PMaybe a)
-&gt; Term s (PMaybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PMaybe a s -&gt; Term s (PMaybe a)
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">PMaybe a s
forall (a :: PType) (s :: S). PMaybe a s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PNothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | Get the first element that maps to a PJust in a list.</span><span>
</span><span id="line-109"></span><span id="local-6989586621679309734"><span id="local-6989586621679309735"><span id="local-6989586621679309736"><span id="local-6989586621679309737"><span class="annot"><a href="Agora.Utils.html#pfindMap"><span class="hs-identifier hs-type">pfindMap</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PIsListLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309737"><span class="hs-identifier hs-type">list</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309735"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679309736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMaybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309734"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309737"><span class="hs-identifier hs-type">list</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMaybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309734"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-112"></span><span id="pfindMap"><span class="annot"><span class="annottext">pfindMap :: forall (list :: PType -&gt; PType) (a :: PType) (s :: S) (b :: PType).
PIsListLike list a =&gt;
Term s ((a :--&gt; PMaybe b) :--&gt; (list a :--&gt; PMaybe b))
</span><a href="Agora.Utils.html#pfindMap"><span class="hs-identifier hs-var hs-var">pfindMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><span class="annottext">ClosedTerm ((a :--&gt; PMaybe b) :--&gt; (list a :--&gt; PMaybe b))
-&gt; Term s ((a :--&gt; PMaybe b) :--&gt; (list a :--&gt; PMaybe b))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">(ClosedTerm ((a :--&gt; PMaybe b) :--&gt; (list a :--&gt; PMaybe b))
 -&gt; Term s ((a :--&gt; PMaybe b) :--&gt; (list a :--&gt; PMaybe b)))
-&gt; ClosedTerm ((a :--&gt; PMaybe b) :--&gt; (list a :--&gt; PMaybe b))
-&gt; Term s ((a :--&gt; PMaybe b) :--&gt; (list a :--&gt; PMaybe b))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="annottext">(Term s (a :--&gt; PMaybe b) -&gt; Term s (list a :--&gt; PMaybe b))
-&gt; Term s ((a :--&gt; PMaybe b) :--&gt; (list a :--&gt; PMaybe b))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s (a :--&gt; PMaybe b) -&gt; Term s (list a :--&gt; PMaybe b))
 -&gt; Term s ((a :--&gt; PMaybe b) :--&gt; (list a :--&gt; PMaybe b)))
-&gt; (Term s (a :--&gt; PMaybe b) -&gt; Term s (list a :--&gt; PMaybe b))
-&gt; Term s ((a :--&gt; PMaybe b) :--&gt; (list a :--&gt; PMaybe b))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679309374"><span class="annot"><span class="annottext">Term s (a :--&gt; PMaybe b)
</span><a href="#local-6989586621679309374"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-115"></span><span>      </span><span class="annot"><span class="annottext">(Term s (list a :--&gt; PMaybe b)
 -&gt; Term s a -&gt; Term s (list a) -&gt; Term s (PMaybe b))
-&gt; (Term s (list a :--&gt; PMaybe b) -&gt; Term s (PMaybe b))
-&gt; Term s (list a :--&gt; PMaybe b)
forall (list :: PType -&gt; PType) (a :: PType) (s :: S) (r :: PType).
PIsListLike list a =&gt;
(Term s (list a :--&gt; r) -&gt; Term s a -&gt; Term s (list a) -&gt; Term s r)
-&gt; (Term s (list a :--&gt; r) -&gt; Term s r) -&gt; Term s (list a :--&gt; r)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">precList</span></a></span><span>
</span><span id="line-116"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679309373"><span class="annot"><span class="annottext">Term s (list a :--&gt; PMaybe b)
</span><a href="#local-6989586621679309373"><span class="hs-identifier hs-var">self</span></a></span></span><span> </span><span id="local-6989586621679309372"><span class="annot"><span class="annottext">Term s a
</span><a href="#local-6989586621679309372"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679309371"><span class="annot"><span class="annottext">Term s (list a)
</span><a href="#local-6989586621679309371"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-117"></span><span>            </span><span class="hs-comment">-- In the future, this should use `pmatchSum`, I believe?</span><span>
</span><span id="line-118"></span><span>            </span><span class="annot"><span class="annottext">Term s (PMaybe b)
-&gt; (PMaybe b s -&gt; Term s (PMaybe b)) -&gt; Term s (PMaybe b)
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (a :--&gt; PMaybe b)
</span><a href="#local-6989586621679309374"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (a :--&gt; PMaybe b) -&gt; Term s a -&gt; Term s (PMaybe b)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s a
</span><a href="#local-6989586621679309372"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((PMaybe b s -&gt; Term s (PMaybe b)) -&gt; Term s (PMaybe b))
-&gt; (PMaybe b s -&gt; Term s (PMaybe b)) -&gt; Term s (PMaybe b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-119"></span><span>              </span><span class="annot"><span class="annottext">PMaybe b s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PNothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term s (list a :--&gt; PMaybe b)
</span><a href="#local-6989586621679309373"><span class="hs-identifier hs-var">self</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (list a :--&gt; PMaybe b)
-&gt; Term s (list a) -&gt; Term s (PMaybe b)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (list a)
</span><a href="#local-6989586621679309371"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-120"></span><span>              </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PJust</span></a></span><span> </span><span id="local-6989586621679309370"><span class="annot"><span class="annottext">Term s b
</span><a href="#local-6989586621679309370"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PMaybe b s -&gt; Term s (PMaybe b)
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s b -&gt; PMaybe b s
forall (a :: PType) (s :: S). Term s a -&gt; PMaybe a s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PJust</span></a></span><span> </span><span class="annot"><span class="annottext">Term s b
</span><a href="#local-6989586621679309370"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PMaybe b)
-&gt; Term s (list a :--&gt; PMaybe b) -&gt; Term s (PMaybe b)
forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PMaybe b)
 -&gt; Term s (list a :--&gt; PMaybe b) -&gt; Term s (PMaybe b))
-&gt; Term s (PMaybe b)
-&gt; Term s (list a :--&gt; PMaybe b)
-&gt; Term s (PMaybe b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PMaybe b s -&gt; Term s (PMaybe b)
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">PMaybe b s
forall (a :: PType) (s :: S). PMaybe a s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PNothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-comment">-- | Find the value for a given key in an associative list.</span><span>
</span><span id="line-125"></span><span id="local-6989586621679309724"><span id="local-6989586621679309726"><span id="local-6989586621679309727"><span id="local-6989586621679309728"><span class="annot"><a href="Agora.Utils.html#plookup"><span class="hs-identifier hs-type">plookup</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PEq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309728"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PIsListLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309727"><span class="hs-identifier hs-type">list</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBuiltinPair</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309728"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309726"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309724"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679309728"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309727"><span class="hs-identifier hs-type">list</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBuiltinPair</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309728"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309726"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMaybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309726"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-128"></span><span id="plookup"><span class="annot"><span class="annottext">plookup :: forall (a :: PType) (list :: PType -&gt; PType) (b :: PType) (s :: S).
(PEq a, PIsListLike list (PBuiltinPair a b)) =&gt;
Term s (a :--&gt; (list (PBuiltinPair a b) :--&gt; PMaybe b))
</span><a href="Agora.Utils.html#plookup"><span class="hs-identifier hs-var hs-var">plookup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-129"></span><span>  </span><span class="annot"><span class="annottext">ClosedTerm (a :--&gt; (list (PBuiltinPair a b) :--&gt; PMaybe b))
-&gt; Term s (a :--&gt; (list (PBuiltinPair a b) :--&gt; PMaybe b))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">(ClosedTerm (a :--&gt; (list (PBuiltinPair a b) :--&gt; PMaybe b))
 -&gt; Term s (a :--&gt; (list (PBuiltinPair a b) :--&gt; PMaybe b)))
-&gt; ClosedTerm (a :--&gt; (list (PBuiltinPair a b) :--&gt; PMaybe b))
-&gt; Term s (a :--&gt; (list (PBuiltinPair a b) :--&gt; PMaybe b))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><span class="annottext">(Term s a -&gt; Term s (list (PBuiltinPair a b)) -&gt; Term s (PMaybe b))
-&gt; Term s (a :--&gt; (list (PBuiltinPair a b) :--&gt; PMaybe b))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s a
  -&gt; Term s (list (PBuiltinPair a b)) -&gt; Term s (PMaybe b))
 -&gt; Term s (a :--&gt; (list (PBuiltinPair a b) :--&gt; PMaybe b)))
-&gt; (Term s a
    -&gt; Term s (list (PBuiltinPair a b)) -&gt; Term s (PMaybe b))
-&gt; Term s (a :--&gt; (list (PBuiltinPair a b) :--&gt; PMaybe b))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679309354"><span class="annot"><span class="annottext">Term s a
</span><a href="#local-6989586621679309354"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679309353"><span class="annot"><span class="annottext">Term s (list (PBuiltinPair a b))
</span><a href="#local-6989586621679309353"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-131"></span><span>      </span><span class="annot"><span class="annottext">Term s (PMaybe (PBuiltinPair a b))
-&gt; (PMaybe (PBuiltinPair a b) s -&gt; Term s (PMaybe b))
-&gt; Term s (PMaybe b)
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Term s (PBuiltinPair a b) -&gt; Term s PBool)
-&gt; Term s (list (PBuiltinPair a b) :--&gt; PMaybe (PBuiltinPair a b))
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike list a =&gt;
(Term s a -&gt; Term s PBool) -&gt; Term s (list a :--&gt; PMaybe a)
</span><a href="Agora.Utils.html#pfind%27"><span class="hs-identifier hs-var">pfind'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679309352"><span class="annot"><span class="annottext">Term s (PBuiltinPair a b)
</span><a href="#local-6989586621679309352"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinPair a b :--&gt; a)
forall (s :: S) (a :: PType) (b :: PType).
Term s (PBuiltinPair a b :--&gt; a)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfstBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinPair a b :--&gt; a)
-&gt; Term s (PBuiltinPair a b) -&gt; Term s a
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinPair a b)
</span><a href="#local-6989586621679309352"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Term s a -&gt; Term s a -&gt; Term s PBool
forall (t :: PType) (s :: S).
PEq t =&gt;
Term s t -&gt; Term s t -&gt; Term s PBool
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#==</span></a></span><span> </span><span class="annot"><span class="annottext">Term s a
</span><a href="#local-6989586621679309354"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term s (list (PBuiltinPair a b) :--&gt; PMaybe (PBuiltinPair a b))
-&gt; Term s (list (PBuiltinPair a b))
-&gt; Term s (PMaybe (PBuiltinPair a b))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (list (PBuiltinPair a b))
</span><a href="#local-6989586621679309353"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((PMaybe (PBuiltinPair a b) s -&gt; Term s (PMaybe b))
 -&gt; Term s (PMaybe b))
-&gt; (PMaybe (PBuiltinPair a b) s -&gt; Term s (PMaybe b))
-&gt; Term s (PMaybe b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><span class="annottext">PMaybe (PBuiltinPair a b) s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PNothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PMaybe b s -&gt; Term s (PMaybe b)
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">PMaybe b s
forall (a :: PType) (s :: S). PMaybe a s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PNothing</span></a></span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PJust</span></a></span><span> </span><span id="local-6989586621679309349"><span class="annot"><span class="annottext">Term s (PBuiltinPair a b)
</span><a href="#local-6989586621679309349"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PMaybe b s -&gt; Term s (PMaybe b)
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s b -&gt; PMaybe b s
forall (a :: PType) (s :: S). Term s a -&gt; PMaybe a s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PBuiltinPair a b :--&gt; b)
forall (s :: S) (a :: PType) (b :: PType).
Term s (PBuiltinPair a b :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">psndBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinPair a b :--&gt; b)
-&gt; Term s (PBuiltinPair a b) -&gt; Term s b
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinPair a b)
</span><a href="#local-6989586621679309349"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- | Find the value for a given key in an assoclist which uses 'PTuple's.</span><span>
</span><span id="line-136"></span><span id="local-6989586621679309819"><span id="local-6989586621679309820"><span id="local-6989586621679309821"><span id="local-6989586621679309822"><span class="annot"><a href="Agora.Utils.html#plookupTuple"><span class="hs-identifier hs-type">plookupTuple</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PEq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309822"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PIsListLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309821"><span class="hs-identifier hs-type">list</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTuple</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309822"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309820"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PIsData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309822"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PIsData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309820"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-138"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309819"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679309822"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309821"><span class="hs-identifier hs-type">list</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTuple</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309822"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309820"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMaybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309820"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-139"></span><span id="plookupTuple"><span class="annot"><span class="annottext">plookupTuple :: forall (a :: PType) (list :: PType -&gt; PType) (b :: PType) (s :: S).
(PEq a, PIsListLike list (PAsData (PTuple a b)), PIsData a,
 PIsData b) =&gt;
Term s (a :--&gt; (list (PAsData (PTuple a b)) :--&gt; PMaybe b))
</span><a href="Agora.Utils.html#plookupTuple"><span class="hs-identifier hs-var hs-var">plookupTuple</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><span class="annottext">ClosedTerm (a :--&gt; (list (PAsData (PTuple a b)) :--&gt; PMaybe b))
-&gt; Term s (a :--&gt; (list (PAsData (PTuple a b)) :--&gt; PMaybe b))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">(ClosedTerm (a :--&gt; (list (PAsData (PTuple a b)) :--&gt; PMaybe b))
 -&gt; Term s (a :--&gt; (list (PAsData (PTuple a b)) :--&gt; PMaybe b)))
-&gt; ClosedTerm (a :--&gt; (list (PAsData (PTuple a b)) :--&gt; PMaybe b))
-&gt; Term s (a :--&gt; (list (PAsData (PTuple a b)) :--&gt; PMaybe b))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><span class="annottext">(Term s a
 -&gt; Term s (list (PAsData (PTuple a b))) -&gt; Term s (PMaybe b))
-&gt; Term s (a :--&gt; (list (PAsData (PTuple a b)) :--&gt; PMaybe b))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s a
  -&gt; Term s (list (PAsData (PTuple a b))) -&gt; Term s (PMaybe b))
 -&gt; Term s (a :--&gt; (list (PAsData (PTuple a b)) :--&gt; PMaybe b)))
-&gt; (Term s a
    -&gt; Term s (list (PAsData (PTuple a b))) -&gt; Term s (PMaybe b))
-&gt; Term s (a :--&gt; (list (PAsData (PTuple a b)) :--&gt; PMaybe b))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679309309"><span class="annot"><span class="annottext">Term s a
</span><a href="#local-6989586621679309309"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679309308"><span class="annot"><span class="annottext">Term s (list (PAsData (PTuple a b)))
</span><a href="#local-6989586621679309308"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-142"></span><span>      </span><span class="annot"><span class="annottext">Term s (PMaybe (PAsData (PTuple a b)))
-&gt; (PMaybe (PAsData (PTuple a b)) s -&gt; Term s (PMaybe b))
-&gt; Term s (PMaybe b)
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Term s (PAsData (PTuple a b)) -&gt; Term s PBool)
-&gt; Term
     s (list (PAsData (PTuple a b)) :--&gt; PMaybe (PAsData (PTuple a b)))
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike list a =&gt;
(Term s a -&gt; Term s PBool) -&gt; Term s (list a :--&gt; PMaybe a)
</span><a href="Agora.Utils.html#pfind%27"><span class="hs-identifier hs-var">pfind'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679309307"><span class="annot"><span class="annottext">Term s (PAsData (PTuple a b))
</span><a href="#local-6989586621679309307"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (name :: Symbol) (p :: PType) (s :: S) (a :: PType)
       (as :: [PLabeledType]) (n :: Nat) (b :: PType).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfield</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;_0&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term s (PTuple a b :--&gt; a) -&gt; Term s (PTuple a b) -&gt; Term s a
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData (PTuple a b)) -&gt; Term s (PTuple a b)
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfromData</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData (PTuple a b))
</span><a href="#local-6989586621679309307"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term s a -&gt; Term s a -&gt; Term s PBool
forall (t :: PType) (s :: S).
PEq t =&gt;
Term s t -&gt; Term s t -&gt; Term s PBool
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#==</span></a></span><span> </span><span class="annot"><span class="annottext">Term s a
</span><a href="#local-6989586621679309309"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term
  s (list (PAsData (PTuple a b)) :--&gt; PMaybe (PAsData (PTuple a b)))
-&gt; Term s (list (PAsData (PTuple a b)))
-&gt; Term s (PMaybe (PAsData (PTuple a b)))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (list (PAsData (PTuple a b)))
</span><a href="#local-6989586621679309308"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((PMaybe (PAsData (PTuple a b)) s -&gt; Term s (PMaybe b))
 -&gt; Term s (PMaybe b))
-&gt; (PMaybe (PAsData (PTuple a b)) s -&gt; Term s (PMaybe b))
-&gt; Term s (PMaybe b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-143"></span><span>        </span><span class="annot"><span class="annottext">PMaybe (PAsData (PTuple a b)) s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PNothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PMaybe b s -&gt; Term s (PMaybe b)
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">PMaybe b s
forall (a :: PType) (s :: S). PMaybe a s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PNothing</span></a></span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PJust</span></a></span><span> </span><span id="local-6989586621679309305"><span class="annot"><span class="annottext">Term s (PAsData (PTuple a b))
</span><a href="#local-6989586621679309305"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PMaybe b s -&gt; Term s (PMaybe b)
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s b -&gt; PMaybe b s
forall (a :: PType) (s :: S). Term s a -&gt; PMaybe a s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (name :: Symbol) (p :: PType) (s :: S) (a :: PType)
       (as :: [PLabeledType]) (n :: Nat) (b :: PType).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfield</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;_1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term s (PTuple a b :--&gt; b) -&gt; Term s (PTuple a b) -&gt; Term s b
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData (PTuple a b)) -&gt; Term s (PTuple a b)
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfromData</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData (PTuple a b))
</span><a href="#local-6989586621679309305"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Extract a Maybe by providing a default value in case of Just.</span><span>
</span><span id="line-147"></span><span class="annot"><a href="Agora.Utils.html#pfromMaybe"><span class="hs-identifier hs-type">pfromMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679309701"><span class="annot"><a href="#local-6989586621679309701"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679309702"><span class="annot"><a href="#local-6989586621679309702"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309702"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679309701"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMaybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309701"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309701"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span id="pfromMaybe"><span class="annot"><span class="annottext">pfromMaybe :: forall (a :: PType) (s :: S). Term s (a :--&gt; (PMaybe a :--&gt; a))
</span><a href="Agora.Utils.html#pfromMaybe"><span class="hs-identifier hs-var hs-var">pfromMaybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClosedTerm (a :--&gt; (PMaybe a :--&gt; a))
-&gt; Term s (a :--&gt; (PMaybe a :--&gt; a))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">(ClosedTerm (a :--&gt; (PMaybe a :--&gt; a))
 -&gt; Term s (a :--&gt; (PMaybe a :--&gt; a)))
-&gt; ClosedTerm (a :--&gt; (PMaybe a :--&gt; a))
-&gt; Term s (a :--&gt; (PMaybe a :--&gt; a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span class="annot"><span class="annottext">(Term s a -&gt; Term s (PMaybe a) -&gt; Term s a)
-&gt; Term s (a :--&gt; (PMaybe a :--&gt; a))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s a -&gt; Term s (PMaybe a) -&gt; Term s a)
 -&gt; Term s (a :--&gt; (PMaybe a :--&gt; a)))
-&gt; (Term s a -&gt; Term s (PMaybe a) -&gt; Term s a)
-&gt; Term s (a :--&gt; (PMaybe a :--&gt; a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679309296"><span class="annot"><span class="annottext">Term s a
</span><a href="#local-6989586621679309296"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679309295"><span class="annot"><span class="annottext">Term s (PMaybe a)
</span><a href="#local-6989586621679309295"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><span class="annottext">Term s (PMaybe a) -&gt; (PMaybe a s -&gt; Term s a) -&gt; Term s a
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PMaybe a)
</span><a href="#local-6989586621679309295"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">((PMaybe a s -&gt; Term s a) -&gt; Term s a)
-&gt; (PMaybe a s -&gt; Term s a) -&gt; Term s a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-151"></span><span>      </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PJust</span></a></span><span> </span><span id="local-6989586621679309294"><span class="annot"><span class="annottext">Term s a
</span><a href="#local-6989586621679309294"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term s a
</span><a href="#local-6989586621679309294"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-152"></span><span>      </span><span class="annot"><span class="annottext">PMaybe a s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PNothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term s a
</span><a href="#local-6989586621679309296"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | Yield True if a given PMaybe is of form PJust _.</span><span>
</span><span id="line-155"></span><span class="annot"><a href="Agora.Utils.html#pisJust"><span class="hs-identifier hs-type">pisJust</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679309696"><span class="annot"><a href="#local-6989586621679309696"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679309697"><span class="annot"><a href="#local-6989586621679309697"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309697"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMaybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309696"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span id="pisJust"><span class="annot"><span class="annottext">pisJust :: forall (a :: PType) (s :: S). Term s (PMaybe a :--&gt; PBool)
</span><a href="Agora.Utils.html#pisJust"><span class="hs-identifier hs-var hs-var">pisJust</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClosedTerm (PMaybe a :--&gt; PBool) -&gt; Term s (PMaybe a :--&gt; PBool)
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">(ClosedTerm (PMaybe a :--&gt; PBool) -&gt; Term s (PMaybe a :--&gt; PBool))
-&gt; ClosedTerm (PMaybe a :--&gt; PBool) -&gt; Term s (PMaybe a :--&gt; PBool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="annot"><span class="annottext">(Term s (PMaybe a) -&gt; Term s PBool) -&gt; Term s (PMaybe a :--&gt; PBool)
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s (PMaybe a) -&gt; Term s PBool)
 -&gt; Term s (PMaybe a :--&gt; PBool))
-&gt; (Term s (PMaybe a) -&gt; Term s PBool)
-&gt; Term s (PMaybe a :--&gt; PBool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679309284"><span class="annot"><span class="annottext">Term s (PMaybe a)
</span><a href="#local-6989586621679309284"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621679309283"><span class="annot"><span class="annottext">PMaybe a s
</span><a href="#local-6989586621679309283"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s (PMaybe a) -&gt; (PMaybe a s -&gt; Term s PBool) -&gt; Term s PBool
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PMaybe a)
</span><a href="#local-6989586621679309284"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PMaybe a s
</span><a href="#local-6989586621679309283"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-160"></span><span>      </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PJust</span></a></span><span> </span><span class="annot"><span class="annottext">Term s a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pconstant</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-161"></span><span>      </span><span class="annot"><span class="annottext">PMaybe a s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PNothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pconstant</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- | Escape with a particular value on expecting 'Just'. For use in monadic context.</span><span>
</span><span id="line-164"></span><span class="annot"><a href="Agora.Utils.html#pexpectJust"><span class="hs-identifier hs-type">pexpectJust</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679309688"><span class="annot"><a href="#local-6989586621679309688"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679309687"><span class="annot"><a href="#local-6989586621679309687"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679309689"><span class="annot"><a href="#local-6989586621679309689"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309689"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309688"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-167"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309689"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMaybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309687"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309689"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309687"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309689"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309688"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309689"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309688"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-170"></span><span id="pexpectJust"><span class="annot"><span class="annottext">pexpectJust :: forall (r :: PType) (a :: PType) (s :: S).
Term s r -&gt; Term s (PMaybe a) -&gt; (Term s a -&gt; Term s r) -&gt; Term s r
</span><a href="Agora.Utils.html#pexpectJust"><span class="hs-identifier hs-var hs-var">pexpectJust</span></a></span></span><span> </span><span id="local-6989586621679309278"><span class="annot"><span class="annottext">Term s r
</span><a href="#local-6989586621679309278"><span class="hs-identifier hs-var">escape</span></a></span></span><span> </span><span id="local-6989586621679309277"><span class="annot"><span class="annottext">Term s (PMaybe a)
</span><a href="#local-6989586621679309277"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span id="local-6989586621679309276"><span class="annot"><span class="annottext">Term s a -&gt; Term s r
</span><a href="#local-6989586621679309276"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-171"></span><span>  </span><span class="annot"><span class="annottext">Term s (PMaybe a) -&gt; (PMaybe a s -&gt; Term s r) -&gt; Term s r
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PMaybe a)
</span><a href="#local-6989586621679309277"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">((PMaybe a s -&gt; Term s r) -&gt; Term s r)
-&gt; (PMaybe a s -&gt; Term s r) -&gt; Term s r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PJust</span></a></span><span> </span><span id="local-6989586621679309275"><span class="annot"><span class="annottext">Term s a
</span><a href="#local-6989586621679309275"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term s a -&gt; Term s r
</span><a href="#local-6989586621679309276"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Term s a
</span><a href="#local-6989586621679309275"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><span class="annottext">PMaybe a s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PNothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term s r
</span><a href="#local-6989586621679309278"><span class="hs-identifier hs-var">escape</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Get the sum of all values belonging to a particular CurrencySymbol.</span><span>
</span><span id="line-176"></span><span id="local-6989586621679309683"><span class="annot"><a href="Agora.Utils.html#psymbolValueOf"><span class="hs-identifier hs-type">psymbolValueOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309683"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PCurrencySymbol</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PInteger</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-177"></span><span id="psymbolValueOf"><span class="annot"><span class="annottext">psymbolValueOf :: forall (s :: S).
Term s (PCurrencySymbol :--&gt; (PValue :--&gt; PInteger @S))
</span><a href="Agora.Utils.html#psymbolValueOf"><span class="hs-identifier hs-var hs-var">psymbolValueOf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-178"></span><span>  </span><span class="annot"><span class="annottext">(forall (s :: S).
 Term s (PCurrencySymbol :--&gt; (PValue :--&gt; PInteger @S)))
-&gt; Term s (PCurrencySymbol :--&gt; (PValue :--&gt; PInteger @S))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (s :: S).
  Term s (PCurrencySymbol :--&gt; (PValue :--&gt; PInteger @S)))
 -&gt; Term s (PCurrencySymbol :--&gt; (PValue :--&gt; PInteger @S)))
-&gt; (forall (s :: S).
    Term s (PCurrencySymbol :--&gt; (PValue :--&gt; PInteger @S)))
-&gt; Term s (PCurrencySymbol :--&gt; (PValue :--&gt; PInteger @S))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><span class="annottext">(Term s PCurrencySymbol -&gt; Term s PValue -&gt; Term s (PInteger @S))
-&gt; Term s (PCurrencySymbol :--&gt; (PValue :--&gt; PInteger @S))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PCurrencySymbol -&gt; Term s PValue -&gt; Term s (PInteger @S))
 -&gt; Term s (PCurrencySymbol :--&gt; (PValue :--&gt; PInteger @S)))
-&gt; (Term s PCurrencySymbol
    -&gt; Term s PValue -&gt; Term s (PInteger @S))
-&gt; Term s (PCurrencySymbol :--&gt; (PValue :--&gt; PInteger @S))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679309233"><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679309233"><span class="hs-identifier hs-var">sym</span></a></span></span><span> </span><span id="local-6989586621679309232"><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309232"><span class="hs-identifier hs-var">value''</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-180"></span><span>      </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span> </span><span id="local-6989586621679309231"><span class="annot"><span class="annottext">Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
</span><a href="#local-6989586621679309231"><span class="hs-identifier hs-var">value'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s PValue
-&gt; (PValue s -&gt; Term s (PInteger @S)) -&gt; Term s (PInteger @S)
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309232"><span class="hs-identifier hs-var">value''</span></a></span><span>
</span><span id="line-181"></span><span>      </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMap</span></a></span><span> </span><span id="local-6989586621679309230"><span class="annot"><span class="annottext">Term
  s (PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
</span><a href="#local-6989586621679309230"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
-&gt; (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)) s
    -&gt; Term s (PInteger @S))
-&gt; Term s (PInteger @S)
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
</span><a href="#local-6989586621679309231"><span class="hs-identifier hs-var">value'</span></a></span><span>
</span><span id="line-182"></span><span>      </span><span id="local-6989586621679309229"><span class="annot"><span class="annottext">Term s (PAsData (PMap PTokenName (PInteger @S)))
</span><a href="#local-6989586621679309229"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S)
-&gt; Term s (PMaybe (PAsData (PMap PTokenName (PInteger @S))))
-&gt; (Term s (PAsData (PMap PTokenName (PInteger @S)))
    -&gt; Term s (PInteger @S))
-&gt; Term s (PInteger @S)
forall (r :: PType) (a :: PType) (s :: S).
Term s r -&gt; Term s (PMaybe a) -&gt; (Term s a -&gt; Term s r) -&gt; Term s r
</span><a href="Agora.Utils.html#pexpectJust"><span class="hs-identifier hs-var">pexpectJust</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S)
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s
  (PAsData PCurrencySymbol
   :--&gt; (PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S))
         :--&gt; PMaybe (PAsData (PMap PTokenName (PInteger @S)))))
forall (a :: PType) (list :: PType -&gt; PType) (b :: PType) (s :: S).
(PEq a, PIsListLike list (PBuiltinPair a b)) =&gt;
Term s (a :--&gt; (list (PBuiltinPair a b) :--&gt; PMaybe b))
</span><a href="Agora.Utils.html#plookup"><span class="hs-identifier hs-var">plookup</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PAsData PCurrencySymbol
   :--&gt; (PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S))
         :--&gt; PMaybe (PAsData (PMap PTokenName (PInteger @S)))))
-&gt; Term s (PAsData PCurrencySymbol)
-&gt; Term
     s
     (PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S))
      :--&gt; PMaybe (PAsData (PMap PTokenName (PInteger @S))))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PCurrencySymbol -&gt; Term s (PAsData PCurrencySymbol)
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s a -&gt; Term s (PAsData a)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pdata</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679309233"><span class="hs-identifier hs-var">sym</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S))
   :--&gt; PMaybe (PAsData (PMap PTokenName (PInteger @S))))
-&gt; Term
     s (PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
-&gt; Term s (PMaybe (PAsData (PMap PTokenName (PInteger @S))))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s (PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
</span><a href="#local-6989586621679309230"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>      </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMap</span></a></span><span> </span><span id="local-6989586621679309227"><span class="annot"><span class="annottext">Term s (PBuiltinMap PTokenName (PInteger @S))
</span><a href="#local-6989586621679309227"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s (PMap PTokenName (PInteger @S))
-&gt; (PMap PTokenName (PInteger @S) s -&gt; Term s (PInteger @S))
-&gt; Term s (PInteger @S)
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PAsData (PMap PTokenName (PInteger @S)))
-&gt; Term s (PMap PTokenName (PInteger @S))
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfromData</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData (PMap PTokenName (PInteger @S)))
</span><a href="#local-6989586621679309229"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>      </span><span class="annot"><span class="annottext">Term
  s
  ((PBuiltinPair (PAsData PTokenName) (PAsData (PInteger @S))
    :--&gt; (PInteger @S :--&gt; PInteger @S))
   :--&gt; (PInteger @S
         :--&gt; (PBuiltinMap PTokenName (PInteger @S) :--&gt; PInteger @S)))
forall (list :: PType -&gt; PType) (a :: PType) (s :: S) (b :: PType).
PIsListLike list a =&gt;
Term s ((a :--&gt; (b :--&gt; b)) :--&gt; (b :--&gt; (list a :--&gt; b)))
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfoldr</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  ((PBuiltinPair (PAsData PTokenName) (PAsData (PInteger @S))
    :--&gt; (PInteger @S :--&gt; PInteger @S))
   :--&gt; (PInteger @S
         :--&gt; (PBuiltinMap PTokenName (PInteger @S) :--&gt; PInteger @S)))
-&gt; Term
     s
     (PBuiltinPair (PAsData PTokenName) (PAsData (PInteger @S))
      :--&gt; (PInteger @S :--&gt; PInteger @S))
-&gt; Term
     s
     (PInteger @S
      :--&gt; (PBuiltinMap PTokenName (PInteger @S) :--&gt; PInteger @S))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PBuiltinPair (PAsData PTokenName) (PAsData (PInteger @S)))
 -&gt; Term s (PInteger @S) -&gt; Term s (PInteger @S))
-&gt; Term
     s
     (PBuiltinPair (PAsData PTokenName) (PAsData (PInteger @S))
      :--&gt; (PInteger @S :--&gt; PInteger @S))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679309225"><span class="annot"><span class="annottext">Term s (PBuiltinPair (PAsData PTokenName) (PAsData (PInteger @S)))
</span><a href="#local-6989586621679309225"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679309224"><span class="annot"><span class="annottext">Term s (PInteger @S)
</span><a href="#local-6989586621679309224"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term s (PAsData (PInteger @S)) -&gt; Term s (PInteger @S)
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfromData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair (PAsData PTokenName) (PAsData (PInteger @S))
   :--&gt; PAsData (PInteger @S))
forall (s :: S) (a :: PType) (b :: PType).
Term s (PBuiltinPair a b :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">psndBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair (PAsData PTokenName) (PAsData (PInteger @S))
   :--&gt; PAsData (PInteger @S))
-&gt; Term
     s (PBuiltinPair (PAsData PTokenName) (PAsData (PInteger @S)))
-&gt; Term s (PAsData (PInteger @S))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinPair (PAsData PTokenName) (PAsData (PInteger @S)))
</span><a href="#local-6989586621679309225"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S)
-&gt; Term s (PInteger @S) -&gt; Term s (PInteger @S)
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S)
</span><a href="#local-6989586621679309224"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PInteger @S
   :--&gt; (PBuiltinMap PTokenName (PInteger @S) :--&gt; PInteger @S))
-&gt; Term s (PInteger @S)
-&gt; Term s (PBuiltinMap PTokenName (PInteger @S) :--&gt; PInteger @S)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S)
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinMap PTokenName (PInteger @S) :--&gt; PInteger @S)
-&gt; Term s (PBuiltinMap PTokenName (PInteger @S))
-&gt; Term s (PInteger @S)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinMap PTokenName (PInteger @S))
</span><a href="#local-6989586621679309227"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">-- | Extract amount from PValue belonging to a Plutarch-level asset class.</span><span>
</span><span id="line-187"></span><span id="local-6989586621679309663"><span class="annot"><a href="Agora.Utils.html#passetClassValueOf"><span class="hs-identifier hs-type">passetClassValueOf</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309663"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PCurrencySymbol</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTokenName</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PInteger</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-189"></span><span id="passetClassValueOf"><span class="annot"><span class="annottext">passetClassValueOf :: forall (s :: S).
Term
  s
  (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S)))
</span><a href="Agora.Utils.html#passetClassValueOf"><span class="hs-identifier hs-var hs-var">passetClassValueOf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><span class="annottext">(forall (s :: S).
 Term
   s
   (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S))))
-&gt; Term
     s
     (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S)))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (s :: S).
  Term
    s
    (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S))))
 -&gt; Term
      s
      (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S))))
-&gt; (forall (s :: S).
    Term
      s
      (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S))))
-&gt; Term
     s
     (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><span class="annottext">(Term s PCurrencySymbol
 -&gt; Term s PTokenName -&gt; Term s PValue -&gt; Term s (PInteger @S))
-&gt; Term
     s
     (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S)))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PCurrencySymbol
  -&gt; Term s PTokenName -&gt; Term s PValue -&gt; Term s (PInteger @S))
 -&gt; Term
      s
      (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S))))
-&gt; (Term s PCurrencySymbol
    -&gt; Term s PTokenName -&gt; Term s PValue -&gt; Term s (PInteger @S))
-&gt; Term
     s
     (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679309188"><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679309188"><span class="hs-identifier hs-var">sym</span></a></span></span><span> </span><span id="local-6989586621679309187"><span class="annot"><span class="annottext">Term s PTokenName
</span><a href="#local-6989586621679309187"><span class="hs-identifier hs-var">token</span></a></span></span><span> </span><span id="local-6989586621679309186"><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309186"><span class="hs-identifier hs-var">value''</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-192"></span><span>      </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span> </span><span id="local-6989586621679309185"><span class="annot"><span class="annottext">Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
</span><a href="#local-6989586621679309185"><span class="hs-identifier hs-var">value'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s PValue
-&gt; (PValue s -&gt; Term s (PInteger @S)) -&gt; Term s (PInteger @S)
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309186"><span class="hs-identifier hs-var">value''</span></a></span><span>
</span><span id="line-193"></span><span>      </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMap</span></a></span><span> </span><span id="local-6989586621679309184"><span class="annot"><span class="annottext">Term
  s (PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
</span><a href="#local-6989586621679309184"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
-&gt; (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)) s
    -&gt; Term s (PInteger @S))
-&gt; Term s (PInteger @S)
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
</span><a href="#local-6989586621679309185"><span class="hs-identifier hs-var">value'</span></a></span><span>
</span><span id="line-194"></span><span>      </span><span id="local-6989586621679309183"><span class="annot"><span class="annottext">Term s (PAsData (PMap PTokenName (PInteger @S)))
</span><a href="#local-6989586621679309183"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S)
-&gt; Term s (PMaybe (PAsData (PMap PTokenName (PInteger @S))))
-&gt; (Term s (PAsData (PMap PTokenName (PInteger @S)))
    -&gt; Term s (PInteger @S))
-&gt; Term s (PInteger @S)
forall (r :: PType) (a :: PType) (s :: S).
Term s r -&gt; Term s (PMaybe a) -&gt; (Term s a -&gt; Term s r) -&gt; Term s r
</span><a href="Agora.Utils.html#pexpectJust"><span class="hs-identifier hs-var">pexpectJust</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S)
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s
  (PAsData PCurrencySymbol
   :--&gt; (PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S))
         :--&gt; PMaybe (PAsData (PMap PTokenName (PInteger @S)))))
forall (a :: PType) (list :: PType -&gt; PType) (b :: PType) (s :: S).
(PEq a, PIsListLike list (PBuiltinPair a b)) =&gt;
Term s (a :--&gt; (list (PBuiltinPair a b) :--&gt; PMaybe b))
</span><a href="Agora.Utils.html#plookup"><span class="hs-identifier hs-var">plookup</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PAsData PCurrencySymbol
   :--&gt; (PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S))
         :--&gt; PMaybe (PAsData (PMap PTokenName (PInteger @S)))))
-&gt; Term s (PAsData PCurrencySymbol)
-&gt; Term
     s
     (PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S))
      :--&gt; PMaybe (PAsData (PMap PTokenName (PInteger @S))))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PCurrencySymbol -&gt; Term s (PAsData PCurrencySymbol)
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s a -&gt; Term s (PAsData a)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pdata</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679309188"><span class="hs-identifier hs-var">sym</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S))
   :--&gt; PMaybe (PAsData (PMap PTokenName (PInteger @S))))
-&gt; Term
     s (PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
-&gt; Term s (PMaybe (PAsData (PMap PTokenName (PInteger @S))))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s (PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
</span><a href="#local-6989586621679309184"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>      </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMap</span></a></span><span> </span><span id="local-6989586621679309182"><span class="annot"><span class="annottext">Term s (PBuiltinMap PTokenName (PInteger @S))
</span><a href="#local-6989586621679309182"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s (PMap PTokenName (PInteger @S))
-&gt; (PMap PTokenName (PInteger @S) s -&gt; Term s (PInteger @S))
-&gt; Term s (PInteger @S)
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PAsData (PMap PTokenName (PInteger @S)))
-&gt; Term s (PMap PTokenName (PInteger @S))
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfromData</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData (PMap PTokenName (PInteger @S)))
</span><a href="#local-6989586621679309183"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>      </span><span id="local-6989586621679309181"><span class="annot"><span class="annottext">Term s (PAsData (PInteger @S))
</span><a href="#local-6989586621679309181"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S)
-&gt; Term s (PMaybe (PAsData (PInteger @S)))
-&gt; (Term s (PAsData (PInteger @S)) -&gt; Term s (PInteger @S))
-&gt; Term s (PInteger @S)
forall (r :: PType) (a :: PType) (s :: S).
Term s r -&gt; Term s (PMaybe a) -&gt; (Term s a -&gt; Term s r) -&gt; Term s r
</span><a href="Agora.Utils.html#pexpectJust"><span class="hs-identifier hs-var">pexpectJust</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S)
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s
  (PAsData PTokenName
   :--&gt; (PBuiltinMap PTokenName (PInteger @S)
         :--&gt; PMaybe (PAsData (PInteger @S))))
forall (a :: PType) (list :: PType -&gt; PType) (b :: PType) (s :: S).
(PEq a, PIsListLike list (PBuiltinPair a b)) =&gt;
Term s (a :--&gt; (list (PBuiltinPair a b) :--&gt; PMaybe b))
</span><a href="Agora.Utils.html#plookup"><span class="hs-identifier hs-var">plookup</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PAsData PTokenName
   :--&gt; (PBuiltinMap PTokenName (PInteger @S)
         :--&gt; PMaybe (PAsData (PInteger @S))))
-&gt; Term s (PAsData PTokenName)
-&gt; Term
     s
     (PBuiltinMap PTokenName (PInteger @S)
      :--&gt; PMaybe (PAsData (PInteger @S)))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTokenName -&gt; Term s (PAsData PTokenName)
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s a -&gt; Term s (PAsData a)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pdata</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTokenName
</span><a href="#local-6989586621679309187"><span class="hs-identifier hs-var">token</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinMap PTokenName (PInteger @S)
   :--&gt; PMaybe (PAsData (PInteger @S)))
-&gt; Term s (PBuiltinMap PTokenName (PInteger @S))
-&gt; Term s (PMaybe (PAsData (PInteger @S)))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinMap PTokenName (PInteger @S))
</span><a href="#local-6989586621679309182"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>      </span><span class="annot"><span class="annottext">Term s (PAsData (PInteger @S)) -&gt; Term s (PInteger @S)
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfromData</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData (PInteger @S))
</span><a href="#local-6989586621679309181"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- | Extract amount from PValue belonging to a Haskell-level AssetClass.</span><span>
</span><span id="line-200"></span><span id="local-6989586621679309659"><span class="annot"><a href="Agora.Utils.html#passetClassValueOf%27"><span class="hs-identifier hs-type">passetClassValueOf'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/56s38y8krq5sxnvf6xk7nj5vchvg5gay-plutus-ledger-api-lib-plutus-ledger-api-0.1.0.0-haddock-doc/share/doc/plutus-ledger-api/html/src"><span class="hs-identifier hs-type">AssetClass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309659"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PInteger</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-201"></span><span id="passetClassValueOf%27"><span class="annot"><span class="annottext">passetClassValueOf' :: forall (s :: S). AssetClass -&gt; Term s (PValue :--&gt; PInteger @S)
</span><a href="Agora.Utils.html#passetClassValueOf%27"><span class="hs-identifier hs-var hs-var">passetClassValueOf'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/56s38y8krq5sxnvf6xk7nj5vchvg5gay-plutus-ledger-api-lib-plutus-ledger-api-0.1.0.0-haddock-doc/share/doc/plutus-ledger-api/html/src"><span class="hs-identifier hs-type">AssetClass</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679309175"><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679309175"><span class="hs-identifier hs-var">sym</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679309174"><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679309174"><span class="hs-identifier hs-var">token</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><span class="annottext">Term
  s
  (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S)))
forall (s :: S).
Term
  s
  (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S)))
</span><a href="Agora.Utils.html#passetClassValueOf"><span class="hs-identifier hs-var">passetClassValueOf</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S)))
-&gt; Term s PCurrencySymbol
-&gt; Term s (PTokenName :--&gt; (PValue :--&gt; PInteger @S))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">PLifted PCurrencySymbol -&gt; Term s PCurrencySymbol
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pconstant</span></a></span><span> </span><span class="annot"><span class="annottext">PLifted PCurrencySymbol
CurrencySymbol
</span><a href="#local-6989586621679309175"><span class="hs-identifier hs-var">sym</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PTokenName :--&gt; (PValue :--&gt; PInteger @S))
-&gt; Term s PTokenName -&gt; Term s (PValue :--&gt; PInteger @S)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">PLifted PTokenName -&gt; Term s PTokenName
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pconstant</span></a></span><span> </span><span class="annot"><span class="annottext">PLifted PTokenName
TokenName
</span><a href="#local-6989586621679309174"><span class="hs-identifier hs-var">token</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- | Return '&gt;=' on two values comparing by only a particular AssetClass.</span><span>
</span><span id="line-205"></span><span id="local-6989586621679309655"><span class="annot"><a href="Agora.Utils.html#pgeqByClass"><span class="hs-identifier hs-type">pgeqByClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309655"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PCurrencySymbol</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTokenName</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBool</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-206"></span><span id="pgeqByClass"><span class="annot"><span class="annottext">pgeqByClass :: forall (s :: S).
Term
  s
  (PCurrencySymbol
   :--&gt; (PTokenName :--&gt; (PValue :--&gt; (PValue :--&gt; PBool))))
</span><a href="Agora.Utils.html#pgeqByClass"><span class="hs-identifier hs-var hs-var">pgeqByClass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><span class="annottext">(forall (s :: S).
 Term
   s
   (PCurrencySymbol
    :--&gt; (PTokenName :--&gt; (PValue :--&gt; (PValue :--&gt; PBool)))))
-&gt; Term
     s
     (PCurrencySymbol
      :--&gt; (PTokenName :--&gt; (PValue :--&gt; (PValue :--&gt; PBool))))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (s :: S).
  Term
    s
    (PCurrencySymbol
     :--&gt; (PTokenName :--&gt; (PValue :--&gt; (PValue :--&gt; PBool)))))
 -&gt; Term
      s
      (PCurrencySymbol
       :--&gt; (PTokenName :--&gt; (PValue :--&gt; (PValue :--&gt; PBool)))))
-&gt; (forall (s :: S).
    Term
      s
      (PCurrencySymbol
       :--&gt; (PTokenName :--&gt; (PValue :--&gt; (PValue :--&gt; PBool)))))
-&gt; Term
     s
     (PCurrencySymbol
      :--&gt; (PTokenName :--&gt; (PValue :--&gt; (PValue :--&gt; PBool))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="annottext">(Term s PCurrencySymbol
 -&gt; Term s PTokenName
 -&gt; Term s PValue
 -&gt; Term s PValue
 -&gt; Term s PBool)
-&gt; Term
     s
     (PCurrencySymbol
      :--&gt; (PTokenName :--&gt; (PValue :--&gt; (PValue :--&gt; PBool))))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PCurrencySymbol
  -&gt; Term s PTokenName
  -&gt; Term s PValue
  -&gt; Term s PValue
  -&gt; Term s PBool)
 -&gt; Term
      s
      (PCurrencySymbol
       :--&gt; (PTokenName :--&gt; (PValue :--&gt; (PValue :--&gt; PBool)))))
-&gt; (Term s PCurrencySymbol
    -&gt; Term s PTokenName
    -&gt; Term s PValue
    -&gt; Term s PValue
    -&gt; Term s PBool)
-&gt; Term
     s
     (PCurrencySymbol
      :--&gt; (PTokenName :--&gt; (PValue :--&gt; (PValue :--&gt; PBool))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679309161"><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679309161"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679309160"><span class="annot"><span class="annottext">Term s PTokenName
</span><a href="#local-6989586621679309160"><span class="hs-identifier hs-var">tn</span></a></span></span><span> </span><span id="local-6989586621679309159"><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309159"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679309158"><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309158"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-209"></span><span>      </span><span class="annot"><span class="annottext">Term
  s
  (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S)))
forall (s :: S).
Term
  s
  (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S)))
</span><a href="Agora.Utils.html#passetClassValueOf"><span class="hs-identifier hs-var">passetClassValueOf</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S)))
-&gt; Term s PCurrencySymbol
-&gt; Term s (PTokenName :--&gt; (PValue :--&gt; PInteger @S))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679309161"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PTokenName :--&gt; (PValue :--&gt; PInteger @S))
-&gt; Term s PTokenName -&gt; Term s (PValue :--&gt; PInteger @S)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTokenName
</span><a href="#local-6989586621679309160"><span class="hs-identifier hs-var">tn</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PValue :--&gt; PInteger @S)
-&gt; Term s PValue -&gt; Term s (PInteger @S)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309158"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S) -&gt; Term s (PInteger @S) -&gt; Term s PBool
forall (t :: PType) (s :: S).
POrd t =&gt;
Term s t -&gt; Term s t -&gt; Term s PBool
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S)))
forall (s :: S).
Term
  s
  (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S)))
</span><a href="Agora.Utils.html#passetClassValueOf"><span class="hs-identifier hs-var">passetClassValueOf</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PValue :--&gt; PInteger @S)))
-&gt; Term s PCurrencySymbol
-&gt; Term s (PTokenName :--&gt; (PValue :--&gt; PInteger @S))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679309161"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PTokenName :--&gt; (PValue :--&gt; PInteger @S))
-&gt; Term s PTokenName -&gt; Term s (PValue :--&gt; PInteger @S)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTokenName
</span><a href="#local-6989586621679309160"><span class="hs-identifier hs-var">tn</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PValue :--&gt; PInteger @S)
-&gt; Term s PValue -&gt; Term s (PInteger @S)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309159"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">-- | Return '&gt;=' on two values comparing by only a particular CurrencySymbol.</span><span>
</span><span id="line-212"></span><span id="local-6989586621679309649"><span class="annot"><a href="Agora.Utils.html#pgeqBySymbol"><span class="hs-identifier hs-type">pgeqBySymbol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309649"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PCurrencySymbol</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBool</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-213"></span><span id="pgeqBySymbol"><span class="annot"><span class="annottext">pgeqBySymbol :: forall (s :: S).
Term s (PCurrencySymbol :--&gt; (PValue :--&gt; (PValue :--&gt; PBool)))
</span><a href="Agora.Utils.html#pgeqBySymbol"><span class="hs-identifier hs-var hs-var">pgeqBySymbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><span class="annottext">(forall (s :: S).
 Term s (PCurrencySymbol :--&gt; (PValue :--&gt; (PValue :--&gt; PBool))))
-&gt; Term s (PCurrencySymbol :--&gt; (PValue :--&gt; (PValue :--&gt; PBool)))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (s :: S).
  Term s (PCurrencySymbol :--&gt; (PValue :--&gt; (PValue :--&gt; PBool))))
 -&gt; Term s (PCurrencySymbol :--&gt; (PValue :--&gt; (PValue :--&gt; PBool))))
-&gt; (forall (s :: S).
    Term s (PCurrencySymbol :--&gt; (PValue :--&gt; (PValue :--&gt; PBool))))
-&gt; Term s (PCurrencySymbol :--&gt; (PValue :--&gt; (PValue :--&gt; PBool)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><span class="annottext">(Term s PCurrencySymbol
 -&gt; Term s PValue -&gt; Term s PValue -&gt; Term s PBool)
-&gt; Term s (PCurrencySymbol :--&gt; (PValue :--&gt; (PValue :--&gt; PBool)))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PCurrencySymbol
  -&gt; Term s PValue -&gt; Term s PValue -&gt; Term s PBool)
 -&gt; Term s (PCurrencySymbol :--&gt; (PValue :--&gt; (PValue :--&gt; PBool))))
-&gt; (Term s PCurrencySymbol
    -&gt; Term s PValue -&gt; Term s PValue -&gt; Term s PBool)
-&gt; Term s (PCurrencySymbol :--&gt; (PValue :--&gt; (PValue :--&gt; PBool)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679309147"><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679309147"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679309146"><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309146"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679309145"><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309145"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-216"></span><span>      </span><span class="annot"><span class="annottext">Term s (PCurrencySymbol :--&gt; (PValue :--&gt; PInteger @S))
forall (s :: S).
Term s (PCurrencySymbol :--&gt; (PValue :--&gt; PInteger @S))
</span><a href="Agora.Utils.html#psymbolValueOf"><span class="hs-identifier hs-var">psymbolValueOf</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PCurrencySymbol :--&gt; (PValue :--&gt; PInteger @S))
-&gt; Term s PCurrencySymbol -&gt; Term s (PValue :--&gt; PInteger @S)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679309147"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PValue :--&gt; PInteger @S)
-&gt; Term s PValue -&gt; Term s (PInteger @S)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309145"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S) -&gt; Term s (PInteger @S) -&gt; Term s PBool
forall (t :: PType) (s :: S).
POrd t =&gt;
Term s t -&gt; Term s t -&gt; Term s PBool
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PCurrencySymbol :--&gt; (PValue :--&gt; PInteger @S))
forall (s :: S).
Term s (PCurrencySymbol :--&gt; (PValue :--&gt; PInteger @S))
</span><a href="Agora.Utils.html#psymbolValueOf"><span class="hs-identifier hs-var">psymbolValueOf</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PCurrencySymbol :--&gt; (PValue :--&gt; PInteger @S))
-&gt; Term s PCurrencySymbol -&gt; Term s (PValue :--&gt; PInteger @S)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679309147"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PValue :--&gt; PInteger @S)
-&gt; Term s PValue -&gt; Term s (PInteger @S)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309146"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-comment">-- | Return '&gt;=' on two values comparing by only a particular Haskell-level AssetClass.</span><span>
</span><span id="line-219"></span><span id="local-6989586621679309646"><span class="annot"><a href="Agora.Utils.html#pgeqByClass%27"><span class="hs-identifier hs-type">pgeqByClass'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/56s38y8krq5sxnvf6xk7nj5vchvg5gay-plutus-ledger-api-lib-plutus-ledger-api-0.1.0.0-haddock-doc/share/doc/plutus-ledger-api/html/src"><span class="hs-identifier hs-type">AssetClass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309646"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBool</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-220"></span><span id="pgeqByClass%27"><span class="annot"><span class="annottext">pgeqByClass' :: forall (s :: S).
AssetClass -&gt; Term s (PValue :--&gt; (PValue :--&gt; PBool))
</span><a href="Agora.Utils.html#pgeqByClass%27"><span class="hs-identifier hs-var hs-var">pgeqByClass'</span></a></span></span><span> </span><span id="local-6989586621679309142"><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621679309142"><span class="hs-identifier hs-var">ac</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><span class="annottext">ClosedTerm (PValue :--&gt; (PValue :--&gt; PBool))
-&gt; Term s (PValue :--&gt; (PValue :--&gt; PBool))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">(ClosedTerm (PValue :--&gt; (PValue :--&gt; PBool))
 -&gt; Term s (PValue :--&gt; (PValue :--&gt; PBool)))
-&gt; ClosedTerm (PValue :--&gt; (PValue :--&gt; PBool))
-&gt; Term s (PValue :--&gt; (PValue :--&gt; PBool))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><span class="annottext">(Term s PValue -&gt; Term s PValue -&gt; Term s PBool)
-&gt; Term s (PValue :--&gt; (PValue :--&gt; PBool))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PValue -&gt; Term s PValue -&gt; Term s PBool)
 -&gt; Term s (PValue :--&gt; (PValue :--&gt; PBool)))
-&gt; (Term s PValue -&gt; Term s PValue -&gt; Term s PBool)
-&gt; Term s (PValue :--&gt; (PValue :--&gt; PBool))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679309136"><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309136"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679309135"><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309135"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-223"></span><span>      </span><span class="annot"><span class="annottext">AssetClass -&gt; Term s (PValue :--&gt; PInteger @S)
forall (s :: S). AssetClass -&gt; Term s (PValue :--&gt; PInteger @S)
</span><a href="Agora.Utils.html#passetClassValueOf%27"><span class="hs-identifier hs-var">passetClassValueOf'</span></a></span><span> </span><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621679309142"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PValue :--&gt; PInteger @S)
-&gt; Term s PValue -&gt; Term s (PInteger @S)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309135"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S) -&gt; Term s (PInteger @S) -&gt; Term s PBool
forall (t :: PType) (s :: S).
POrd t =&gt;
Term s t -&gt; Term s t -&gt; Term s PBool
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">AssetClass -&gt; Term s (PValue :--&gt; PInteger @S)
forall (s :: S). AssetClass -&gt; Term s (PValue :--&gt; PInteger @S)
</span><a href="Agora.Utils.html#passetClassValueOf%27"><span class="hs-identifier hs-var">passetClassValueOf'</span></a></span><span> </span><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621679309142"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PValue :--&gt; PInteger @S)
-&gt; Term s PValue -&gt; Term s (PInteger @S)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309136"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-comment">-- | Union two maps using a merge function on collisions.</span><span>
</span><span id="line-226"></span><span class="annot"><a href="Agora.Utils.html#pmapUnionWith"><span class="hs-identifier hs-type">pmapUnionWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679309641"><span class="annot"><a href="#local-6989586621679309641"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679309643"><span class="annot"><a href="#local-6989586621679309643"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679309642"><span class="annot"><a href="#local-6989586621679309642"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PIsData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309643"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309642"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679309643"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309643"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309643"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309641"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309643"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309641"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309643"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309641"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309643"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span id="pmapUnionWith"><span class="annot"><span class="annottext">pmapUnionWith :: forall (k :: PType) (v :: PType) (s :: S).
PIsData v =&gt;
Term
  s
  ((v :--&gt; (v :--&gt; v)) :--&gt; (PMap k v :--&gt; (PMap k v :--&gt; PMap k v)))
</span><a href="Agora.Utils.html#pmapUnionWith"><span class="hs-identifier hs-var hs-var">pmapUnionWith</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClosedTerm
  ((v :--&gt; (v :--&gt; v)) :--&gt; (PMap k v :--&gt; (PMap k v :--&gt; PMap k v)))
-&gt; Term
     s
     ((v :--&gt; (v :--&gt; v)) :--&gt; (PMap k v :--&gt; (PMap k v :--&gt; PMap k v)))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">(ClosedTerm
   ((v :--&gt; (v :--&gt; v)) :--&gt; (PMap k v :--&gt; (PMap k v :--&gt; PMap k v)))
 -&gt; Term
      s
      ((v :--&gt; (v :--&gt; v))
       :--&gt; (PMap k v :--&gt; (PMap k v :--&gt; PMap k v))))
-&gt; ClosedTerm
     ((v :--&gt; (v :--&gt; v)) :--&gt; (PMap k v :--&gt; (PMap k v :--&gt; PMap k v)))
-&gt; Term
     s
     ((v :--&gt; (v :--&gt; v)) :--&gt; (PMap k v :--&gt; (PMap k v :--&gt; PMap k v)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-comment">-- TODO: this function is kinda suspect. I feel like a lot of optimizations could be done here</span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><span class="annottext">(Term s (v :--&gt; (v :--&gt; v))
 -&gt; Term s (PMap k v) -&gt; Term s (PMap k v) -&gt; Term s (PMap k v))
-&gt; Term
     s
     ((v :--&gt; (v :--&gt; v)) :--&gt; (PMap k v :--&gt; (PMap k v :--&gt; PMap k v)))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s (v :--&gt; (v :--&gt; v))
  -&gt; Term s (PMap k v) -&gt; Term s (PMap k v) -&gt; Term s (PMap k v))
 -&gt; Term
      s
      ((v :--&gt; (v :--&gt; v))
       :--&gt; (PMap k v :--&gt; (PMap k v :--&gt; PMap k v))))
-&gt; (Term s (v :--&gt; (v :--&gt; v))
    -&gt; Term s (PMap k v) -&gt; Term s (PMap k v) -&gt; Term s (PMap k v))
-&gt; Term
     s
     ((v :--&gt; (v :--&gt; v)) :--&gt; (PMap k v :--&gt; (PMap k v :--&gt; PMap k v)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679309096"><span class="annot"><span class="annottext">Term s (v :--&gt; (v :--&gt; v))
</span><a href="#local-6989586621679309096"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679309095"><span class="annot"><span class="annottext">Term s (PMap k v)
</span><a href="#local-6989586621679309095"><span class="hs-identifier hs-var">xs'</span></a></span></span><span> </span><span id="local-6989586621679309094"><span class="annot"><span class="annottext">Term s (PMap k v)
</span><a href="#local-6989586621679309094"><span class="hs-identifier hs-var">ys'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-230"></span><span>    </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMap</span></a></span><span> </span><span id="local-6989586621679309093"><span class="annot"><span class="annottext">Term s (PBuiltinMap k v)
</span><a href="#local-6989586621679309093"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s (PMap k v)
-&gt; (PMap k v s -&gt; Term s (PMap k v)) -&gt; Term s (PMap k v)
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PMap k v)
</span><a href="#local-6989586621679309095"><span class="hs-identifier hs-var">xs'</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMap</span></a></span><span> </span><span id="local-6989586621679309092"><span class="annot"><span class="annottext">Term s (PBuiltinMap k v)
</span><a href="#local-6989586621679309092"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s (PMap k v)
-&gt; (PMap k v s -&gt; Term s (PMap k v)) -&gt; Term s (PMap k v)
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PMap k v)
</span><a href="#local-6989586621679309094"><span class="hs-identifier hs-var">ys'</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679309091"><span class="annot"><span class="annottext">ls :: Term s (PBuiltinMap k v)
</span><a href="#local-6989586621679309091"><span class="hs-identifier hs-var hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-233"></span><span>          </span><span class="annot"><span class="annottext">Term
  s
  ((PBuiltinPair (PAsData k) (PAsData v)
    :--&gt; PBuiltinPair (PAsData k) (PAsData v))
   :--&gt; (PBuiltinMap k v :--&gt; PBuiltinMap k v))
forall (list :: PType -&gt; PType) (a :: PType) (b :: PType) (s :: S).
(PListLike list, PElemConstraint list a, PElemConstraint list b) =&gt;
Term s ((a :--&gt; b) :--&gt; (list a :--&gt; list b))
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmap</span></a></span><span class="hs-cpp">
            # plam
</span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-236"></span><span>                  </span><span class="hs-identifier">pf</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">plet</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pfstBuiltin</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">p</span><span>
</span><span id="line-237"></span><span>                  </span><span class="hs-identifier">pmatch</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">plookup</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">pf</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">ys</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-238"></span><span>                    </span><span class="hs-identifier">PJust</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-239"></span><span>                      </span><span class="hs-comment">-- Data conversions here are silly, aren't they?</span><span>
</span><span id="line-240"></span><span>                      </span><span class="hs-identifier">ppairDataBuiltin</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">pf</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">pdata</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psndBuiltin</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-identifier">v</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>                    </span><span class="hs-identifier">PNothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">p</span><span>
</span><span id="line-242"></span><span>              </span><span class="hs-special">)</span><span class="hs-cpp">
            # xs
</span><span>        </span><span id="local-6989586621679309085"><span class="annot"><span class="annottext">rs :: Term s (PBuiltinMap k v)
</span><a href="#local-6989586621679309085"><span class="hs-identifier hs-var hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-245"></span><span>          </span><span class="annot"><span class="annottext">Term
  s
  ((PBuiltinPair (PAsData k) (PAsData v) :--&gt; PBool)
   :--&gt; (PBuiltinMap k v :--&gt; PBuiltinMap k v))
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike list a =&gt;
Term s ((a :--&gt; PBool) :--&gt; (list a :--&gt; list a))
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfilter</span></a></span><span class="hs-cpp">
            # plam
</span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-248"></span><span>                  </span><span class="hs-identifier">pnot</span><span> </span><span class="hs-operator">#$</span><span> </span><span class="hs-identifier">pany</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">plam</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">p'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">pfstBuiltin</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">p'</span><span> </span><span class="hs-operator">#==</span><span> </span><span class="hs-identifier">pfstBuiltin</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">xs</span><span>
</span><span id="line-249"></span><span>              </span><span class="hs-special">)</span><span class="hs-cpp">
            # ys
</span><span>    </span><span class="annot"><span class="annottext">PMap k v s -&gt; Term s (PMap k v)
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PBuiltinMap k v) -&gt; PMap k v s
forall (k :: PType) (v :: PType) (s :: S).
Term s (PBuiltinMap k v) -&gt; PMap k v s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PBuiltinMap k v) -&gt; PMap k v s)
-&gt; Term s (PBuiltinMap k v) -&gt; PMap k v s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s (PBuiltinMap k v :--&gt; (PBuiltinMap k v :--&gt; PBuiltinMap k v))
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike list a =&gt;
Term s (list a :--&gt; (list a :--&gt; list a))
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pconcat</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s (PBuiltinMap k v :--&gt; (PBuiltinMap k v :--&gt; PBuiltinMap k v))
-&gt; Term s (PBuiltinMap k v)
-&gt; Term s (PBuiltinMap k v :--&gt; PBuiltinMap k v)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinMap k v)
</span><a href="#local-6989586621679309091"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinMap k v :--&gt; PBuiltinMap k v)
-&gt; Term s (PBuiltinMap k v) -&gt; Term s (PBuiltinMap k v)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinMap k v)
</span><a href="#local-6989586621679309085"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- | Add two 'PValue's together.</span><span>
</span><span id="line-254"></span><span class="annot"><a href="Agora.Utils.html#paddValue"><span class="hs-identifier hs-type">paddValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679309613"><span class="annot"><a href="#local-6989586621679309613"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309613"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span id="paddValue"><span class="annot"><span class="annottext">paddValue :: forall (s :: S). Term s (PValue :--&gt; (PValue :--&gt; PValue))
</span><a href="Agora.Utils.html#paddValue"><span class="hs-identifier hs-var hs-var">paddValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (s :: S). Term s (PValue :--&gt; (PValue :--&gt; PValue)))
-&gt; Term s (PValue :--&gt; (PValue :--&gt; PValue))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (s :: S). Term s (PValue :--&gt; (PValue :--&gt; PValue)))
 -&gt; Term s (PValue :--&gt; (PValue :--&gt; PValue)))
-&gt; (forall (s :: S). Term s (PValue :--&gt; (PValue :--&gt; PValue)))
-&gt; Term s (PValue :--&gt; (PValue :--&gt; PValue))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span class="annot"><span class="annottext">(Term s PValue -&gt; Term s PValue -&gt; Term s PValue)
-&gt; Term s (PValue :--&gt; (PValue :--&gt; PValue))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PValue -&gt; Term s PValue -&gt; Term s PValue)
 -&gt; Term s (PValue :--&gt; (PValue :--&gt; PValue)))
-&gt; (Term s PValue -&gt; Term s PValue -&gt; Term s PValue)
-&gt; Term s (PValue :--&gt; (PValue :--&gt; PValue))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679309057"><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309057"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span id="local-6989586621679309056"><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309056"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span> </span><span id="local-6989586621679309055"><span class="annot"><span class="annottext">Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
</span><a href="#local-6989586621679309055"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s PValue -&gt; (PValue s -&gt; Term s PValue) -&gt; Term s PValue
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309057"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-258"></span><span>    </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span> </span><span id="local-6989586621679309054"><span class="annot"><span class="annottext">Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
</span><a href="#local-6989586621679309054"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s PValue -&gt; (PValue s -&gt; Term s PValue) -&gt; Term s PValue
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679309056"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><span class="annottext">PValue s -&gt; Term s PValue
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span>
</span><span id="line-260"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
-&gt; PValue s
forall (s :: S).
Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
-&gt; PValue s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
 -&gt; PValue s)
-&gt; Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
-&gt; PValue s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-261"></span><span>          </span><span class="annot"><span class="annottext">Term
  s
  ((PMap PTokenName (PInteger @S)
    :--&gt; (PMap PTokenName (PInteger @S)
          :--&gt; PMap PTokenName (PInteger @S)))
   :--&gt; (PMap PCurrencySymbol (PMap PTokenName (PInteger @S))
         :--&gt; (PMap PCurrencySymbol (PMap PTokenName (PInteger @S))
               :--&gt; PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))))
forall (k :: PType) (v :: PType) (s :: S).
PIsData v =&gt;
Term
  s
  ((v :--&gt; (v :--&gt; v)) :--&gt; (PMap k v :--&gt; (PMap k v :--&gt; PMap k v)))
</span><a href="Agora.Utils.html#pmapUnionWith"><span class="hs-identifier hs-var">pmapUnionWith</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  ((PMap PTokenName (PInteger @S)
    :--&gt; (PMap PTokenName (PInteger @S)
          :--&gt; PMap PTokenName (PInteger @S)))
   :--&gt; (PMap PCurrencySymbol (PMap PTokenName (PInteger @S))
         :--&gt; (PMap PCurrencySymbol (PMap PTokenName (PInteger @S))
               :--&gt; PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))))
-&gt; Term
     s
     (PMap PTokenName (PInteger @S)
      :--&gt; (PMap PTokenName (PInteger @S)
            :--&gt; PMap PTokenName (PInteger @S)))
-&gt; Term
     s
     (PMap PCurrencySymbol (PMap PTokenName (PInteger @S))
      :--&gt; (PMap PCurrencySymbol (PMap PTokenName (PInteger @S))
            :--&gt; PMap PCurrencySymbol (PMap PTokenName (PInteger @S))))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PMap PTokenName (PInteger @S))
 -&gt; Term s (PMap PTokenName (PInteger @S))
 -&gt; Term s (PMap PTokenName (PInteger @S)))
-&gt; Term
     s
     (PMap PTokenName (PInteger @S)
      :--&gt; (PMap PTokenName (PInteger @S)
            :--&gt; PMap PTokenName (PInteger @S)))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679309053"><span class="annot"><span class="annottext">Term s (PMap PTokenName (PInteger @S))
</span><a href="#local-6989586621679309053"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span id="local-6989586621679309052"><span class="annot"><span class="annottext">Term s (PMap PTokenName (PInteger @S))
</span><a href="#local-6989586621679309052"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term
  s
  ((PInteger @S :--&gt; (PInteger @S :--&gt; PInteger @S))
   :--&gt; (PMap PTokenName (PInteger @S)
         :--&gt; (PMap PTokenName (PInteger @S)
               :--&gt; PMap PTokenName (PInteger @S))))
forall (k :: PType) (v :: PType) (s :: S).
PIsData v =&gt;
Term
  s
  ((v :--&gt; (v :--&gt; v)) :--&gt; (PMap k v :--&gt; (PMap k v :--&gt; PMap k v)))
</span><a href="Agora.Utils.html#pmapUnionWith"><span class="hs-identifier hs-var">pmapUnionWith</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  ((PInteger @S :--&gt; (PInteger @S :--&gt; PInteger @S))
   :--&gt; (PMap PTokenName (PInteger @S)
         :--&gt; (PMap PTokenName (PInteger @S)
               :--&gt; PMap PTokenName (PInteger @S))))
-&gt; Term s (PInteger @S :--&gt; (PInteger @S :--&gt; PInteger @S))
-&gt; Term
     s
     (PMap PTokenName (PInteger @S)
      :--&gt; (PMap PTokenName (PInteger @S)
            :--&gt; PMap PTokenName (PInteger @S)))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PInteger @S)
 -&gt; Term s (PInteger @S) -&gt; Term s (PInteger @S))
-&gt; Term s (PInteger @S :--&gt; (PInteger @S :--&gt; PInteger @S))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S)
-&gt; Term s (PInteger @S) -&gt; Term s (PInteger @S)
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">(+)</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PMap PTokenName (PInteger @S)
   :--&gt; (PMap PTokenName (PInteger @S)
         :--&gt; PMap PTokenName (PInteger @S)))
-&gt; Term s (PMap PTokenName (PInteger @S))
-&gt; Term
     s
     (PMap PTokenName (PInteger @S) :--&gt; PMap PTokenName (PInteger @S))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PMap PTokenName (PInteger @S))
</span><a href="#local-6989586621679309053"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PMap PTokenName (PInteger @S) :--&gt; PMap PTokenName (PInteger @S))
-&gt; Term s (PMap PTokenName (PInteger @S))
-&gt; Term s (PMap PTokenName (PInteger @S))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PMap PTokenName (PInteger @S))
</span><a href="#local-6989586621679309052"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PMap PCurrencySymbol (PMap PTokenName (PInteger @S))
   :--&gt; (PMap PCurrencySymbol (PMap PTokenName (PInteger @S))
         :--&gt; PMap PCurrencySymbol (PMap PTokenName (PInteger @S))))
-&gt; Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
-&gt; Term
     s
     (PMap PCurrencySymbol (PMap PTokenName (PInteger @S))
      :--&gt; PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
</span><a href="#local-6989586621679309055"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PMap PCurrencySymbol (PMap PTokenName (PInteger @S))
   :--&gt; PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
-&gt; Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
-&gt; Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
</span><a href="#local-6989586621679309054"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-262"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- | Sum of all value at input.</span><span>
</span><span id="line-265"></span><span id="local-6989586621679309609"><span class="annot"><a href="Agora.Utils.html#pvalueSpent"><span class="hs-identifier hs-type">pvalueSpent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309609"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxInfo</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-266"></span><span id="pvalueSpent"><span class="annot"><span class="annottext">pvalueSpent :: forall (s :: S). Term s (PTxInfo :--&gt; PValue)
</span><a href="Agora.Utils.html#pvalueSpent"><span class="hs-identifier hs-var hs-var">pvalueSpent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (s :: S). Term s (PTxInfo :--&gt; PValue))
-&gt; Term s (PTxInfo :--&gt; PValue)
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (s :: S). Term s (PTxInfo :--&gt; PValue))
 -&gt; Term s (PTxInfo :--&gt; PValue))
-&gt; (forall (s :: S). Term s (PTxInfo :--&gt; PValue))
-&gt; Term s (PTxInfo :--&gt; PValue)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-267"></span><span>  </span><span class="annot"><span class="annottext">(Term s PTxInfo -&gt; Term s PValue) -&gt; Term s (PTxInfo :--&gt; PValue)
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PTxInfo -&gt; Term s PValue) -&gt; Term s (PTxInfo :--&gt; PValue))
-&gt; (Term s PTxInfo -&gt; Term s PValue)
-&gt; Term s (PTxInfo :--&gt; PValue)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679308989"><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679308989"><span class="hs-identifier hs-var">txInfo'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><span class="annottext">Term s PTxInfo -&gt; (PTxInfo s -&gt; Term s PValue) -&gt; Term s PValue
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679308989"><span class="hs-identifier hs-var">txInfo'</span></a></span><span> </span><span class="annot"><span class="annottext">((PTxInfo s -&gt; Term s PValue) -&gt; Term s PValue)
-&gt; (PTxInfo s -&gt; Term s PValue) -&gt; Term s PValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxInfo</span></a></span><span> </span><span id="local-6989586621679308988"><span class="annot"><span class="annottext">Term
  s
  (PDataRecord
     ((':)
        @PLabeledType
        (&quot;inputs&quot; ':= PBuiltinList (PAsData PTxInInfo))
        ((':)
           @PLabeledType
           (&quot;outputs&quot; ':= PBuiltinList (PAsData PTxOut))
           ((':)
              @PLabeledType
              (&quot;fee&quot; ':= PValue)
              ((':)
                 @PLabeledType
                 (&quot;mint&quot; ':= PValue)
                 ((':)
                    @PLabeledType
                    (&quot;dcert&quot; ':= PBuiltinList (PAsData PDCert))
                    ((':)
                       @PLabeledType
                       (&quot;wdrl&quot;
                        ':= PBuiltinList
                              (PAsData (PTuple PStakingCredential (PInteger @S))))
                       ((':)
                          @PLabeledType
                          (&quot;validRange&quot; ':= PPOSIXTimeRange)
                          ((':)
                             @PLabeledType
                             (&quot;signatories&quot; ':= PBuiltinList (PAsData PPubKeyHash))
                             ((':)
                                @PLabeledType
                                (&quot;data&quot; ':= PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
                                ((':) @PLabeledType (&quot;id&quot; ':= PTxId) ('[] @PLabeledType))))))))))))
</span><a href="#local-6989586621679308988"><span class="hs-identifier hs-var">txInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-269"></span><span>      </span><span class="annot"><span class="annottext">Term
  s
  ((PAsData PTxInInfo :--&gt; (PValue :--&gt; PValue))
   :--&gt; (PValue :--&gt; (PBuiltinList (PAsData PTxInInfo) :--&gt; PValue)))
forall (list :: PType -&gt; PType) (a :: PType) (s :: S) (b :: PType).
PIsListLike list a =&gt;
Term s ((a :--&gt; (b :--&gt; b)) :--&gt; (b :--&gt; (list a :--&gt; b)))
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfoldr</span></a></span><span class="hs-cpp">
        # plam
</span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">txInInfo'</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-272"></span><span>              </span><span class="hs-identifier">pmatch</span><span>
</span><span id="line-273"></span><span>                </span><span class="hs-special">(</span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-identifier">txInInfo'</span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>                </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">PTxInInfo</span><span> </span><span class="hs-identifier">txInInfo</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-275"></span><span>                  </span><span class="hs-identifier">paddValue</span><span class="hs-cpp">
                    # pmatch
</span><span>                      </span><span class="hs-special">(</span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;resolved&quot;</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">txInInfo</span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>                      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">PTxOut</span><span> </span><span class="hs-identifier">o</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;value&quot;</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">o</span><span class="hs-special">)</span><span class="hs-cpp">
                    # v
</span><span>          </span><span class="hs-special">)</span><span class="hs-cpp">
        # pconstant mempty
</span><span class="hs-cpp">        # (pfield @&quot;inputs&quot; # txInfo)
</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- | Find the TxInInfo by a TxOutRef.</span><span>
</span><span id="line-285"></span><span id="local-6989586621679309600"><span class="annot"><a href="Agora.Utils.html#pfindTxInByTxOutRef"><span class="hs-identifier hs-type">pfindTxInByTxOutRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309600"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxOutRef</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxInfo</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMaybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxInInfo</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-286"></span><span id="pfindTxInByTxOutRef"><span class="annot"><span class="annottext">pfindTxInByTxOutRef :: forall (s :: S).
Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxInInfo))
</span><a href="Agora.Utils.html#pfindTxInByTxOutRef"><span class="hs-identifier hs-var hs-var">pfindTxInByTxOutRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (s :: S).
 Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxInInfo)))
-&gt; Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxInInfo))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (s :: S).
  Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxInInfo)))
 -&gt; Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxInInfo)))
-&gt; (forall (s :: S).
    Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxInInfo)))
-&gt; Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxInInfo))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-287"></span><span>  </span><span class="annot"><span class="annottext">(Term s PTxOutRef -&gt; Term s PTxInfo -&gt; Term s (PMaybe PTxInInfo))
-&gt; Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxInInfo))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PTxOutRef -&gt; Term s PTxInfo -&gt; Term s (PMaybe PTxInInfo))
 -&gt; Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxInInfo)))
-&gt; (Term s PTxOutRef
    -&gt; Term s PTxInfo -&gt; Term s (PMaybe PTxInInfo))
-&gt; Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxInInfo))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679308940"><span class="annot"><span class="annottext">Term s PTxOutRef
</span><a href="#local-6989586621679308940"><span class="hs-identifier hs-var">txOutRef</span></a></span></span><span> </span><span id="local-6989586621679308939"><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679308939"><span class="hs-identifier hs-var">txInfo'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><span class="annottext">Term s PTxInfo
-&gt; (PTxInfo s -&gt; Term s (PMaybe PTxInInfo))
-&gt; Term s (PMaybe PTxInInfo)
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679308939"><span class="hs-identifier hs-var">txInfo'</span></a></span><span> </span><span class="annot"><span class="annottext">((PTxInfo s -&gt; Term s (PMaybe PTxInInfo))
 -&gt; Term s (PMaybe PTxInInfo))
-&gt; (PTxInfo s -&gt; Term s (PMaybe PTxInInfo))
-&gt; Term s (PMaybe PTxInInfo)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxInfo</span></a></span><span> </span><span id="local-6989586621679308938"><span class="annot"><span class="annottext">Term
  s
  (PDataRecord
     ((':)
        @PLabeledType
        (&quot;inputs&quot; ':= PBuiltinList (PAsData PTxInInfo))
        ((':)
           @PLabeledType
           (&quot;outputs&quot; ':= PBuiltinList (PAsData PTxOut))
           ((':)
              @PLabeledType
              (&quot;fee&quot; ':= PValue)
              ((':)
                 @PLabeledType
                 (&quot;mint&quot; ':= PValue)
                 ((':)
                    @PLabeledType
                    (&quot;dcert&quot; ':= PBuiltinList (PAsData PDCert))
                    ((':)
                       @PLabeledType
                       (&quot;wdrl&quot;
                        ':= PBuiltinList
                              (PAsData (PTuple PStakingCredential (PInteger @S))))
                       ((':)
                          @PLabeledType
                          (&quot;validRange&quot; ':= PPOSIXTimeRange)
                          ((':)
                             @PLabeledType
                             (&quot;signatories&quot; ':= PBuiltinList (PAsData PPubKeyHash))
                             ((':)
                                @PLabeledType
                                (&quot;data&quot; ':= PBuiltinList (PAsData (PTuple PDatumHash PDatum)))
                                ((':) @PLabeledType (&quot;id&quot; ':= PTxId) ('[] @PLabeledType))))))))))))
</span><a href="#local-6989586621679308938"><span class="hs-identifier hs-var">txInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-289"></span><span>      </span><span class="annot"><span class="annottext">Term
  s
  ((PAsData PTxInInfo :--&gt; PMaybe PTxInInfo)
   :--&gt; (PBuiltinList (PAsData PTxInInfo) :--&gt; PMaybe PTxInInfo))
forall (list :: PType -&gt; PType) (a :: PType) (s :: S) (b :: PType).
PIsListLike list a =&gt;
Term s ((a :--&gt; PMaybe b) :--&gt; (list a :--&gt; PMaybe b))
</span><a href="Agora.Utils.html#pfindMap"><span class="hs-identifier hs-var">pfindMap</span></a></span><span class="hs-cpp">
        # plam
</span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">txInInfo'</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-292"></span><span>              </span><span class="hs-identifier">plet</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-identifier">txInInfo'</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-293"></span><span>                </span><span class="hs-identifier">pmatch</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">PTxInInfo</span><span> </span><span class="hs-identifier">txInInfo</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-294"></span><span>                  </span><span class="hs-identifier">pif</span><span>
</span><span id="line-295"></span><span>                    </span><span class="hs-special">(</span><span class="hs-identifier">pdata</span><span> </span><span class="hs-identifier">txOutRef</span><span> </span><span class="hs-operator">#==</span><span> </span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;outRef&quot;</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">txInInfo</span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>                    </span><span class="hs-special">(</span><span class="hs-identifier">pcon</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PJust</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>                    </span><span class="hs-special">(</span><span class="hs-identifier">pcon</span><span> </span><span class="hs-identifier">PNothing</span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>          </span><span class="hs-special">)</span><span class="hs-cpp">
        #$ (pfield @&quot;inputs&quot; # txInfo)
</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- | True if a list is not empty.</span><span>
</span><span id="line-302"></span><span class="annot"><a href="Agora.Utils.html#pnotNull"><span class="hs-identifier hs-type">pnotNull</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679308934"><span class="annot"><a href="#local-6989586621679308934"><span class="hs-identifier hs-type">list</span></a></span></span><span> </span><span id="local-6989586621679308933"><span class="annot"><a href="#local-6989586621679308933"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PIsListLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679308934"><span class="hs-identifier hs-type">list</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679308933"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679308934"><span class="hs-identifier hs-type">list</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679308933"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span id="pnotNull"><span class="annot"><span class="annottext">pnotNull :: Term w (list a :--&gt; PBool)
</span><a href="Agora.Utils.html#pnotNull"><span class="hs-identifier hs-var hs-var">pnotNull</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClosedTerm (list a :--&gt; PBool) -&gt; Term w (list a :--&gt; PBool)
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">(ClosedTerm (list a :--&gt; PBool) -&gt; Term w (list a :--&gt; PBool))
-&gt; ClosedTerm (list a :--&gt; PBool) -&gt; Term w (list a :--&gt; PBool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (list a) -&gt; Term s PBool) -&gt; Term s (list a :--&gt; PBool)
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s (list a) -&gt; Term s PBool) -&gt; Term s (list a :--&gt; PBool))
-&gt; (Term s (list a) -&gt; Term s PBool) -&gt; Term s (list a :--&gt; PBool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s a -&gt; Term s (list a) -&gt; Term s PBool)
-&gt; Term s PBool -&gt; Term s (list a) -&gt; Term s PBool
forall (list :: PType -&gt; PType) (a :: PType) (s :: S) (r :: PType).
(PListLike list, PElemConstraint list a) =&gt;
(Term s a -&gt; Term s (list a) -&gt; Term s r)
-&gt; Term s r -&gt; Term s (list a) -&gt; Term s r
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pelimList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Term s a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term s (list a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PBool s -&gt; Term s PBool
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">PBool s
forall (s :: S). PBool s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PTrue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PBool s -&gt; Term s PBool
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">PBool s
forall (s :: S). PBool s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PFalse</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-306"></span><span class="hs-comment">{- Functions which should (probably) not be upstreamed
   All of these functions are quite inefficient.
-}</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-comment">-- | Check if any output matches the predicate.</span><span>
</span><span id="line-311"></span><span class="annot"><a href="Agora.Utils.html#anyOutput"><span class="hs-identifier hs-type">anyOutput</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679309586"><span class="annot"><a href="#local-6989586621679309586"><span class="hs-identifier hs-type">datum</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PType</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679309585"><span class="annot"><a href="#local-6989586621679309585"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PIsData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309586"><span class="hs-identifier hs-type">datum</span></a></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-315"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309585"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxInfo</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAddress</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309586"><span class="hs-identifier hs-type">datum</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span id="anyOutput"><span class="annot"><span class="annottext">anyOutput :: forall (datum :: PType) (s :: S).
PIsData datum =&gt;
Term
  s
  (PTxInfo
   :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))) :--&gt; PBool))
</span><a href="Agora.Utils.html#anyOutput"><span class="hs-identifier hs-var hs-var">anyOutput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClosedTerm
  (PTxInfo
   :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))) :--&gt; PBool))
-&gt; Term
     s
     (PTxInfo
      :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))) :--&gt; PBool))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">(ClosedTerm
   (PTxInfo
    :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))) :--&gt; PBool))
 -&gt; Term
      s
      (PTxInfo
       :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool)))
             :--&gt; PBool)))
-&gt; ClosedTerm
     (PTxInfo
      :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))) :--&gt; PBool))
-&gt; Term
     s
     (PTxInfo
      :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))) :--&gt; PBool))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-317"></span><span>  </span><span class="annot"><span class="annottext">(Term s PTxInfo
 -&gt; Term s (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool)))
 -&gt; Term s PBool)
-&gt; Term
     s
     (PTxInfo
      :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))) :--&gt; PBool))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PTxInfo
  -&gt; Term s (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool)))
  -&gt; Term s PBool)
 -&gt; Term
      s
      (PTxInfo
       :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool)))
             :--&gt; PBool)))
-&gt; (Term s PTxInfo
    -&gt; Term s (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool)))
    -&gt; Term s PBool)
-&gt; Term
     s
     (PTxInfo
      :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))) :--&gt; PBool))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679308815"><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679308815"><span class="hs-identifier hs-var">txInfo'</span></a></span></span><span> </span><span id="local-6989586621679308814"><span class="annot"><span class="annottext">Term s (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool)))
</span><a href="#local-6989586621679308814"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-318"></span><span>    </span><span id="local-6989586621679308813"><span class="annot"><span class="annottext">HRec
  ((':)
     @Type
     (Labeled
        @Symbol
        &quot;outputs&quot;
        (Term s (PAsData (PBuiltinList (PAsData PTxOut)))))
     ('[] @Type))
</span><a href="#local-6989586621679308813"><span class="hs-identifier hs-var">txInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fs :: [Symbol]) (a :: PType) (s :: S) (b :: PType)
       (ps :: [PLabeledType]) (bs :: [ToBind]).
(PDataFields a,
 (ps :: [PLabeledType]) ~ (PFields a :: [PLabeledType]),
 (bs :: [ToBind]) ~ (Bindings ps fs :: [ToBind]),
 BindFields ps bs) =&gt;
Term s a -&gt; (HRec (BoundTerms ps bs s) -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pletFields</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;outputs&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679308815"><span class="hs-identifier hs-var">txInfo'</span></a></span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><span class="annottext">Term
  s
  ((PAsData PTxOut :--&gt; PBool)
   :--&gt; (PBuiltinList (PAsData PTxOut) :--&gt; PBool))
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike list a =&gt;
Term s ((a :--&gt; PBool) :--&gt; (list a :--&gt; PBool))
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pany</span></a></span><span class="hs-cpp">
      # plam
</span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">txOut''</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-322"></span><span>            </span><span class="hs-identifier">PTxOut</span><span> </span><span class="hs-identifier">txOut'</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">pmatch</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-identifier">txOut''</span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>            </span><span class="hs-identifier">txOut</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">pletFields</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-string">&quot;value&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;datumHash&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;address&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">txOut'</span><span>
</span><span id="line-324"></span><span>            </span><span class="hs-identifier">PDJust</span><span> </span><span class="hs-identifier">dh</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">pmatch</span><span> </span><span class="hs-identifier">txOut</span><span class="hs-operator">.</span><span class="hs-identifier">datumHash</span><span>
</span><span id="line-325"></span><span>            </span><span class="hs-identifier">pmatch</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfindDatum'</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">datum</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;_0&quot;</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">dh</span><span class="hs-special">)</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">txInfo'</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-326"></span><span>              </span><span class="hs-identifier">PJust</span><span> </span><span class="hs-identifier">datum</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-327"></span><span>                </span><span class="hs-identifier">predicate</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">txOut</span><span class="hs-operator">.</span><span class="hs-identifier">value</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">txOut</span><span class="hs-operator">.</span><span class="hs-identifier">address</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-identifier">datum</span><span>
</span><span id="line-328"></span><span>              </span><span class="hs-identifier">PNothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">pcon</span><span> </span><span class="hs-identifier">PFalse</span><span>
</span><span id="line-329"></span><span>        </span><span class="hs-special">)</span><span class="hs-cpp">
      # pfromData txInfo.outputs
</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- | Check if all outputs match the predicate.</span><span>
</span><span id="line-333"></span><span class="annot"><a href="Agora.Utils.html#allOutputs"><span class="hs-identifier hs-type">allOutputs</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679309567"><span class="annot"><a href="#local-6989586621679309567"><span class="hs-identifier hs-type">datum</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PType</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679309566"><span class="annot"><a href="#local-6989586621679309566"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PIsData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309567"><span class="hs-identifier hs-type">datum</span></a></span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-337"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309566"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxInfo</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxOut</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAddress</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309567"><span class="hs-identifier hs-type">datum</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span id="allOutputs"><span class="annot"><span class="annottext">allOutputs :: forall (datum :: PType) (s :: S).
PIsData datum =&gt;
Term
  s
  (PTxInfo
   :--&gt; ((PTxOut
          :--&gt; (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))))
         :--&gt; PBool))
</span><a href="Agora.Utils.html#allOutputs"><span class="hs-identifier hs-var hs-var">allOutputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClosedTerm
  (PTxInfo
   :--&gt; ((PTxOut
          :--&gt; (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))))
         :--&gt; PBool))
-&gt; Term
     s
     (PTxInfo
      :--&gt; ((PTxOut
             :--&gt; (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))))
            :--&gt; PBool))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">(ClosedTerm
   (PTxInfo
    :--&gt; ((PTxOut
           :--&gt; (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))))
          :--&gt; PBool))
 -&gt; Term
      s
      (PTxInfo
       :--&gt; ((PTxOut
              :--&gt; (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))))
             :--&gt; PBool)))
-&gt; ClosedTerm
     (PTxInfo
      :--&gt; ((PTxOut
             :--&gt; (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))))
            :--&gt; PBool))
-&gt; Term
     s
     (PTxInfo
      :--&gt; ((PTxOut
             :--&gt; (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))))
            :--&gt; PBool))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-339"></span><span>  </span><span class="annot"><span class="annottext">(Term s PTxInfo
 -&gt; Term
      s (PTxOut :--&gt; (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))))
 -&gt; Term s PBool)
-&gt; Term
     s
     (PTxInfo
      :--&gt; ((PTxOut
             :--&gt; (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))))
            :--&gt; PBool))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PTxInfo
  -&gt; Term
       s (PTxOut :--&gt; (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))))
  -&gt; Term s PBool)
 -&gt; Term
      s
      (PTxInfo
       :--&gt; ((PTxOut
              :--&gt; (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))))
             :--&gt; PBool)))
-&gt; (Term s PTxInfo
    -&gt; Term
         s (PTxOut :--&gt; (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))))
    -&gt; Term s PBool)
-&gt; Term
     s
     (PTxInfo
      :--&gt; ((PTxOut
             :--&gt; (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))))
            :--&gt; PBool))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679308715"><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679308715"><span class="hs-identifier hs-var">txInfo'</span></a></span></span><span> </span><span id="local-6989586621679308714"><span class="annot"><span class="annottext">Term
  s (PTxOut :--&gt; (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))))
</span><a href="#local-6989586621679308714"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-340"></span><span>    </span><span id="local-6989586621679308713"><span class="annot"><span class="annottext">HRec
  ((':)
     @Type
     (Labeled
        @Symbol
        &quot;outputs&quot;
        (Term s (PAsData (PBuiltinList (PAsData PTxOut)))))
     ('[] @Type))
</span><a href="#local-6989586621679308713"><span class="hs-identifier hs-var">txInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fs :: [Symbol]) (a :: PType) (s :: S) (b :: PType)
       (ps :: [PLabeledType]) (bs :: [ToBind]).
(PDataFields a,
 (ps :: [PLabeledType]) ~ (PFields a :: [PLabeledType]),
 (bs :: [ToBind]) ~ (Bindings ps fs :: [ToBind]),
 BindFields ps bs) =&gt;
Term s a -&gt; (HRec (BoundTerms ps bs s) -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pletFields</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;outputs&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679308715"><span class="hs-identifier hs-var">txInfo'</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><span class="annottext">Term
  s
  ((PAsData PTxOut :--&gt; PBool)
   :--&gt; (PBuiltinList (PAsData PTxOut) :--&gt; PBool))
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike list a =&gt;
Term s ((a :--&gt; PBool) :--&gt; (list a :--&gt; PBool))
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pall</span></a></span><span class="hs-cpp">
      # plam
</span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">txOut''</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-344"></span><span>            </span><span class="hs-identifier">PTxOut</span><span> </span><span class="hs-identifier">txOut'</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">pmatch</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-identifier">txOut''</span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>            </span><span class="hs-identifier">txOut</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">pletFields</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-string">&quot;value&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;datumHash&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;address&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">txOut'</span><span>
</span><span id="line-346"></span><span>            </span><span class="hs-identifier">PDJust</span><span> </span><span class="hs-identifier">dh</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">pmatch</span><span> </span><span class="hs-identifier">txOut</span><span class="hs-operator">.</span><span class="hs-identifier">datumHash</span><span>
</span><span id="line-347"></span><span>            </span><span class="hs-identifier">pmatch</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfindDatum'</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">datum</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;_0&quot;</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">dh</span><span class="hs-special">)</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">txInfo'</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-348"></span><span>              </span><span class="hs-identifier">PJust</span><span> </span><span class="hs-identifier">datum</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-349"></span><span>                </span><span class="hs-identifier">predicate</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-identifier">txOut''</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">txOut</span><span class="hs-operator">.</span><span class="hs-identifier">value</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">txOut</span><span class="hs-operator">.</span><span class="hs-identifier">address</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-identifier">datum</span><span>
</span><span id="line-350"></span><span>              </span><span class="hs-identifier">PNothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">pcon</span><span> </span><span class="hs-identifier">PFalse</span><span>
</span><span id="line-351"></span><span>        </span><span class="hs-special">)</span><span class="hs-cpp">
      # pfromData txInfo.outputs
</span><span>
</span><span id="line-354"></span><span class="hs-comment">-- | Check if any (resolved) input matches the predicate.</span><span>
</span><span id="line-355"></span><span class="annot"><a href="Agora.Utils.html#anyInput"><span class="hs-identifier hs-type">anyInput</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679308706"><span class="annot"><a href="#local-6989586621679308706"><span class="hs-identifier hs-type">datum</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PType</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679308705"><span class="annot"><a href="#local-6989586621679308705"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PIsData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679308706"><span class="hs-identifier hs-type">datum</span></a></span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-359"></span><span>  </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679308705"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxInfo</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAddress</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679308706"><span class="hs-identifier hs-type">datum</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span id="anyInput"><span class="annot"><span class="annottext">anyInput :: forall (datum :: PType) (s :: S).
PIsData datum =&gt;
Term
  s
  (PTxInfo
   :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))) :--&gt; PBool))
</span><a href="Agora.Utils.html#anyInput"><span class="hs-identifier hs-var hs-var">anyInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClosedTerm
  (PTxInfo
   :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))) :--&gt; PBool))
-&gt; Term
     s
     (PTxInfo
      :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))) :--&gt; PBool))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">(ClosedTerm
   (PTxInfo
    :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))) :--&gt; PBool))
 -&gt; Term
      s
      (PTxInfo
       :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool)))
             :--&gt; PBool)))
-&gt; ClosedTerm
     (PTxInfo
      :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))) :--&gt; PBool))
-&gt; Term
     s
     (PTxInfo
      :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))) :--&gt; PBool))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-361"></span><span>  </span><span class="annot"><span class="annottext">(Term s PTxInfo
 -&gt; Term s (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool)))
 -&gt; Term s PBool)
-&gt; Term
     s
     (PTxInfo
      :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))) :--&gt; PBool))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PTxInfo
  -&gt; Term s (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool)))
  -&gt; Term s PBool)
 -&gt; Term
      s
      (PTxInfo
       :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool)))
             :--&gt; PBool)))
-&gt; (Term s PTxInfo
    -&gt; Term s (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool)))
    -&gt; Term s PBool)
-&gt; Term
     s
     (PTxInfo
      :--&gt; ((PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool))) :--&gt; PBool))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679308602"><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679308602"><span class="hs-identifier hs-var">txInfo'</span></a></span></span><span> </span><span id="local-6989586621679308601"><span class="annot"><span class="annottext">Term s (PValue :--&gt; (PAddress :--&gt; (datum :--&gt; PBool)))
</span><a href="#local-6989586621679308601"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-362"></span><span>    </span><span id="local-6989586621679308600"><span class="annot"><span class="annottext">HRec
  ((':)
     @Type
     (Labeled
        @Symbol
        &quot;inputs&quot;
        (Term s (PAsData (PBuiltinList (PAsData PTxInInfo)))))
     ('[] @Type))
</span><a href="#local-6989586621679308600"><span class="hs-identifier hs-var">txInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fs :: [Symbol]) (a :: PType) (s :: S) (b :: PType)
       (ps :: [PLabeledType]) (bs :: [ToBind]).
(PDataFields a,
 (ps :: [PLabeledType]) ~ (PFields a :: [PLabeledType]),
 (bs :: [ToBind]) ~ (Bindings ps fs :: [ToBind]),
 BindFields ps bs) =&gt;
Term s a -&gt; (HRec (BoundTerms ps bs s) -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pletFields</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;inputs&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679308602"><span class="hs-identifier hs-var">txInfo'</span></a></span><span>
</span><span id="line-363"></span><span>    </span><span class="annot"><span class="annottext">Term
  s
  ((PAsData PTxInInfo :--&gt; PBool)
   :--&gt; (PBuiltinList (PAsData PTxInInfo) :--&gt; PBool))
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike list a =&gt;
Term s ((a :--&gt; PBool) :--&gt; (list a :--&gt; PBool))
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pany</span></a></span><span class="hs-cpp">
      # plam
</span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">txInInfo''</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-366"></span><span>            </span><span class="hs-identifier">PTxInInfo</span><span> </span><span class="hs-identifier">txInInfo'</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">pmatch</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-identifier">txInInfo''</span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">txOut''</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;resolved&quot;</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">txInInfo'</span><span>
</span><span id="line-368"></span><span>            </span><span class="hs-identifier">PTxOut</span><span> </span><span class="hs-identifier">txOut'</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">pmatch</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-identifier">txOut''</span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>            </span><span class="hs-identifier">txOut</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">pletFields</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-string">&quot;value&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;datumHash&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;address&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">txOut'</span><span>
</span><span id="line-370"></span><span>            </span><span class="hs-identifier">PDJust</span><span> </span><span class="hs-identifier">dh</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">pmatch</span><span> </span><span class="hs-identifier">txOut</span><span class="hs-operator">.</span><span class="hs-identifier">datumHash</span><span>
</span><span id="line-371"></span><span>            </span><span class="hs-identifier">pmatch</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfindDatum'</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">datum</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;_0&quot;</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">dh</span><span class="hs-special">)</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">txInfo'</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-372"></span><span>              </span><span class="hs-identifier">PJust</span><span> </span><span class="hs-identifier">datum</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-373"></span><span>                </span><span class="hs-identifier">predicate</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">txOut</span><span class="hs-operator">.</span><span class="hs-identifier">value</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">txOut</span><span class="hs-operator">.</span><span class="hs-identifier">address</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-identifier">datum</span><span>
</span><span id="line-374"></span><span>              </span><span class="hs-identifier">PNothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">pcon</span><span> </span><span class="hs-identifier">PFalse</span><span>
</span><span id="line-375"></span><span>        </span><span class="hs-special">)</span><span class="hs-cpp">
      # pfromData txInfo.inputs
</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- | Create a value with a single asset class.</span><span>
</span><span id="line-379"></span><span class="annot"><a href="Agora.Utils.html#psingletonValue"><span class="hs-identifier hs-type">psingletonValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679309559"><span class="annot"><a href="#local-6989586621679309559"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309559"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PCurrencySymbol</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTokenName</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PInteger</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span id="psingletonValue"><span class="annot"><span class="annottext">psingletonValue :: forall (s :: S).
Term
  s
  (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PInteger @S :--&gt; PValue)))
</span><a href="Agora.Utils.html#psingletonValue"><span class="hs-identifier hs-var hs-var">psingletonValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (s :: S).
 Term
   s
   (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PInteger @S :--&gt; PValue))))
-&gt; Term
     s
     (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PInteger @S :--&gt; PValue)))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (s :: S).
  Term
    s
    (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PInteger @S :--&gt; PValue))))
 -&gt; Term
      s
      (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PInteger @S :--&gt; PValue))))
-&gt; (forall (s :: S).
    Term
      s
      (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PInteger @S :--&gt; PValue))))
-&gt; Term
     s
     (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PInteger @S :--&gt; PValue)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-381"></span><span>  </span><span class="annot"><span class="annottext">(Term s PCurrencySymbol
 -&gt; Term s PTokenName -&gt; Term s (PInteger @S) -&gt; Term s PValue)
-&gt; Term
     s
     (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PInteger @S :--&gt; PValue)))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PCurrencySymbol
  -&gt; Term s PTokenName -&gt; Term s (PInteger @S) -&gt; Term s PValue)
 -&gt; Term
      s
      (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PInteger @S :--&gt; PValue))))
-&gt; (Term s PCurrencySymbol
    -&gt; Term s PTokenName -&gt; Term s (PInteger @S) -&gt; Term s PValue)
-&gt; Term
     s
     (PCurrencySymbol :--&gt; (PTokenName :--&gt; (PInteger @S :--&gt; PValue)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679308563"><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679308563"><span class="hs-identifier hs-var">sym</span></a></span></span><span> </span><span id="local-6989586621679308562"><span class="annot"><span class="annottext">Term s PTokenName
</span><a href="#local-6989586621679308562"><span class="hs-identifier hs-var">tok</span></a></span></span><span> </span><span id="local-6989586621679308561"><span class="annot"><span class="annottext">Term s (PInteger @S)
</span><a href="#local-6989586621679308561"><span class="hs-identifier hs-var">int</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-382"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679308560"><span class="annot"><span class="annottext">innerTup :: Term s (PMap PTokenName (PInteger @S))
</span><a href="#local-6989586621679308560"><span class="hs-identifier hs-var hs-var">innerTup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PMap PTokenName (PInteger @S) s
-&gt; Term s (PMap PTokenName (PInteger @S))
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">(PMap PTokenName (PInteger @S) s
 -&gt; Term s (PMap PTokenName (PInteger @S)))
-&gt; PMap PTokenName (PInteger @S) s
-&gt; Term s (PMap PTokenName (PInteger @S))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinMap PTokenName (PInteger @S))
-&gt; PMap PTokenName (PInteger @S) s
forall (k :: PType) (v :: PType) (s :: S).
Term s (PBuiltinMap k v) -&gt; PMap k v s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PBuiltinMap PTokenName (PInteger @S))
 -&gt; PMap PTokenName (PInteger @S) s)
-&gt; Term s (PBuiltinMap PTokenName (PInteger @S))
-&gt; PMap PTokenName (PInteger @S) s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair (PAsData PTokenName) (PAsData (PInteger @S))
   :--&gt; PBuiltinMap PTokenName (PInteger @S))
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike list a =&gt;
Term s (a :--&gt; list a)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">psingleton</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair (PAsData PTokenName) (PAsData (PInteger @S))
   :--&gt; PBuiltinMap PTokenName (PInteger @S))
-&gt; Term
     s (PBuiltinPair (PAsData PTokenName) (PAsData (PInteger @S)))
-&gt; Term s (PBuiltinMap PTokenName (PInteger @S))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#$</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PAsData PTokenName
   :--&gt; (PAsData (PInteger @S)
         :--&gt; PBuiltinPair (PAsData PTokenName) (PAsData (PInteger @S))))
forall (s :: S) (a :: PType) (b :: PType).
Term
  s
  (PAsData a
   :--&gt; (PAsData b :--&gt; PBuiltinPair (PAsData a) (PAsData b)))
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">ppairDataBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PAsData PTokenName
   :--&gt; (PAsData (PInteger @S)
         :--&gt; PBuiltinPair (PAsData PTokenName) (PAsData (PInteger @S))))
-&gt; Term s (PAsData PTokenName)
-&gt; Term
     s
     (PAsData (PInteger @S)
      :--&gt; PBuiltinPair (PAsData PTokenName) (PAsData (PInteger @S)))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTokenName -&gt; Term s (PAsData PTokenName)
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s a -&gt; Term s (PAsData a)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pdata</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTokenName
</span><a href="#local-6989586621679308562"><span class="hs-identifier hs-var">tok</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PAsData (PInteger @S)
   :--&gt; PBuiltinPair (PAsData PTokenName) (PAsData (PInteger @S)))
-&gt; Term s (PAsData (PInteger @S))
-&gt; Term
     s (PBuiltinPair (PAsData PTokenName) (PAsData (PInteger @S)))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S) -&gt; Term s (PAsData (PInteger @S))
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s a -&gt; Term s (PAsData a)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pdata</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger @S)
</span><a href="#local-6989586621679308561"><span class="hs-identifier hs-var">int</span></a></span><span>
</span><span id="line-383"></span><span>        </span><span id="local-6989586621679308558"><span class="annot"><span class="annottext">outerTup :: Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
</span><a href="#local-6989586621679308558"><span class="hs-identifier hs-var hs-var">outerTup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PMap PCurrencySymbol (PMap PTokenName (PInteger @S)) s
-&gt; Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">(PMap PCurrencySymbol (PMap PTokenName (PInteger @S)) s
 -&gt; Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S))))
-&gt; PMap PCurrencySymbol (PMap PTokenName (PInteger @S)) s
-&gt; Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s (PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
-&gt; PMap PCurrencySymbol (PMap PTokenName (PInteger @S)) s
forall (k :: PType) (v :: PType) (s :: S).
Term s (PBuiltinMap k v) -&gt; PMap k v s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Term
   s (PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
 -&gt; PMap PCurrencySymbol (PMap PTokenName (PInteger @S)) s)
-&gt; Term
     s (PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
-&gt; PMap PCurrencySymbol (PMap PTokenName (PInteger @S)) s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol) (PAsData (PMap PTokenName (PInteger @S)))
   :--&gt; PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike list a =&gt;
Term s (a :--&gt; list a)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">psingleton</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol) (PAsData (PMap PTokenName (PInteger @S)))
   :--&gt; PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
-&gt; Term
     s
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap PTokenName (PInteger @S))))
-&gt; Term
     s (PBuiltinMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#$</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PAsData PCurrencySymbol
   :--&gt; (PAsData (PMap PTokenName (PInteger @S))
         :--&gt; PBuiltinPair
                (PAsData PCurrencySymbol)
                (PAsData (PMap PTokenName (PInteger @S)))))
forall (s :: S) (a :: PType) (b :: PType).
Term
  s
  (PAsData a
   :--&gt; (PAsData b :--&gt; PBuiltinPair (PAsData a) (PAsData b)))
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">ppairDataBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PAsData PCurrencySymbol
   :--&gt; (PAsData (PMap PTokenName (PInteger @S))
         :--&gt; PBuiltinPair
                (PAsData PCurrencySymbol)
                (PAsData (PMap PTokenName (PInteger @S)))))
-&gt; Term s (PAsData PCurrencySymbol)
-&gt; Term
     s
     (PAsData (PMap PTokenName (PInteger @S))
      :--&gt; PBuiltinPair
             (PAsData PCurrencySymbol)
             (PAsData (PMap PTokenName (PInteger @S))))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PCurrencySymbol -&gt; Term s (PAsData PCurrencySymbol)
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s a -&gt; Term s (PAsData a)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pdata</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679308563"><span class="hs-identifier hs-var">sym</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PAsData (PMap PTokenName (PInteger @S))
   :--&gt; PBuiltinPair
          (PAsData PCurrencySymbol)
          (PAsData (PMap PTokenName (PInteger @S))))
-&gt; Term s (PAsData (PMap PTokenName (PInteger @S)))
-&gt; Term
     s
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap PTokenName (PInteger @S))))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PMap PTokenName (PInteger @S))
-&gt; Term s (PAsData (PMap PTokenName (PInteger @S)))
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s a -&gt; Term s (PAsData a)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pdata</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PMap PTokenName (PInteger @S))
</span><a href="#local-6989586621679308560"><span class="hs-identifier hs-var">innerTup</span></a></span><span>
</span><span id="line-384"></span><span>        </span><span id="local-6989586621679308557"><span class="annot"><span class="annottext">res :: Term s PValue
</span><a href="#local-6989586621679308557"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PValue s -&gt; Term s PValue
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">(PValue s -&gt; Term s PValue) -&gt; PValue s -&gt; Term s PValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
-&gt; PValue s
forall (s :: S).
Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
-&gt; PValue s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PValue</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PMap PCurrencySymbol (PMap PTokenName (PInteger @S)))
</span><a href="#local-6989586621679308558"><span class="hs-identifier hs-var">outerTup</span></a></span><span>
</span><span id="line-385"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Term s PValue
</span><a href="#local-6989586621679308557"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="hs-comment">-- | Finds the TxOut of an effect from TxInfo and TxOutRef</span><span>
</span><span id="line-388"></span><span id="local-6989586621679309553"><span class="annot"><a href="Agora.Utils.html#findTxOutByTxOutRef"><span class="hs-identifier hs-type">findTxOutByTxOutRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309553"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxOutRef</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxInfo</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMaybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxOut</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-389"></span><span id="findTxOutByTxOutRef"><span class="annot"><span class="annottext">findTxOutByTxOutRef :: forall (s :: S).
Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxOut))
</span><a href="Agora.Utils.html#findTxOutByTxOutRef"><span class="hs-identifier hs-var hs-var">findTxOutByTxOutRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (s :: S).
 Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxOut)))
-&gt; Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxOut))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (s :: S).
  Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxOut)))
 -&gt; Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxOut)))
-&gt; (forall (s :: S).
    Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxOut)))
-&gt; Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxOut))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-390"></span><span>  </span><span class="annot"><span class="annottext">(Term s PTxOutRef -&gt; Term s PTxInfo -&gt; Term s (PMaybe PTxOut))
-&gt; Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxOut))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PTxOutRef -&gt; Term s PTxInfo -&gt; Term s (PMaybe PTxOut))
 -&gt; Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxOut)))
-&gt; (Term s PTxOutRef -&gt; Term s PTxInfo -&gt; Term s (PMaybe PTxOut))
-&gt; Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxOut))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679308533"><span class="annot"><span class="annottext">Term s PTxOutRef
</span><a href="#local-6989586621679308533"><span class="hs-identifier hs-var">txOutRef</span></a></span></span><span> </span><span id="local-6989586621679308532"><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679308532"><span class="hs-identifier hs-var">txInfo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-391"></span><span>    </span><span class="annot"><span class="annottext">Term s (PMaybe PTxInInfo)
-&gt; (PMaybe PTxInInfo s -&gt; Term s (PMaybe PTxOut))
-&gt; Term s (PMaybe PTxOut)
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxInInfo))
forall (s :: S).
Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxInInfo))
</span><a href="Agora.Utils.html#pfindTxInByTxOutRef"><span class="hs-identifier hs-var">pfindTxInByTxOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PTxOutRef :--&gt; (PTxInfo :--&gt; PMaybe PTxInInfo))
-&gt; Term s PTxOutRef -&gt; Term s (PTxInfo :--&gt; PMaybe PTxInInfo)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTxOutRef
</span><a href="#local-6989586621679308533"><span class="hs-identifier hs-var">txOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PTxInfo :--&gt; PMaybe PTxInInfo)
-&gt; Term s PTxInfo -&gt; Term s (PMaybe PTxInInfo)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679308532"><span class="hs-identifier hs-var">txInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((PMaybe PTxInInfo s -&gt; Term s (PMaybe PTxOut))
 -&gt; Term s (PMaybe PTxOut))
-&gt; (PMaybe PTxInInfo s -&gt; Term s (PMaybe PTxOut))
-&gt; Term s (PMaybe PTxOut)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-392"></span><span>      </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PJust</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (name :: Symbol) (p :: PType) (s :: S) (a :: PType)
       (as :: [PLabeledType]) (n :: Nat) (b :: PType).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfield</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;resolved&quot;</span></span><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679308531"><span class="annot"><span class="annottext">Term s PTxOut
</span><a href="#local-6989586621679308531"><span class="hs-identifier hs-var">txOut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PMaybe PTxOut s -&gt; Term s (PMaybe PTxOut)
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">(PMaybe PTxOut s -&gt; Term s (PMaybe PTxOut))
-&gt; PMaybe PTxOut s -&gt; Term s (PMaybe PTxOut)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTxOut -&gt; PMaybe PTxOut s
forall (a :: PType) (s :: S). Term s a -&gt; PMaybe a s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PJust</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTxOut
</span><a href="#local-6989586621679308531"><span class="hs-identifier hs-var">txOut</span></a></span><span>
</span><span id="line-393"></span><span>      </span><span class="annot"><span class="annottext">PMaybe PTxInInfo s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PNothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PMaybe PTxOut s -&gt; Term s (PMaybe PTxOut)
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">PMaybe PTxOut s
forall (a :: PType) (s :: S). PMaybe a s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PNothing</span></a></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="hs-comment">-- | Get script hash from an Address.</span><span>
</span><span id="line-396"></span><span id="local-6989586621679309550"><span class="annot"><a href="Agora.Utils.html#scriptHashFromAddress"><span class="hs-identifier hs-type">scriptHashFromAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309550"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAddress</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMaybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PValidatorHash</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-397"></span><span id="scriptHashFromAddress"><span class="annot"><span class="annottext">scriptHashFromAddress :: forall (s :: S). Term s (PAddress :--&gt; PMaybe PValidatorHash)
</span><a href="Agora.Utils.html#scriptHashFromAddress"><span class="hs-identifier hs-var hs-var">scriptHashFromAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (s :: S). Term s (PAddress :--&gt; PMaybe PValidatorHash))
-&gt; Term s (PAddress :--&gt; PMaybe PValidatorHash)
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (s :: S). Term s (PAddress :--&gt; PMaybe PValidatorHash))
 -&gt; Term s (PAddress :--&gt; PMaybe PValidatorHash))
-&gt; (forall (s :: S). Term s (PAddress :--&gt; PMaybe PValidatorHash))
-&gt; Term s (PAddress :--&gt; PMaybe PValidatorHash)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-398"></span><span>  </span><span class="annot"><span class="annottext">(Term s PAddress -&gt; Term s (PMaybe PValidatorHash))
-&gt; Term s (PAddress :--&gt; PMaybe PValidatorHash)
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PAddress -&gt; Term s (PMaybe PValidatorHash))
 -&gt; Term s (PAddress :--&gt; PMaybe PValidatorHash))
-&gt; (Term s PAddress -&gt; Term s (PMaybe PValidatorHash))
-&gt; Term s (PAddress :--&gt; PMaybe PValidatorHash)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679308496"><span class="annot"><span class="annottext">Term s PAddress
</span><a href="#local-6989586621679308496"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-399"></span><span>    </span><span class="annot"><span class="annottext">Term s PCredential
-&gt; (PCredential s -&gt; Term s (PMaybe PValidatorHash))
-&gt; Term s (PMaybe PValidatorHash)
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PAsData PCredential) -&gt; Term s PCredential
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfromData</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PAsData PCredential) -&gt; Term s PCredential)
-&gt; Term s (PAsData PCredential) -&gt; Term s PCredential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (name :: Symbol) (p :: PType) (s :: S) (a :: PType)
       (as :: [PLabeledType]) (n :: Nat) (b :: PType).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfield</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;credential&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term s (PAddress :--&gt; PAsData PCredential)
-&gt; Term s PAddress -&gt; Term s (PAsData PCredential)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PAddress
</span><a href="#local-6989586621679308496"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((PCredential s -&gt; Term s (PMaybe PValidatorHash))
 -&gt; Term s (PMaybe PValidatorHash))
-&gt; (PCredential s -&gt; Term s (PMaybe PValidatorHash))
-&gt; Term s (PMaybe PValidatorHash)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-400"></span><span>      </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PScriptCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (name :: Symbol) (p :: PType) (s :: S) (a :: PType)
       (as :: [PLabeledType]) (n :: Nat) (b :: PType).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfield</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;_0&quot;</span></span><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679308495"><span class="annot"><span class="annottext">Term s PValidatorHash
</span><a href="#local-6989586621679308495"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PMaybe PValidatorHash s -&gt; Term s (PMaybe PValidatorHash)
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">(PMaybe PValidatorHash s -&gt; Term s (PMaybe PValidatorHash))
-&gt; PMaybe PValidatorHash s -&gt; Term s (PMaybe PValidatorHash)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PValidatorHash -&gt; PMaybe PValidatorHash s
forall (a :: PType) (s :: S). Term s a -&gt; PMaybe a s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PJust</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PValidatorHash
</span><a href="#local-6989586621679308495"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-401"></span><span>      </span><span class="annot"><span class="annottext">PCredential s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PMaybe PValidatorHash s -&gt; Term s (PMaybe PValidatorHash)
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">PMaybe PValidatorHash s
forall (a :: PType) (s :: S). PMaybe a s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PNothing</span></a></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-comment">-- | Find all TxOuts sent to an Address</span><span>
</span><span id="line-404"></span><span id="local-6989586621679309545"><span class="annot"><a href="Agora.Utils.html#findOutputsToAddress"><span class="hs-identifier hs-type">findOutputsToAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309545"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxInfo</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAddress</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PBuiltinList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PAsData</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxOut</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-405"></span><span id="findOutputsToAddress"><span class="annot"><span class="annottext">findOutputsToAddress :: forall (s :: S).
Term s (PTxInfo :--&gt; (PAddress :--&gt; PBuiltinList (PAsData PTxOut)))
</span><a href="Agora.Utils.html#findOutputsToAddress"><span class="hs-identifier hs-var hs-var">findOutputsToAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (s :: S).
 Term
   s (PTxInfo :--&gt; (PAddress :--&gt; PBuiltinList (PAsData PTxOut))))
-&gt; Term
     s (PTxInfo :--&gt; (PAddress :--&gt; PBuiltinList (PAsData PTxOut)))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (s :: S).
  Term
    s (PTxInfo :--&gt; (PAddress :--&gt; PBuiltinList (PAsData PTxOut))))
 -&gt; Term
      s (PTxInfo :--&gt; (PAddress :--&gt; PBuiltinList (PAsData PTxOut))))
-&gt; (forall (s :: S).
    Term
      s (PTxInfo :--&gt; (PAddress :--&gt; PBuiltinList (PAsData PTxOut))))
-&gt; Term
     s (PTxInfo :--&gt; (PAddress :--&gt; PBuiltinList (PAsData PTxOut)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-406"></span><span>  </span><span class="annot"><span class="annottext">(Term s PTxInfo
 -&gt; Term s PAddress -&gt; Term s (PBuiltinList (PAsData PTxOut)))
-&gt; Term
     s (PTxInfo :--&gt; (PAddress :--&gt; PBuiltinList (PAsData PTxOut)))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PTxInfo
  -&gt; Term s PAddress -&gt; Term s (PBuiltinList (PAsData PTxOut)))
 -&gt; Term
      s (PTxInfo :--&gt; (PAddress :--&gt; PBuiltinList (PAsData PTxOut))))
-&gt; (Term s PTxInfo
    -&gt; Term s PAddress -&gt; Term s (PBuiltinList (PAsData PTxOut)))
-&gt; Term
     s (PTxInfo :--&gt; (PAddress :--&gt; PBuiltinList (PAsData PTxOut)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679308459"><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679308459"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621679308458"><span class="annot"><span class="annottext">Term s PAddress
</span><a href="#local-6989586621679308458"><span class="hs-identifier hs-var">address'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-407"></span><span>    </span><span id="local-6989586621679308457"><span class="annot"><span class="annottext">Term s (PAsData PAddress)
</span><a href="#local-6989586621679308457"><span class="hs-identifier hs-var">address</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s (PAsData PAddress)
-&gt; (Term s (PAsData PAddress)
    -&gt; Term s (PBuiltinList (PAsData PTxOut)))
-&gt; Term s (PBuiltinList (PAsData PTxOut))
forall (s :: S) (a :: PType) (b :: PType).
Term s a -&gt; (Term s a -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plet</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PAsData PAddress)
 -&gt; (Term s (PAsData PAddress)
     -&gt; Term s (PBuiltinList (PAsData PTxOut)))
 -&gt; Term s (PBuiltinList (PAsData PTxOut)))
-&gt; Term s (PAsData PAddress)
-&gt; (Term s (PAsData PAddress)
    -&gt; Term s (PBuiltinList (PAsData PTxOut)))
-&gt; Term s (PBuiltinList (PAsData PTxOut))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PAddress -&gt; Term s (PAsData PAddress)
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s a -&gt; Term s (PAsData a)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pdata</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PAddress
</span><a href="#local-6989586621679308458"><span class="hs-identifier hs-var">address'</span></a></span><span>
</span><span id="line-408"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679308456"><span class="annot"><span class="annottext">outputs :: Term s (PBuiltinList (PAsData PTxOut))
</span><a href="#local-6989586621679308456"><span class="hs-identifier hs-var hs-var">outputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term s (PAsData (PBuiltinList (PAsData PTxOut)))
-&gt; Term s (PBuiltinList (PAsData PTxOut))
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfromData</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PAsData (PBuiltinList (PAsData PTxOut)))
 -&gt; Term s (PBuiltinList (PAsData PTxOut)))
-&gt; Term s (PAsData (PBuiltinList (PAsData PTxOut)))
-&gt; Term s (PBuiltinList (PAsData PTxOut))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (name :: Symbol) (p :: PType) (s :: S) (a :: PType)
       (as :: [PLabeledType]) (n :: Nat) (b :: PType).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfield</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;outputs&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term s (PTxInfo :--&gt; PAsData (PBuiltinList (PAsData PTxOut)))
-&gt; Term s PTxInfo
-&gt; Term s (PAsData (PBuiltinList (PAsData PTxOut)))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679308459"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-409"></span><span>        </span><span id="local-6989586621679308455"><span class="annot"><span class="annottext">filteredOutputs :: Term s (PBuiltinList (PAsData PTxOut))
</span><a href="#local-6989586621679308455"><span class="hs-identifier hs-var hs-var">filteredOutputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-410"></span><span>          </span><span class="annot"><span class="annottext">Term
  s
  ((PAsData PTxOut :--&gt; PBool)
   :--&gt; (PBuiltinList (PAsData PTxOut)
         :--&gt; PBuiltinList (PAsData PTxOut)))
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike list a =&gt;
Term s ((a :--&gt; PBool) :--&gt; (list a :--&gt; list a))
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfilter</span></a></span><span class="hs-cpp">
            # plam
</span><span>              </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">txOut</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;address&quot;</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">txOut</span><span> </span><span class="hs-operator">#==</span><span> </span><span class="hs-identifier">address</span><span class="hs-special">)</span><span class="hs-cpp">
            # outputs
</span><span>    </span><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData PTxOut))
</span><a href="#local-6989586621679308455"><span class="hs-identifier hs-var">filteredOutputs</span></a></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="hs-comment">-- | Find the data corresponding to a TxOut, if there is one</span><span>
</span><span id="line-417"></span><span id="local-6989586621679309542"><span class="annot"><a href="Agora.Utils.html#findTxOutDatum"><span class="hs-identifier hs-type">findTxOutDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679309542"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxInfo</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PTxOut</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-type">:--&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PMaybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDatum</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-418"></span><span id="findTxOutDatum"><span class="annot"><span class="annottext">findTxOutDatum :: forall (s :: S). Term s (PTxInfo :--&gt; (PTxOut :--&gt; PMaybe PDatum))
</span><a href="Agora.Utils.html#findTxOutDatum"><span class="hs-identifier hs-var hs-var">findTxOutDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (s :: S).
 Term s (PTxInfo :--&gt; (PTxOut :--&gt; PMaybe PDatum)))
-&gt; Term s (PTxInfo :--&gt; (PTxOut :--&gt; PMaybe PDatum))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">phoistAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (s :: S).
  Term s (PTxInfo :--&gt; (PTxOut :--&gt; PMaybe PDatum)))
 -&gt; Term s (PTxInfo :--&gt; (PTxOut :--&gt; PMaybe PDatum)))
-&gt; (forall (s :: S).
    Term s (PTxInfo :--&gt; (PTxOut :--&gt; PMaybe PDatum)))
-&gt; Term s (PTxInfo :--&gt; (PTxOut :--&gt; PMaybe PDatum))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-419"></span><span>  </span><span class="annot"><span class="annottext">(Term s PTxInfo -&gt; Term s PTxOut -&gt; Term s (PMaybe PDatum))
-&gt; Term s (PTxInfo :--&gt; (PTxOut :--&gt; PMaybe PDatum))
forall a (b :: PType) (s :: S) (c :: PType).
PLamN a b s =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">plam</span></a></span><span> </span><span class="annot"><span class="annottext">((Term s PTxInfo -&gt; Term s PTxOut -&gt; Term s (PMaybe PDatum))
 -&gt; Term s (PTxInfo :--&gt; (PTxOut :--&gt; PMaybe PDatum)))
-&gt; (Term s PTxInfo -&gt; Term s PTxOut -&gt; Term s (PMaybe PDatum))
-&gt; Term s (PTxInfo :--&gt; (PTxOut :--&gt; PMaybe PDatum))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679308423"><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679308423"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621679308422"><span class="annot"><span class="annottext">Term s PTxOut
</span><a href="#local-6989586621679308422"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">P.do</span><span>
</span><span id="line-420"></span><span>    </span><span id="local-6989586621679308421"><span class="annot"><span class="annottext">PMaybeData PDatumHash s
</span><a href="#local-6989586621679308421"><span class="hs-identifier hs-var">datumHash'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term s (PMaybeData PDatumHash)
-&gt; (PMaybeData PDatumHash s -&gt; Term s (PMaybe PDatum))
-&gt; Term s (PMaybe PDatum)
forall (a :: PType) (s :: S) (b :: PType).
PMatch a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pmatch</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PMaybeData PDatumHash)
 -&gt; (PMaybeData PDatumHash s -&gt; Term s (PMaybe PDatum))
 -&gt; Term s (PMaybe PDatum))
-&gt; Term s (PMaybeData PDatumHash)
-&gt; (PMaybeData PDatumHash s -&gt; Term s (PMaybe PDatum))
-&gt; Term s (PMaybe PDatum)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData (PMaybeData PDatumHash))
-&gt; Term s (PMaybeData PDatumHash)
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfromData</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PAsData (PMaybeData PDatumHash))
 -&gt; Term s (PMaybeData PDatumHash))
-&gt; Term s (PAsData (PMaybeData PDatumHash))
-&gt; Term s (PMaybeData PDatumHash)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/kq3z27pzg8pc38yjr84kzncicvpzhan0-ghc-9.2.1-doc/share/doc/ghc/html/libraries/base-4.16.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (name :: Symbol) (p :: PType) (s :: S) (a :: PType)
       (as :: [PLabeledType]) (n :: Nat) (b :: PType).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfield</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;datumHash&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term s (PTxOut :--&gt; PAsData (PMaybeData PDatumHash))
-&gt; Term s PTxOut -&gt; Term s (PAsData (PMaybeData PDatumHash))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTxOut
</span><a href="#local-6989586621679308422"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-421"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PMaybeData PDatumHash s
</span><a href="#local-6989586621679308421"><span class="hs-identifier hs-var">datumHash'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-422"></span><span>      </span><span class="annot"><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-type">PDJust</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (name :: Symbol) (p :: PType) (s :: S) (a :: PType)
       (as :: [PLabeledType]) (n :: Nat) (b :: PType).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pfield</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;_0&quot;</span></span><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679308420"><span class="annot"><span class="annottext">Term s PDatumHash
</span><a href="#local-6989586621679308420"><span class="hs-identifier hs-var">datumHash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe PDatum))
forall (s :: S).
Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe PDatum))
</span><a href="Agora.Utils.html#pfindDatum"><span class="hs-identifier hs-var">pfindDatum</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PDatumHash :--&gt; (PTxInfo :--&gt; PMaybe PDatum))
-&gt; Term s PDatumHash -&gt; Term s (PTxInfo :--&gt; PMaybe PDatum)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PDatumHash
</span><a href="#local-6989586621679308420"><span class="hs-identifier hs-var">datumHash</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PTxInfo :--&gt; PMaybe PDatum)
-&gt; Term s PTxInfo -&gt; Term s (PMaybe PDatum)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTxInfo
</span><a href="#local-6989586621679308423"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-423"></span><span>      </span><span class="annot"><span class="annottext">PMaybeData PDatumHash s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PMaybe PDatum s -&gt; Term s (PMaybe PDatum)
forall (a :: PType) (s :: S). PCon a =&gt; a s -&gt; Term s a
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">pcon</span></a></span><span> </span><span class="annot"><span class="annottext">PMaybe PDatum s
forall (a :: PType) (s :: S). PMaybe a s
</span><a href="../file:///nix/store/3c9cva5aggalyxpj19nv8vx2yhr5wlkd-plutarch-lib-plutarch-1.1.0-haddock-doc/share/doc/plutarch/html/src"><span class="hs-identifier hs-var">PNothing</span></a></span><span>
</span><span id="line-424"></span></pre></body></html>